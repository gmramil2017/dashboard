{"version":3,"sources":["metabase/util/malli/registry.cljc"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AASA,GAAA,QAAAA,qCAAAC,0CAAAC,gDAAAC,yDAAAC;AAAA;AAAA,AAAA,AAAmBC,8CACjB,AAACC,6CAAK,AAACC,uGAAM,AAACC,6BACD,AAACC;;AAGhB,GAAA,QAAAT,qCAAAC,0CAAAC,gDAAAC,yDAAAO;AAAA;AAAA,AAAA,AAAmBC,wCAAS,AAACC,gCAAoBP;;AAEjD,AAACQ,0CAAyBF;AAE1B;;;8CAAA,9CAAMG,oGAEHC,KAAKC;AAFR,AAGE,AAACC,mDAAMZ,4CAAUa,gBAAMH,KAAKC;;AAH9B;;AAYA;;;8CAAA,9CAAMG,oGAEHC;AAFH,AAGE,OAACC,sBAAUV,sCAASS","names":["js/metabase","js/metabase.util","js/metabase.util.malli","js/metabase.util.malli.registry","js/metabase.util.malli.registry.registry*","metabase.util.malli.registry/registry*","cljs.core.atom","cljs.core.merge","malli.core/default-schemas","malli.util/schemas","js/metabase.util.malli.registry.registry","metabase.util.malli.registry/registry","malli.registry/mutable-registry","malli.registry/set-default-registry!","metabase.util.malli.registry/register!","type","schema","cljs.core.swap_BANG_","cljs.core/assoc","metabase.util.malli.registry/resolve-schema","k","malli.registry/schema"],"sourcesContent":["(ns metabase.util.malli.registry\n  (:refer-clojure :exclude [def])\n  (:require\n   [malli.core :as mc]\n   [malli.registry :as mr]\n   [malli.util :as mut]\n   #?@(:clj ([malli.experimental.time :as malli.time])))\n  #?(:cljs (:require-macros [metabase.util.malli.registry])))\n\n(defonce ^:private registry*\n  (atom (merge (mc/default-schemas)\n               (mut/schemas)\n               #?(:clj (malli.time/schemas)))))\n\n(defonce ^:private registry (mr/mutable-registry registry*))\n\n(mr/set-default-registry! registry)\n\n(defn register!\n  \"Register a spec with our Malli spec \"\n  [type schema]\n  (swap! registry* assoc type schema)\n  nil)\n\n#?(:clj\n   (defmacro def\n     \"Like [[clojure.spec.alpha/def]]; add a Malli schema to our registry.\"\n     [type schema]\n     `(register! ~type ~schema)))\n\n(defn resolve-schema\n  \"For REPL/test usage: get the definition of a registered schema from the registry.\"\n  [k]\n  (mr/schema registry k))\n"]}