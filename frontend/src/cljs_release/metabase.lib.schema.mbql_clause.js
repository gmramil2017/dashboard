var window=global;var $CLJS=require("./cljs_env.js");require("./cljs.core.js");require("./metabase.lib.schema.common.js");require("./metabase.lib.schema.expression.js");require("./metabase.types.js");require("./metabase.util.malli.js");require("./metabase.util.malli.registry.js");
'use strict';var GU,HU,zU,PU,EU,yla;$CLJS.AU=function(a,b){a=zU(a,b);return $CLJS.m(a)?a:$CLJS.sl};$CLJS.BU=function(a,b){$CLJS.jj.C($CLJS.MG,$CLJS.zF,a,b)};$CLJS.CU=function(a,b,c){a=$CLJS.jy.h(a,c);return a.g?a.g(b):a.call(null,b)};$CLJS.DU=function(a,b){return $CLJS.CU(a,b,null)};GU=function(){$CLJS.rK(EU,$CLJS.th.h(new $CLJS.R(null,1,5,$CLJS.S,[$CLJS.ot],null),$CLJS.Qe($CLJS.Me,$CLJS.r(FU))))};
HU=function(){return $CLJS.th.j(new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.vt,new $CLJS.k(null,2,[$CLJS.Bk,$CLJS.C,$CLJS.Yu,function(a){a=$CLJS.Uf(a);a=$CLJS.M.h(a,$CLJS.vl);return $CLJS.qe(a)?["Invalid ",$CLJS.gj.l($CLJS.J([$CLJS.C(a)]))," clause: ",$CLJS.gj.l($CLJS.J([a]))].join(""):"not an MBQL clause"}],null)],null),$CLJS.xg.g(function(a){return new $CLJS.R(null,2,5,$CLJS.S,[a,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.nq,$CLJS.Ui.h("mbql.clause",$CLJS.Ai(a))],null)],null)}),$CLJS.r(FU))};
$CLJS.IU=function(a,b){var c=$CLJS.Ui.h("mbql.clause",$CLJS.Ai(a));$CLJS.rK(c,b);$CLJS.Ie($CLJS.r(FU),a)||$CLJS.jj.j(FU,$CLJS.mf,a);return null};$CLJS.JU=function(a,b,c){$CLJS.IU(a,c);$CLJS.KK.o(null,a,function(){return b});return null};$CLJS.MU=function(a,b){$CLJS.Q.C(KU,LU,a,b)};$CLJS.OU=function(a,b){$CLJS.Q.C(KU,NU,a,b)};
zU=function zU(a,b){return $CLJS.F.h(a,$CLJS.sl)?null:$CLJS.F.h(b,$CLJS.sl)?null:$CLJS.XG(a,b)?b:$CLJS.XG(b,a)?a:$CLJS.ag(function(d){return $CLJS.ag(function(e){return $CLJS.F.h(new $CLJS.R(null,2,5,$CLJS.S,[d,e],null),new $CLJS.R(null,2,5,$CLJS.S,[a,b],null))?null:zU.h?zU.h(d,e):zU.call(null,d,e)},$CLJS.pf(b,$CLJS.uj(b)))},$CLJS.pf(a,$CLJS.uj(a)))};PU=new $CLJS.N("metabase.lib.schema.mbql-clause","clause*","metabase.lib.schema.mbql-clause/clause*",1127493678);
$CLJS.QU=new $CLJS.N(null,"short","short",1928760516);EU=new $CLJS.N("metabase.lib.schema.mbql-clause","tag","metabase.lib.schema.mbql-clause/tag",-405459143);$CLJS.RU=new $CLJS.N("metabase.lib.schema.ref","ref","metabase.lib.schema.ref/ref",-1124116498);yla=new $CLJS.N("metabase.lib.schema.mbql-clause","update-schemas","metabase.lib.schema.mbql-clause/update-schemas",-447263953);var FU=$CLJS.ij.g($CLJS.ui);$CLJS.NG(FU,yla,function(){GU();return $CLJS.rK(PU,HU())});GU();$CLJS.rK(PU,HU());$CLJS.rK($CLJS.MK,new $CLJS.R(null,3,5,$CLJS.S,[$CLJS.Qj,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.hm,new $CLJS.R(null,3,5,$CLJS.S,[$CLJS.ft,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.hm,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.nq,EU],null)],null),new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.sm,$CLJS.Lb],null)],null)],null),new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.nq,PU],null)],null));
var NU=function NU(a){for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;return NU.l(arguments[0],1<c.length?new $CLJS.y(c.slice(1),0,null):null)};
NU.l=function(a,b){return new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.hm,$CLJS.th.h(new $CLJS.R(null,4,5,$CLJS.S,[$CLJS.it,new $CLJS.k(null,1,[$CLJS.Wu,["Valid ",$CLJS.p.g(a)," clause"].join("")],null),new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.Al,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.lm,a],null)],null),new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.Sk,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.hm,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.nq,$CLJS.DK],null)],null)],null)],null),b)],null)};NU.v=1;
NU.B=function(a){var b=$CLJS.C(a);a=$CLJS.D(a);return this.l(b,a)};var LU=function LU(a){for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;return LU.l(arguments[0],1<c.length?new $CLJS.y(c.slice(1),0,null):null)};
LU.l=function(a,b){return $CLJS.th.h(new $CLJS.R(null,4,5,$CLJS.S,[$CLJS.tt,new $CLJS.k(null,1,[$CLJS.Wu,["Valid ",$CLJS.p.g(a)," clause"].join("")],null),new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.lm,a],null),new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.nq,$CLJS.DK],null)],null),b)};LU.v=1;LU.B=function(a){var b=$CLJS.C(a);a=$CLJS.D(a);return this.l(b,a)};
var KU=function KU(a){for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;return KU.l(arguments[0],arguments[1],2<c.length?new $CLJS.y(c.slice(2),0,null):null)};KU.l=function(a,b,c){c=$CLJS.F.h($CLJS.C(c),$CLJS.hu)?$CLJS.pf($CLJS.Zd(c),$CLJS.qg(2,c)):$CLJS.pf(null,c);var d=$CLJS.A(c);c=$CLJS.C(d);d=$CLJS.D(d);a=$CLJS.Q.j(a,b,d);return $CLJS.m(c)?$CLJS.JU(b,c,a):$CLJS.IU(b,a)};KU.v=2;
KU.B=function(a){var b=$CLJS.C(a),c=$CLJS.D(a);a=$CLJS.C(c);c=$CLJS.D(c);return this.l(b,a,c)};