var window=global;var $CLJS=require("./cljs_env.js");require("./cljs.core.js");require("./shadow.js.shim.module$moment.js");require("./clojure.string.js");require("./metabase.mbql.normalize.js");require("./metabase.shared.util.i18n.js");
'use strict';var U$=function(a){return new $CLJS.Af(null,function(){return $CLJS.pf(a.A?a.A():a.call(null),U$(a))},null,null)},V$=function(a,b){return new $CLJS.Af(null,function(){var c=$CLJS.A(b);if(c){var d=$CLJS.C(c),e=a.g?a.g(d):a.call(null,d),f=$CLJS.pf(d,$CLJS.Bi(function(g){return $CLJS.F.h(e,a.g?a.g(g):a.call(null,g))},$CLJS.D(c)));return $CLJS.pf(f,V$(a,new $CLJS.Af(null,function(){return $CLJS.qg($CLJS.E(f),c)},null,null)))}return null},null,null)},Lxa=function(a,b){switch(a){case "minutes":return $CLJS.zZ("Minute",
"Minutes",b);case "hours":return $CLJS.zZ("Hour","Hours",b);case "days":return $CLJS.zZ("Day","Days",b);case "weeks":return $CLJS.zZ("Week","Weeks",b);case "months":return $CLJS.zZ("Month","Months",b);case "quarters":return $CLJS.zZ("Quarter","Quarters",b);case "years":return $CLJS.zZ("Year","Years",b);default:throw Error(["No matching clause: ",$CLJS.p.g(a)].join(""));}},Mxa=function(a,b,c){b=parseInt(b);c=Lxa(c,b);a=new $CLJS.R(null,2,5,$CLJS.S,[a,$CLJS.F.h(b,1)],null);if($CLJS.F.h(new $CLJS.R(null,
2,5,$CLJS.S,["past",!0],null),a))return $CLJS.aH("Previous {0}",$CLJS.J([c]));if($CLJS.F.h(new $CLJS.R(null,2,5,$CLJS.S,["past",!1],null),a))return $CLJS.aH("Previous {0} {1}",$CLJS.J([b,c]));if($CLJS.F.h(new $CLJS.R(null,2,5,$CLJS.S,["next",!0],null),a))return $CLJS.aH("Next {0}",$CLJS.J([c]));if($CLJS.F.h(new $CLJS.R(null,2,5,$CLJS.S,["next",!1],null),a))return $CLJS.aH("Next {0} {1}",$CLJS.J([b,c]));throw Error(["No matching clause: ",$CLJS.p.g(a)].join(""));},Oxa=function(a){return $CLJS.zu(a,
Nxa,function(b){return["\\",$CLJS.p.g(b)].join("")})},W$=function(a,b,c,d,e){this.tag=a;this.source=b;this.F=c;this.m=d;this.G=e;this.D=2230716170;this.K=139264},Qxa=function(a){var b=$CLJS.cz(a,Pxa),c=$CLJS.xg.h($CLJS.C,$CLJS.V5(X$,a)),d=function(){var e=$CLJS.E(b),f=$CLJS.E(c);return e>f?e:f}();a=$CLJS.wg.h(b,$CLJS.pg(d-$CLJS.E(b),U$($CLJS.eg(""))));d=$CLJS.wg.h(c,$CLJS.pg(d-$CLJS.E(c),U$($CLJS.eg(""))));a=$CLJS.ug.h(a,d);return $CLJS.xg.h(function(e){var f=$CLJS.Ji(X$,e);return $CLJS.m(f)?($CLJS.K(f,
0,null),f=$CLJS.K(f,1,null),new W$(f,e,null,null,null)):e},a)},Rxa=function(a){return $CLJS.yg(function(b){return"string"===typeof $CLJS.C(b)?new $CLJS.R(null,1,5,$CLJS.S,[$CLJS.Uu.g(b)],null):b},$CLJS.J([V$(function(b){return"string"===typeof b||$CLJS.Fb($CLJS.vl.g(b))},a)]))},Sxa=function(a,b,c){return $CLJS.xg.h(function(d){if(d instanceof W$){var e=$CLJS.U.j;var f=$CLJS.Al.g(d),g=$CLJS.M.h(a,f);f=$CLJS.vl.g(g);g=$CLJS.al.g(g);if($CLJS.m(f))try{var l=Oxa(Y$.j(g,f,b))}catch(n){if(n instanceof Error)l=
Y$.j($CLJS.Uj,f,b);else throw n;}else l=null;d=e.call($CLJS.U,d,$CLJS.vl,l)}return d},c)},Vxa=function(a){a=$CLJS.Uu.g($CLJS.xg.h(function(b){return b instanceof W$?b:$CLJS.zu(b,Txa,"")},a));return $CLJS.zu(a,Uxa,$CLJS.Zd)},Wxa=function(a){return $CLJS.pF($CLJS.C(Z$(new $CLJS.R(null,1,5,$CLJS.S,[$CLJS.YN],null),new $CLJS.R(null,1,5,$CLJS.S,[a],null))),$CLJS.Ui)},Z$=function Z$(a,b){if($CLJS.Fb($CLJS.A(a)))a=(0,$CLJS.u7)(b);else{var d=$CLJS.M,e=d.h;var f=$CLJS.zi(a);b=$CLJS.Tf([$CLJS.$d(a),b]);f=Z$.h?
Z$.h(f,b):Z$.call(null,f,b);a=e.call(d,f,$CLJS.$d(a))}return a};var Y$=function(){var a=$CLJS.ij.g($CLJS.P),b=$CLJS.ij.g($CLJS.P),c=$CLJS.ij.g($CLJS.P),d=$CLJS.ij.g($CLJS.P),e=$CLJS.M.j($CLJS.P,$CLJS.Vk,$CLJS.rj.A?$CLJS.rj.A():$CLJS.rj.call(null));return new $CLJS.Aj($CLJS.$i.h("metabase.shared.parameters.parameters","formatted-value"),function(f){return $CLJS.Ui.g(f)},$CLJS.Uj,e,a,b,c,d)}();Y$.o(null,$CLJS.gP,function(a,b,c){return(0,$CLJS.cL)(b).locale(c).format("MMMM D, YYYY")});
Y$.o(null,$CLJS.cO,function(a,b,c){a=(0,$CLJS.cL)(b,"YYYY-MM").locale(c);return $CLJS.m(a.isValid())?a.format("MMMM, YYYY"):""});Y$.o(null,$CLJS.HO,function(a,b,c){a=(0,$CLJS.cL)(b,"[Q]Q-YYYY").locale(c);return $CLJS.m(a.isValid())?a.format("[Q]Q, YYYY"):""});Y$.o(null,$CLJS.PN,function(a,b,c){b=$CLJS.cz(b,/~/);a=$CLJS.K(b,0,null);b=$CLJS.K(b,1,null);return $CLJS.m($CLJS.m(a)?b:a)?[$CLJS.p.g(Y$.j($CLJS.gP,a,c))," - ",$CLJS.p.g(Y$.j($CLJS.gP,b,c))].join(""):""});
Y$.o(null,$CLJS.IO,function(a,b){function c(d,e){return $CLJS.D($CLJS.Ki(d,e))}if(c(/^today$/,b)||c(/^thisday$/,b))return $CLJS.bH("Today");if(c(/^thisweek$/,b))return $CLJS.bH("This Week");if(c(/^thismonth$/,b))return $CLJS.bH("This Month");if(c(/^thisquarter$/,b))return $CLJS.bH("This Quarter");if(c(/^thisyear$/,b))return $CLJS.bH("This Year");if(c(/^past1days$/,b))return $CLJS.bH("Yesterday");if(c(/^next1days$/,b))return $CLJS.bH("Tomorrow");if(a=c(/^(past|next)([0-9]+)([a-z]+)~?$/,b))return $CLJS.Q.h(Mxa,
a);throw Error(["No matching clause: ",$CLJS.p.g(b)].join(""));});Y$.o(null,$CLJS.xR,function(a,b,c){function d(e,f){return $CLJS.Zd($CLJS.Ki(e,f))}a=d(/^(this[a-z]+)$/,b);if($CLJS.m(a))return Y$.j($CLJS.IO,a,c);a=d(/^~?([0-9-T:]+)~?$/,b);if($CLJS.m(a))return Y$.j($CLJS.gP,a,c);a=d(/^([0-9-T:]+~[0-9-T:]+)$/,b);return $CLJS.m(a)?Y$.j($CLJS.PN,a,c):Y$.j($CLJS.IO,b,c)});
Y$.o(null,$CLJS.Uj,function(a,b){$CLJS.ne(b)?(a=$CLJS.E(b),b=$CLJS.m($CLJS.F.h?$CLJS.F.h(1,a):$CLJS.F.call(null,1,a))?$CLJS.p.g($CLJS.C(b)):$CLJS.m($CLJS.F.h?$CLJS.F.h(2,a):$CLJS.F.call(null,2,a))?$CLJS.aH("{0} and {1}",$CLJS.J([$CLJS.C(b),$CLJS.Zd(b)])):$CLJS.aH("{0}, {1}, and {2}",$CLJS.J([$CLJS.Uu.h(", ",$CLJS.xu(2,b)),$CLJS.G(b,$CLJS.E(b)-2),$CLJS.$d(b)]))):b=$CLJS.p.g(b);return b});var Nxa=/[\\\/*_`'\[\](){}<>#+-.!$@%^&=|\?~]/,X$=/\{\{\s*([A-Za-z0-9_\.]+?)\s*\}\}/,Pxa=/\{\{\s*[A-Za-z0-9_\.]+?\s*\}\}/;
$CLJS.h=W$.prototype;$CLJS.h.toString=function(){var a=$CLJS.vl.g(this);return $CLJS.m(a)?a:this.source};$CLJS.h.ka=function(a,b){return this.U(null,b,null)};$CLJS.h.U=function(a,b,c){switch(b instanceof $CLJS.N?b.N:null){case "tag":return this.tag;case "source":return this.source;default:return $CLJS.M.j(this.m,b,c)}};$CLJS.h.va=function(a,b,c){return $CLJS.Tb(function(d,e){var f=$CLJS.K(e,0,null);e=$CLJS.K(e,1,null);return b.j?b.j(d,f,e):b.call(null,d,f,e)},c,this)};
$CLJS.h.W=function(a,b,c){return $CLJS.Oi(b,function(d){return $CLJS.Oi(b,$CLJS.Ti,""," ","",c,d)},"#metabase.shared.parameters.parameters.TextParam{",", ","}",c,$CLJS.wg.h(new $CLJS.R(null,2,5,$CLJS.S,[new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.Al,this.tag],null),new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.Hu,this.source],null)],null),this.m))};$CLJS.h.oa=function(){return new $CLJS.jh(this,2,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.Al,$CLJS.Hu],null),$CLJS.m(this.m)?$CLJS.fd(this.m):$CLJS.Xf())};$CLJS.h.M=function(){return this.F};
$CLJS.h.ea=function(){return 2+$CLJS.E(this.m)};$CLJS.h.ca=function(){var a=this.G;return null!=a?a:this.G=a=-884441273^$CLJS.Ed(this)};$CLJS.h.T=function(a,b){return null!=b&&this.constructor===b.constructor&&$CLJS.F.h(this.tag,b.tag)&&$CLJS.F.h(this.source,b.source)&&$CLJS.F.h(this.m,b.m)};
$CLJS.h.za=function(a,b){return $CLJS.Ie(new $CLJS.ti(null,new $CLJS.k(null,2,[$CLJS.Hu,null,$CLJS.Al,null],null),null),b)?$CLJS.Jm.h($CLJS.Dc($CLJS.th.h($CLJS.P,this),this.F),b):new W$(this.tag,this.source,this.F,$CLJS.Vf($CLJS.Jm.h(this.m,b)),null)};$CLJS.h.ta=function(a,b){switch(b instanceof $CLJS.N?b.N:null){case "tag":case "source":return!0;default:return $CLJS.Ie(this.m,b)}};
$CLJS.h.$=function(a,b,c){return $CLJS.m($CLJS.O.h?$CLJS.O.h($CLJS.Al,b):$CLJS.O.call(null,$CLJS.Al,b))?new W$(c,this.source,this.F,this.m,null):$CLJS.m($CLJS.O.h?$CLJS.O.h($CLJS.Hu,b):$CLJS.O.call(null,$CLJS.Hu,b))?new W$(this.tag,c,this.F,this.m,null):new W$(this.tag,this.source,this.F,$CLJS.U.j(this.m,b,c),null)};$CLJS.h.da=function(){return $CLJS.A($CLJS.wg.h(new $CLJS.R(null,2,5,$CLJS.S,[new $CLJS.Ke($CLJS.Al,this.tag),new $CLJS.Ke($CLJS.Hu,this.source)],null),this.m))};
$CLJS.h.O=function(a,b){return new W$(this.tag,this.source,b,this.m,this.G)};$CLJS.h.ja=function(a,b){return $CLJS.qe(b)?this.$(null,$CLJS.be(b,0),$CLJS.be(b,1)):$CLJS.Tb($CLJS.dc,this,b)};var Txa=/\[\[.+\]\]/,Uxa=/\[\[(.+?)\]\]/,$$=function $$(a){switch(arguments.length){case 2:return $$.h(arguments[0],arguments[1]);case 3:return $$.j(arguments[0],arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",$CLJS.p.g(arguments.length)].join(""));}};
$CLJS.Ra("metabase.shared.parameters.parameters.substitute_tags",$$);$$.h=function(a,b){return $$.j(a,b,"en")};$$.j=function(a,b,c){return $CLJS.m(a)?(b=$CLJS.$E(b),b=$CLJS.wu(b,Wxa),Vxa(Rxa(Sxa(b,c,Qxa(a))))):null};$$.v=3;module.exports={tag_names:function(a){a=$CLJS.yi($CLJS.xg.h($CLJS.Zd,$CLJS.V5(X$,$CLJS.m(a)?a:"")));return $CLJS.pn(a)},substitute_tags:$$};