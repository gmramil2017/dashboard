var window=global;var $CLJS=require("./cljs_env.js");require("./cljs.core.js");require("./clojure.core.protocols.js");require("./clojure.string.js");require("./clojure.walk.js");require("./metabase.lib.metadata.protocols.js");require("./metabase.lib.util.js");require("./metabase.util.js");require("./metabase.util.log.js");
'use strict';var q9,s9,r9,Pwa,x9,y9,Qwa,Rwa,Swa,Twa,t9,Uwa,C9,Vwa,Wwa,Xwa;q9=function(a,b){return $CLJS.m(a)?$CLJS.Ua(a,b):null};s9=function(a,b){return r9(a,b,$CLJS.P)};
r9=function(a,b,c){c=$CLJS.Uf(c);c=$CLJS.M.j(c,t9,!0);if($CLJS.oe(b))return $CLJS.th.j($CLJS.P,a,b);c=$CLJS.m(c)?function(){var d=q9(b,"_plainObject");d=null==d?null:$CLJS.$E(d);return null==d?null:$CLJS.Vf(d)}():null;return $CLJS.m(c)?$CLJS.th.j($CLJS.P,a,c):$CLJS.th.j($CLJS.P,$CLJS.Rm.j($CLJS.xg.g(function(d){return new $CLJS.R(null,2,5,$CLJS.S,[d,q9(b,d)],null)}),$CLJS.Um.g(function(d){$CLJS.K(d,0,null);d=$CLJS.K(d,1,null);return $CLJS.F.h($CLJS.Na(d),"function")}),a),$CLJS.Ta(b))};
Pwa=function(a){var b=u9.g(a),c=v9.g(a);return $CLJS.Rm.j($CLJS.xg.g(function(d){var e=$CLJS.K(d,0,null);d=$CLJS.K(d,1,null);return new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.Ui.g((0,$CLJS.wF)(e)),d],null)}),$CLJS.je(b)?$CLJS.Ze:$CLJS.Um.g(function(d){var e=$CLJS.K(d,0,null);$CLJS.K(d,1,null);return $CLJS.Ie(b,e)}),$CLJS.Fb(c)?$CLJS.Ze:$CLJS.xg.g(function(d){var e=$CLJS.K(d,0,null);d=$CLJS.K(d,1,null);return new $CLJS.R(null,2,5,$CLJS.S,[e,c.h?c.h(e,d):c.call(null,e,d)],null)}))};
x9=function(a,b){var c=Pwa(a),d=w9.g(a);return function(e){try{var f=$CLJS.U.j(r9(c,e,b),$CLJS.wl,d),g=$CLJS.mF($CLJS.ND);$CLJS.m($CLJS.qF("metabase.lib.js.metadata",g))&&$CLJS.rF("metabase.lib.js.metadata",g,$CLJS.z_("Parsed metadata %s %s\n%s",$CLJS.J([a,$CLJS.Lk.g(f),$CLJS.B_(f)])),null);return f}catch(l){if(l instanceof Error)return f=l,g=$CLJS.mF($CLJS.Nu),$CLJS.m($CLJS.qF("metabase.lib.js.metadata",g))&&(f instanceof Error?$CLJS.rF("metabase.lib.js.metadata",g,$CLJS.z_("Error parsing %s %s: %s",
$CLJS.J([a,$CLJS.gj.l($CLJS.J([e])),$CLJS.rZ(f)])),f):$CLJS.rF("metabase.lib.js.metadata",g,$CLJS.z_(f,$CLJS.J(["Error parsing %s %s: %s",a,$CLJS.gj.l($CLJS.J([e])),$CLJS.rZ(f)])),null)),null;throw l;}}};y9=function(a){return $CLJS.Vm.h(x9($CLJS.PP,$CLJS.P),a)};Qwa=new $CLJS.N(null,"plain-object","plain-object",-943264281);$CLJS.z9=new $CLJS.N(null,"cards","cards",169174038);Rwa=new $CLJS.N(null,"db","db",993250759);$CLJS.A9=new $CLJS.N(null,"metrics","metrics",394093469);
Swa=new $CLJS.N(null,"fks","fks",2041987076);$CLJS.B9=new $CLJS.N(null,"segments","segments",1937535949);Twa=new $CLJS.N(null,"dimensions","dimensions",-254818097);t9=new $CLJS.N(null,"use-plain-object?","use-plain-object?",-1174595475);Uwa=new $CLJS.N(null,"metadata","metadata",1799301597);C9=new $CLJS.N(null,"dimension-options","dimension-options",2122379680);Vwa=new $CLJS.N(null,"schema-name","schema-name",1666725119);Wwa=new $CLJS.N(null,"_comesFromEndpoint","_comesFromEndpoint",-1390455588);
Xwa=new $CLJS.N(null,"default-dimension-option","default-dimension-option",149055958);$CLJS.D9=new $CLJS.N(null,"databases","databases",2040134125);var u9,Ywa=$CLJS.ij.g($CLJS.P),Zwa=$CLJS.ij.g($CLJS.P),$wa=$CLJS.ij.g($CLJS.P),axa=$CLJS.ij.g($CLJS.P),bxa=$CLJS.M.j($CLJS.P,$CLJS.Vk,$CLJS.rj.A?$CLJS.rj.A():$CLJS.rj.call(null)),F9,mxa,nxa,oxa,pxa,qxa;u9=new $CLJS.Aj($CLJS.$i.h("metabase.lib.js.metadata","excluded-keys"),$CLJS.Ui,$CLJS.Uj,bxa,Ywa,Zwa,$wa,axa);u9.o(null,$CLJS.Uj,function(){return null});
var v9,cxa=$CLJS.ij.g($CLJS.P),dxa=$CLJS.ij.g($CLJS.P),exa=$CLJS.ij.g($CLJS.P),fxa=$CLJS.ij.g($CLJS.P),gxa=$CLJS.M.j($CLJS.P,$CLJS.Vk,$CLJS.rj.A?$CLJS.rj.A():$CLJS.rj.call(null));v9=new $CLJS.Aj($CLJS.$i.h("metabase.lib.js.metadata","parse-field-fn"),$CLJS.Ui,$CLJS.Uj,gxa,cxa,dxa,exa,fxa);v9.o(null,$CLJS.Uj,function(){return null});var w9,hxa=$CLJS.ij.g($CLJS.P),ixa=$CLJS.ij.g($CLJS.P),jxa=$CLJS.ij.g($CLJS.P),kxa=$CLJS.ij.g($CLJS.P),lxa=$CLJS.M.j($CLJS.P,$CLJS.Vk,$CLJS.rj.A?$CLJS.rj.A():$CLJS.rj.call(null));
w9=new $CLJS.Aj($CLJS.$i.h("metabase.lib.js.metadata","lib-type"),$CLJS.Ui,$CLJS.Uj,lxa,hxa,ixa,jxa,kxa);$CLJS.E9=function(){var a=$CLJS.ij.g($CLJS.P),b=$CLJS.ij.g($CLJS.P),c=$CLJS.ij.g($CLJS.P),d=$CLJS.ij.g($CLJS.P),e=$CLJS.M.j($CLJS.P,$CLJS.Vk,$CLJS.rj.A?$CLJS.rj.A():$CLJS.rj.call(null));return new $CLJS.Aj($CLJS.$i.h("metabase.lib.js.metadata","parse-objects"),function(f){return $CLJS.Ui.g(f)},$CLJS.Uj,e,a,b,c,d)}();mxa=$CLJS.ij.g($CLJS.P);nxa=$CLJS.ij.g($CLJS.P);oxa=$CLJS.ij.g($CLJS.P);pxa=$CLJS.ij.g($CLJS.P);
qxa=$CLJS.M.j($CLJS.P,$CLJS.Vk,$CLJS.rj.A?$CLJS.rj.A():$CLJS.rj.call(null));F9=new $CLJS.Aj($CLJS.$i.h("metabase.lib.js.metadata","parse-objects-default-key"),$CLJS.Ui,$CLJS.Uj,qxa,mxa,nxa,oxa,pxa);$CLJS.E9.o(null,$CLJS.Uj,function(a,b){var c=x9(a,$CLJS.P);return s9($CLJS.xg.g(function(d){var e=$CLJS.K(d,0,null),f=$CLJS.K(d,1,null);return new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.A_(e),new $CLJS.dj(function(){return c.g?c.g(f):c.call(null,f)})],null)}),q9(b,F9.g(a)))});w9.o(null,$CLJS.YP,function(){return $CLJS.gpa});
u9.o(null,$CLJS.YP,function(){return new $CLJS.ti(null,new $CLJS.k(null,2,[$CLJS.AH,null,$CLJS.M_,null],null),null)});v9.o(null,$CLJS.YP,function(){return function(a,b){switch(a instanceof $CLJS.N?a.N:null){case "dbms-version":return $CLJS.ZE(b,$CLJS.J([$CLJS.kk,!0]));case "features":return $CLJS.th.j($CLJS.ui,$CLJS.xg.g($CLJS.Ui),b);case "native-permissions":return $CLJS.Ui.g(b);default:return b}}});F9.o(null,$CLJS.YP,function(){return"databases"});w9.o(null,$CLJS.O_,function(){return $CLJS.L_});
u9.o(null,$CLJS.O_,function(){return new $CLJS.ti(null,new $CLJS.k(null,5,[C9,null,$CLJS.AH,null,$CLJS.B9,null,$CLJS.YP,null,$CLJS.A9,null],null),null)});v9.o(null,$CLJS.O_,function(){return function(a,b){switch(a instanceof $CLJS.N?a.N:null){case "entity-type":return $CLJS.Ui.g(b);case "field-order":return $CLJS.Ui.g(b);case "initial-sync-status":return $CLJS.Ui.g(b);case "visibility-type":return $CLJS.Ui.g(b);default:return b}}});
$CLJS.E9.o(null,$CLJS.O_,function(a,b){var c=x9(a,$CLJS.P);return s9($CLJS.Rm.h($CLJS.Um.g(function(d){var e=$CLJS.K(d,0,null);$CLJS.K(d,1,null);return 0==e.lastIndexOf("card__",0)}),$CLJS.xg.g(function(d){var e=$CLJS.K(d,0,null),f=$CLJS.K(d,1,null);return new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.A_(e),new $CLJS.dj(function(){return c.g?c.g(f):c.call(null,f)})],null)})),q9(b,"tables"))});w9.o(null,$CLJS.PP,function(){return $CLJS.xV});
u9.o(null,$CLJS.PP,function(){return new $CLJS.ti(null,new $CLJS.k(null,7,[C9,null,$CLJS.O_,null,Twa,null,Xwa,null,$CLJS.YP,null,Wwa,null,$CLJS.A9,null],null),null)});
v9.o(null,$CLJS.PP,function(){return function(a,b){switch(a instanceof $CLJS.N?a.N:null){case "base-type":return $CLJS.Ui.g(b);case "coercion-strategy":return $CLJS.Ui.g(b);case "effective-type":return $CLJS.Ui.g(b);case "fingerprint":return $CLJS.oe(b)?$CLJS.xZ(b):$CLJS.ZE(b,$CLJS.J([$CLJS.kk,!0]));case "has-field-values":return $CLJS.Ui.g(b);case "semantic-type":return $CLJS.Ui.g(b);case "visibility-type":return $CLJS.Ui.g(b);case "id":return $CLJS.qe(b)?$CLJS.Zd(b):b;default:return b}}});
F9.o(null,$CLJS.PP,function(){return"fields"});w9.o(null,$CLJS.ZN,function(){return $CLJS.P_});u9.o(null,$CLJS.ZN,function(){return new $CLJS.ti(null,new $CLJS.k(null,11,[C9,null,$CLJS.hm,null,Swa,null,$CLJS.O_,null,Rwa,null,Qwa,null,$CLJS.B9,null,$CLJS.YP,null,Uwa,null,$CLJS.A9,null,Vwa,null],null),null)});
v9.o(null,$CLJS.ZN,function(){return function(a,b){switch(a instanceof $CLJS.N?a.N:null){case "result-metadata":return $CLJS.m($CLJS.Tm.h($CLJS.ne,$CLJS.Cb)(b))?y9(b):$CLJS.ZE(b,$CLJS.J([$CLJS.kk,!0]));case "fields":return y9(b);case "visibility-type":return $CLJS.Ui.g(b);case "dataset-query":return $CLJS.ZE(b,$CLJS.J([$CLJS.kk,!0]));case "dataset":return b;default:return b}}});
$CLJS.E9.o(null,$CLJS.ZN,function(a,b){return $CLJS.th.j($CLJS.P,$CLJS.xg.g(function(c){return new $CLJS.R(null,2,5,$CLJS.S,[c,new $CLJS.dj(function(){var d=x9($CLJS.ZN,new $CLJS.k(null,1,[t9,!1],null)),e=x9($CLJS.ZN,$CLJS.P),f=$CLJS.mn.l;d=$CLJS.U.j(d(q9(q9(b,"tables"),["card__",$CLJS.p.g(c)].join(""))),$CLJS.Lk,c);var g=q9(q9(b,"questions"),$CLJS.p.g(c));var l=q9(g,"_card");g=$CLJS.m(l)?l:g;e=e.g?e.g(g):e.call(null,g);return f.call($CLJS.mn,$CLJS.J([d,e]))})],null)}),$CLJS.th.j($CLJS.th.j($CLJS.ui,
$CLJS.En($CLJS.I_),$CLJS.Ta(q9(b,"tables"))),$CLJS.xg.g($CLJS.A_),$CLJS.Ta(q9(b,"questions"))))});w9.o(null,$CLJS.mP,function(){return $CLJS.yV});u9.o(null,$CLJS.mP,function(){return new $CLJS.ti(null,new $CLJS.k(null,2,[$CLJS.O_,null,$CLJS.YP,null],null),null)});v9.o(null,$CLJS.mP,function(){return function(a,b){return b}});F9.o(null,$CLJS.mP,function(){return"metrics"});w9.o(null,$CLJS.sH,function(){return $CLJS.K_});
u9.o(null,$CLJS.sH,function(){return new $CLJS.ti(null,new $CLJS.k(null,2,[$CLJS.O_,null,$CLJS.YP,null],null),null)});v9.o(null,$CLJS.sH,function(){return function(a,b){return b}});F9.o(null,$CLJS.sH,function(){return"segments"});