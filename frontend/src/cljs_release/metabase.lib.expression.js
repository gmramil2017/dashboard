var window=global;var $CLJS=require("./cljs_env.js");require("./cljs.core.js");require("./clojure.string.js");require("./medley.core.js");require("./metabase.lib.common.js");require("./metabase.lib.hierarchy.js");require("./metabase.lib.metadata.js");require("./metabase.lib.metadata.calculation.js");require("./metabase.lib.options.js");require("./metabase.lib.ref.js");require("./metabase.lib.schema.js");require("./metabase.lib.schema.common.js");require("./metabase.lib.schema.expression.js");require("./metabase.lib.schema.temporal_bucketing.js");require("./metabase.lib.temporal_bucket.js");require("./metabase.lib.util.js");require("./metabase.shared.util.i18n.js");require("./metabase.types.js");require("./metabase.util.js");require("./metabase.util.malli.js");
'use strict';var e5=function(a){return $CLJS.m(d5)?["(",$CLJS.p.g(a),")"].join(""):a},f5=new $CLJS.N("metabase.lib.expression","infix-operator","metabase.lib.expression/infix-operator",246733613);$CLJS.Z0.o(null,$CLJS.IF,function(a,b,c){$CLJS.K(c,0,null);$CLJS.K(c,1,null);c=$CLJS.K(c,2,null);var d=$CLJS.s0(a,b);d=$CLJS.LV($CLJS.Rm.h($CLJS.vi([c]),$CLJS.D_),$CLJS.aQ.g(d));if(!$CLJS.m(d))throw $CLJS.Ej($CLJS.aH("No expression named {0}",$CLJS.J([$CLJS.gj.l($CLJS.J([c]))])),new $CLJS.k(null,3,[$CLJS.wR,c,$CLJS.GN,a,$CLJS.N0,b],null));return $CLJS.$0.j(a,b,d)});
$CLJS.y0.o(null,$CLJS.IF,function(a,b,c){$CLJS.K(c,0,null);var d=$CLJS.K(c,1,null),e=$CLJS.K(c,2,null);return new $CLJS.k(null,6,[$CLJS.wl,$CLJS.xV,$CLJS.L1,$CLJS.EK.g(d),$CLJS.V,e,$CLJS.YH,$CLJS.z0.j(a,b,c),$CLJS.LF,$CLJS.$0.j(a,b,c),$CLJS.J_,$CLJS.X_],null)});$CLJS.V0.o(null,$CLJS.DF,function(a,b,c){return $CLJS.p.g(c)});$CLJS.V0.o(null,$CLJS.BF,function(a,b,c){return $CLJS.p.g(c)});$CLJS.V0.o(null,$CLJS.CF,function(a,b,c){return['"',$CLJS.p.g(c),'"'].join("")});
$CLJS.V0.o(null,$CLJS.IF,function(a,b,c){$CLJS.K(c,0,null);$CLJS.K(c,1,null);return $CLJS.K(c,2,null)});$CLJS.W0.o(null,$CLJS.IF,function(a,b,c){$CLJS.K(c,0,null);$CLJS.K(c,1,null);return $CLJS.K(c,2,null)});
for(var d5=!1,csa=new $CLJS.k(null,4,[$CLJS.rm,"+",$CLJS.hu,"-",$CLJS.sm,"ร",$CLJS.XJ,"รท"],null),g5=$CLJS.A(new $CLJS.R(null,4,5,$CLJS.S,[$CLJS.rm,$CLJS.hu,$CLJS.XJ,$CLJS.sm],null)),h5=null,i5=0,j5=0;;)if(j5<i5){var dsa=h5.aa(null,j5);$CLJS.BU(dsa,f5);j5+=1}else{var k5=$CLJS.A(g5);if(k5){var l5=k5;if($CLJS.re(l5)){var m5=$CLJS.$c(l5),esa=$CLJS.ad(l5),fsa=m5,gsa=$CLJS.E(m5);g5=esa;h5=fsa;i5=gsa}else{var hsa=$CLJS.C(l5);$CLJS.BU(hsa,f5);g5=$CLJS.D(l5);h5=null;i5=0}j5=0}else break}
$CLJS.V0.o(null,f5,function(a,b,c){var d=$CLJS.A(c);c=$CLJS.C(d);d=$CLJS.D(d);$CLJS.C(d);d=$CLJS.D(d);c=$CLJS.M.h(csa,c);a:{var e=d5;d5=!0;try{var f=$CLJS.Uu.h([" ",$CLJS.Ai(c)," "].join(""),$CLJS.xg.h($CLJS.qz($CLJS.z0,a,b),d));break a}finally{d5=e}f=void 0}return e5(f)});$CLJS.W0.o(null,f5,function(){return"expression"});
$CLJS.Z0.o(null,$CLJS.RV,function(a,b,c){c=$CLJS.A(c);$CLJS.C(c);c=$CLJS.D(c);$CLJS.C(c);var d=$CLJS.D(c);return $CLJS.We($CLJS.AU,function(){return function g(f){return new $CLJS.Af(null,function(){for(;;){var l=$CLJS.A(f);if(l){if($CLJS.re(l)){var n=$CLJS.$c(l),q=$CLJS.E(n),u=$CLJS.Df(q);a:for(var v=0;;)if(v<q){var x=$CLJS.be(n,v);x=$CLJS.$0.j(a,b,x);u.add(x);v+=1}else{n=!0;break a}return n?$CLJS.If($CLJS.Kf(u),g($CLJS.ad(l))):$CLJS.If($CLJS.Kf(u),null)}u=$CLJS.C(l);return $CLJS.pf($CLJS.$0.j(a,
b,u),g($CLJS.zd(l)))}return null}},null,null)}(d)}())});$CLJS.V0.o(null,$CLJS.jJ,function(a,b,c,d){$CLJS.K(c,0,null);$CLJS.K(c,1,null);var e=$CLJS.K(c,2,null),f=$CLJS.K(c,3,null);c=$CLJS.K(c,4,null);a=$CLJS.p.g($CLJS.z0.C(a,b,e,d));b=$CLJS.p;d=b.g;c=$CLJS.M1.h(f,c).toLowerCase();0<f?f=$CLJS.xa.j?$CLJS.xa.j("+ %d %s",f,c):$CLJS.xa.call(null,"+ %d %s",f,c):(f=Math.abs(f),f=$CLJS.xa.j?$CLJS.xa.j("- %d %s",f,c):$CLJS.xa.call(null,"- %d %s",f,c));f=e5(f);return[a," ",d.call(b,f)].join("")});
$CLJS.W0.o(null,$CLJS.jJ,function(a,b,c){$CLJS.K(c,0,null);$CLJS.K(c,1,null);var d=$CLJS.K(c,2,null),e=$CLJS.K(c,3,null);c=$CLJS.K(c,4,null);a=$CLJS.p.g($CLJS.X0.j(a,b,d));b=$CLJS.p;d=b.g;c=$CLJS.M1.h(e,c).toLowerCase();0<e?e=$CLJS.xa.j?$CLJS.xa.j("plus_%s_%s",e,c):$CLJS.xa.call(null,"plus_%s_%s",e,c):(e=Math.abs(e),e=$CLJS.xa.j?$CLJS.xa.j("minus_%d_%s",e,c):$CLJS.xa.call(null,"minus_%d_%s",e,c));return[a,"_",d.call(b,e)].join("")});
$CLJS.V0.o(null,$CLJS.WI,function(a,b,c,d){$CLJS.K(c,0,null);$CLJS.K(c,1,null);var e=$CLJS.K(c,2,null);$CLJS.K(c,3,null);return $CLJS.z0.C(a,b,e,d)});$CLJS.W0.o(null,$CLJS.WI,function(a,b,c){$CLJS.K(c,0,null);$CLJS.K(c,1,null);var d=$CLJS.K(c,2,null);$CLJS.K(c,3,null);return $CLJS.X0.j(a,b,d)});$CLJS.rV.o(null,$CLJS.IF,function(a){return a});