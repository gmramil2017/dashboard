var window=global;var $CLJS=require("./cljs_env.js");require("./cljs.core.js");require("./clojure.set.js");require("./malli.core.js");require("./metabase.lib.hierarchy.js");require("./metabase.lib.schema.common.js");require("./metabase.lib.schema.expression.js");require("./metabase.lib.schema.literal.js");require("./metabase.lib.schema.mbql_clause.js");require("./metabase.lib.schema.temporal_bucketing.js");require("./metabase.util.malli.registry.js");require("./shadow.js.shim.module$moment.js");require("./shadow.js.shim.module$moment_timezone.js");
'use strict';var UW,VW,WW,YW,ZW,$W,aX;UW=new $CLJS.N("metabase.lib.schema.expression.temporal","absolute-datetime.options","metabase.lib.schema.expression.temporal/absolute-datetime.options",-925669633);VW=new $CLJS.N("metabase.lib.schema.expression.temporal","temporal-extract.unit","metabase.lib.schema.expression.temporal/temporal-extract.unit",339336486);
WW=new $CLJS.N("metabase.lib.schema.expression.temporal","absolute-datetime.base-type","metabase.lib.schema.expression.temporal/absolute-datetime.base-type",-904703365);$CLJS.XW=new $CLJS.N("lib.type-of","type-is-temporal-type-of-first-arg","lib.type-of/type-is-temporal-type-of-first-arg",76272405);YW=new $CLJS.N("metabase.lib.schema.expression.temporal","temporal-extract.week-mode","metabase.lib.schema.expression.temporal/temporal-extract.week-mode",430590916);
ZW=new $CLJS.N("metabase.lib.schema.expression.temporal","relative-datetime.amount","metabase.lib.schema.expression.temporal/relative-datetime.amount",7216442);$W=new $CLJS.N("metabase.lib.schema.expression.temporal","timezone-id","metabase.lib.schema.expression.temporal/timezone-id",-1909635091);aX=new $CLJS.N("metabase.lib.schema.expression.temporal","get-week-mode","metabase.lib.schema.expression.temporal/get-week-mode",1489967652);$CLJS.MU($CLJS.mI,$CLJS.J([$CLJS.hu,$CLJS.pI,$CLJS.zt,$CLJS.WU]));$CLJS.KK.o(null,$CLJS.XW,function(a){$CLJS.K(a,0,null);$CLJS.K(a,1,null);a=$CLJS.K(a,2,null);a=$CLJS.LK(a);return $CLJS.le(a)?(a=$CLJS.wz.h(a,new $CLJS.ti(null,new $CLJS.k(null,2,[$CLJS.UH,null,$CLJS.YI,null],null),null)),$CLJS.F.h($CLJS.E(a),1)?$CLJS.C(a):a):a});$CLJS.BU($CLJS.XW,$CLJS.XK);
for(var bX=$CLJS.A(new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.jJ,$CLJS.RJ],null)),cX=null,dX=0,eX=0;;)if(eX<dX){var fX=cX.aa(null,eX);$CLJS.MU(fX,$CLJS.J([new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.nq,$CLJS.RK],null),$CLJS.zt,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.nq,$CLJS.WU],null)]));$CLJS.BU(fX,$CLJS.XW);eX+=1}else{var gX=$CLJS.A(bX);if(gX){var hX=gX;if($CLJS.re(hX)){var iX=$CLJS.$c(hX),ana=$CLJS.ad(hX),bna=iX,cna=$CLJS.E(iX);bX=ana;cX=bna;dX=cna}else{var jX=$CLJS.C(hX);$CLJS.MU(jX,$CLJS.J([new $CLJS.R(null,2,
5,$CLJS.S,[$CLJS.nq,$CLJS.RK],null),$CLJS.zt,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.nq,$CLJS.WU],null)]));$CLJS.BU(jX,$CLJS.XW);bX=$CLJS.D(hX);cX=null;dX=0}eX=0}else break}
for(var kX=$CLJS.A(new $CLJS.R(null,7,5,$CLJS.S,[$CLJS.KH,$CLJS.eH,$CLJS.gJ,$CLJS.DJ,$CLJS.mJ,$CLJS.JH,$CLJS.$J],null)),lX=null,mX=0,nX=0;;)if(nX<mX){var dna=lX.aa(null,nX);$CLJS.MU(dna,$CLJS.J([$CLJS.hu,$CLJS.nl,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.hm,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.nq,$CLJS.RK],null)],null)]));nX+=1}else{var oX=$CLJS.A(kX);if(oX){var pX=oX;if($CLJS.re(pX)){var qX=$CLJS.$c(pX),ena=$CLJS.ad(pX),fna=qX,gna=$CLJS.E(qX);kX=ena;lX=fna;mX=gna}else{var hna=$CLJS.C(pX);$CLJS.MU(hna,$CLJS.J([$CLJS.hu,
$CLJS.nl,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.hm,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.nq,$CLJS.RK],null)],null)]));kX=$CLJS.D(pX);lX=null;mX=0}nX=0}else break}$CLJS.MU($CLJS.lI,$CLJS.J([$CLJS.hu,$CLJS.nl,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.hm,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.nq,$CLJS.RK],null)],null),new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.hm,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.nq,$CLJS.RK],null)],null),new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.nq,$CLJS.TU],null)]));
for(var rX=$CLJS.A(new $CLJS.ti(null,new $CLJS.k(null,8,[$CLJS.$J,null,$CLJS.mJ,null,$CLJS.DJ,null,$CLJS.pJ,null,$CLJS.JH,null,$CLJS.eH,null,$CLJS.KH,null,$CLJS.gJ,null],null),null)),sX=null,tX=0,uX=0;;)if(uX<tX){var ina=sX.aa(null,uX);$CLJS.MU(ina,$CLJS.J([$CLJS.hu,$CLJS.nl,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.hm,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.nq,$CLJS.RK],null)],null)]));uX+=1}else{var vX=$CLJS.A(rX);if(vX){var wX=vX;if($CLJS.re(wX)){var xX=$CLJS.$c(wX),jna=$CLJS.ad(wX),kna=xX,lna=$CLJS.E(xX);
rX=jna;sX=kna;tX=lna}else{var mna=$CLJS.C(wX);$CLJS.MU(mna,$CLJS.J([$CLJS.hu,$CLJS.nl,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.hm,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.nq,$CLJS.RK],null)],null)]));rX=$CLJS.D(wX);sX=null;tX=0}uX=0}else break}$CLJS.rK(aX,new $CLJS.R(null,4,5,$CLJS.S,[$CLJS.ot,$CLJS.BH,$CLJS.vI,$CLJS.NI],null));
$CLJS.OU($CLJS.iJ,$CLJS.J([$CLJS.hu,$CLJS.nl,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.GI,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.hm,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.nq,$CLJS.RK],null)],null)],null),new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.ik,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.Zs,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.hm,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.nq,aX],null)],null)],null)],null)]));
$CLJS.rK($W,new $CLJS.R(null,3,5,$CLJS.S,[$CLJS.Qj,$CLJS.zK,$CLJS.th.h(new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.ot,new $CLJS.k(null,2,[$CLJS.Wu,"valid timezone ID",$CLJS.Yu,function(a){a=$CLJS.Uf(a);a=$CLJS.M.h(a,$CLJS.vl);return["invalid timezone ID: ",$CLJS.gj.l($CLJS.J([a]))].join("")}],null)],null),$CLJS.Qe($CLJS.Me,$CLJS.cL.tz.names()))],null));
$CLJS.OU($CLJS.zH,$CLJS.J([new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.GI,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.hm,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.nq,$CLJS.RK],null)],null)],null),new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.hK,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.hm,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.nq,$W],null)],null)],null),new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.Hu,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.Zs,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.hm,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.nq,$W],null)],null)],null)],null)]));
$CLJS.BU($CLJS.zH,$CLJS.XW);$CLJS.MU($CLJS.II,$CLJS.J([$CLJS.hu,$CLJS.aI]));$CLJS.rK(WW,new $CLJS.R(null,3,5,$CLJS.S,[$CLJS.Qj,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.nq,$CLJS.FK],null),new $CLJS.R(null,3,5,$CLJS.S,[$CLJS.pt,new $CLJS.k(null,1,[$CLJS.Wu,":absolute-datetime base-type must derive from :type/Date or :type/DateTime"],null),function(a){return $CLJS.ag(function(b){return $CLJS.XG(a,b)},new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.UH,$CLJS.YI],null))}],null)],null));
$CLJS.rK(UW,new $CLJS.R(null,3,5,$CLJS.S,[$CLJS.Qt,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.nq,$CLJS.DK],null),new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.bm,new $CLJS.R(null,3,5,$CLJS.S,[$CLJS.LF,new $CLJS.k(null,1,[$CLJS.Wj,!0],null),new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.nq,WW],null)],null)],null)],null));
$CLJS.IU($CLJS.LH,new $CLJS.R(null,5,5,$CLJS.S,[$CLJS.ft,new $CLJS.k(null,1,[$CLJS.Wu,"valid :absolute-datetime clause"],null),new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.lm,$CLJS.LH],null),new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.hm,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.nq,UW],null)],null),new $CLJS.R(null,3,5,$CLJS.S,[$CLJS.ht,new $CLJS.R(null,4,5,$CLJS.S,[$CLJS.ft,new $CLJS.k(null,1,[$CLJS.Wu,":absolute-datetime literal and unit for :type/Date"],null),new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.hm,new $CLJS.R(null,4,
5,$CLJS.S,[$CLJS.Gk,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.nq,$CLJS.KW],null),new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.nq,$CLJS.MW],null),new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.nq,$CLJS.FW],null)],null)],null),new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.hm,new $CLJS.R(null,3,5,$CLJS.S,[$CLJS.Gk,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.lm,$CLJS.Uj],null),new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.nq,$CLJS.VU],null)],null)],null)],null),new $CLJS.R(null,4,5,$CLJS.S,[$CLJS.ft,new $CLJS.k(null,1,[$CLJS.Wu,":absolute-datetime literal and unit for :type/DateTime"],
null),new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.hm,new $CLJS.R(null,3,5,$CLJS.S,[$CLJS.Gk,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.lm,$CLJS.eB],null),new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.nq,$CLJS.OW],null)],null)],null),new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.hm,new $CLJS.R(null,3,5,$CLJS.S,[$CLJS.Gk,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.lm,$CLJS.Uj],null),new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.nq,$CLJS.SU],null)],null)],null)],null)],null)],null));
$CLJS.KK.o(null,$CLJS.LH,function(a){$CLJS.K(a,0,null);$CLJS.K(a,1,null);var b=$CLJS.K(a,2,null);a=$CLJS.K(a,3,null);a=$CLJS.F.h(b,$CLJS.eB)?$CLJS.F.h(a,$CLJS.Uj)?$CLJS.YI:$CLJS.m($CLJS.DU($CLJS.VU,a))?$CLJS.UH:$CLJS.YI:null;if($CLJS.m(a))return a;a="string"===typeof b?$CLJS.m($CLJS.Ji($CLJS.SW,b))?$CLJS.UH:$CLJS.m($CLJS.Ji($CLJS.TW,b))?$CLJS.UH:null:null;if($CLJS.m(a))return a;b=$CLJS.LK(b);b=$CLJS.le(b)?$CLJS.th.j($CLJS.ui,$CLJS.zg(function(c){return $CLJS.XG(c,$CLJS.Ql)}),b):b;return $CLJS.le(b)&&
$CLJS.F.h($CLJS.E(b),1)?$CLJS.C(b):b});$CLJS.rK(ZW,new $CLJS.R(null,3,5,$CLJS.S,[$CLJS.Gk,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.lm,$CLJS.eB],null),$CLJS.zt],null));
$CLJS.OU($CLJS.wI,$CLJS.J([$CLJS.hu,$CLJS.YI,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.lC,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.hm,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.nq,ZW],null)],null)],null),new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.bk,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.Zs,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.hm,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.nq,$CLJS.WU],null)],null)],null)],null)]));
$CLJS.MU($CLJS.QD,$CLJS.J([$CLJS.hu,$CLJS.eK,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.hm,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.nq,$CLJS.ZK],null)],null),new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.nq,$CLJS.UU],null)]));$CLJS.rK(VW,new $CLJS.R(null,12,5,$CLJS.S,[$CLJS.ot,$CLJS.jI,$CLJS.lk,$CLJS.fm,$CLJS.bI,$CLJS.bK,$CLJS.gK,$CLJS.zl,$CLJS.rk,$CLJS.gk,$CLJS.Wk,$CLJS.OH],null));$CLJS.rK(YW,new $CLJS.R(null,4,5,$CLJS.S,[$CLJS.ot,$CLJS.BH,$CLJS.vI,$CLJS.NI],null));
$CLJS.OU($CLJS.uJ,$CLJS.J([$CLJS.hu,$CLJS.nl,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.GI,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.hm,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.nq,$CLJS.RK],null)],null)],null),new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.bk,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.hm,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.nq,VW],null)],null)],null),new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.ik,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.Zs,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.hm,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.nq,YW],null)],null)],
null)],null)]));