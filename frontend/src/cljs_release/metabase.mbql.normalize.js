var window=global;var $CLJS=require("./cljs_env.js");require("./cljs.core.js");require("./clojure.set.js");require("./clojure.walk.js");require("./medley.core.js");require("./metabase.mbql.util.js");require("./metabase.mbql.util.match.js");require("./metabase.shared.util.i18n.js");require("./metabase.util.log.js");
'use strict';var Qsa,T5,W5,S5,X5,Rsa,Ssa,Tsa,$5,a6,c6,d6,e6,f6,g6,h6,R5,Vsa,Wsa,k6,Xsa,l6,Ysa,n6,Zsa,$sa,ata,bta,cta,U5,i6,dta,q6,r6,s6,eta,t6,u6,v6,fta,w6,x6,gta,hta,p6,Z5,ita,jta,kta,Usa;Qsa=function(a){var b=R5;return $CLJS.nF(function(c){return function(d,e,f){f=b.g?b.g(f):b.call(null,f);return c.j?c.j(d,e,f):c.call(null,d,e,f)}},a)};T5=function(a){var b=S5;return $CLJS.nF(function(c){return function(d,e,f){e=b.g?b.g(e):b.call(null,e);return c.j?c.j(d,e,f):c.call(null,d,e,f)}},a)};
$CLJS.V5=function(a,b){if("string"===typeof b)return U5(a,b);throw new TypeError("re-seq must match against a string.");};W5=function(a){var b=$CLJS.ne(a);return b?(b=!$CLJS.Og(a))?$CLJS.Tm.h($CLJS.rf,$CLJS.Jb)($CLJS.C(a)):b:b};S5=function(a){return $CLJS.m($CLJS.Tm.h($CLJS.rf,$CLJS.Jb)(a))?$CLJS.k_(a):a};X5=function(a,b){var c=W5(b);return $CLJS.m(c)?(b=S5($CLJS.C(b)),$CLJS.ke(a)?(a=$CLJS.yi(a),a.g?a.g(b):a.call(null,b)):$CLJS.F.h(a,b)):c};
Rsa=function(a){return $CLJS.M.j(new $CLJS.k(null,3,[$CLJS.Uj,$CLJS.Ze,$CLJS.al,S5,$CLJS.pO,S5],null),a,function(b){var c=$CLJS.M,d=c.h;b=$CLJS.Tf([a,b]);b=Y5.h?Y5.h(b,Z5):Y5.call(null,b,Z5);return d.call(c,b,a)})};
Ssa=function(a){a=$CLJS.th.j($CLJS.P,$CLJS.xg.g(function(b){var c=$CLJS.K(b,0,null);b=$CLJS.K(b,1,null);c=S5(c);var d=Rsa(c);return new $CLJS.R(null,2,5,$CLJS.S,[c,d.g?d.g(b):d.call(null,b)],null)}),a);return $CLJS.F.h($CLJS.al.g(a),$CLJS.vN)&&$CLJS.Fb($CLJS.pO.g(a))?$CLJS.U.j(a,$CLJS.pO,$CLJS.SQ):a};
Tsa=function(a){return $CLJS.th.j($CLJS.P,$CLJS.xg.g(function(b){var c=$CLJS.K(b,0,null);b=$CLJS.K(b,1,null);c=$CLJS.GZ(c);return new $CLJS.R(null,2,5,$CLJS.S,[c,$CLJS.U.j(Ssa(b),$CLJS.V,c)],null)}),a)};$5=function(a){return $CLJS.SZ.j($CLJS.SZ.j($CLJS.Tb(function(b,c){return $CLJS.SZ.j(b,c,$CLJS.Ui)},a,new $CLJS.R(null,6,5,$CLJS.S,[$CLJS.yI,$CLJS.xga,$CLJS.OO,Usa,$CLJS.Hu,$CLJS.bk],null)),$CLJS.QF,$CLJS.Rm.h(R5,Y5)),$CLJS.qO,$CLJS.xZ)};
a6=function(a){return $CLJS.Ae(a)?new $CLJS.R(null,3,5,$CLJS.S,[$CLJS.PP,a,null],null):a};c6=function(a){return b6.g(a6(a))};d6=function(a){var b=$CLJS.A(a);a=$CLJS.C(b);b=$CLJS.D(b);return $CLJS.JZ($CLJS.th.h(new $CLJS.R(null,1,5,$CLJS.S,[a],null),$CLJS.xg.h(b6,b)))};e6=function(a){var b=$CLJS.A(a);a=$CLJS.C(b);var c=$CLJS.D(b);b=$CLJS.C(c);c=$CLJS.D(c);return $CLJS.th.h(new $CLJS.R(null,2,5,$CLJS.S,[a,c6(b)],null),$CLJS.xg.h(b6,c))};
f6=function(a){var b=$CLJS.K(a,0,null);a=$CLJS.K(a,1,null);return $CLJS.m(a)?new $CLJS.R(null,2,5,$CLJS.S,[b,c6(a)],null):new $CLJS.R(null,1,5,$CLJS.S,[b],null)};g6=function(a){var b=$CLJS.K(a,0,null);a=$CLJS.K(a,1,null);return new $CLJS.R(null,2,5,$CLJS.S,[b,c6(a)],null)};h6=function(a){var b=$CLJS.K(a,0,null);a=$CLJS.K(a,1,null);return new $CLJS.R(null,2,5,$CLJS.S,[b,b6.g(a)],null)};
R5=function(a){return i6(function(b){if($CLJS.oe(b))return Qsa(b);if($CLJS.Fb(W5(b)))return b;try{return b6.g(b)}catch(f){if(f instanceof Error){var c=f,d=$CLJS.mF($CLJS.Nu);if($CLJS.m($CLJS.qF("metabase.mbql.normalize",d))){var e=$CLJS.bH("Invalid clause:");e instanceof Error?$CLJS.rF("metabase.mbql.normalize",d,$CLJS.MB.l($CLJS.J([b])),e):$CLJS.rF("metabase.mbql.normalize",d,$CLJS.MB.l($CLJS.J([e,b])),null)}throw $CLJS.Dj($CLJS.aH("Invalid MBQL clause: {0}",$CLJS.J([$CLJS.rZ(c)])),new $CLJS.k(null,
1,[$CLJS.vR,b],null),c);}throw f;}},a)};Vsa=function(a){return $CLJS.Sg($CLJS.ig(R5,j6(a)))};Wsa=function(a){for(;;)if($CLJS.m(W5(a)))a=new $CLJS.R(null,1,5,$CLJS.S,[a],null);else return $CLJS.Vf($CLJS.Vm.h(a6,a))};k6=function(a){a=$CLJS.Uf(a);var b=$CLJS.M.h(a,$CLJS.vN);return $CLJS.m(b)?$CLJS.Wm.j(a,$CLJS.vN,b6):a};
Xsa=function(a){return $CLJS.th.h($CLJS.P,function(){return function d(c){return new $CLJS.Af(null,function(){for(;;){var e=$CLJS.A(c);if(e){if($CLJS.re(e)){var f=$CLJS.$c(e),g=$CLJS.E(f),l=$CLJS.Df(g);a:for(var n=0;;)if(n<g){var q=$CLJS.be(f,n),u=$CLJS.K(q,0,null);q=$CLJS.K(q,1,null);u=new $CLJS.R(null,2,5,$CLJS.S,[u,k6(q)],null);l.add(u);n+=1}else{f=!0;break a}return f?$CLJS.If($CLJS.Kf(l),d($CLJS.ad(e))):$CLJS.If($CLJS.Kf(l),null)}f=$CLJS.C(e);l=$CLJS.K(f,0,null);f=$CLJS.K(f,1,null);return $CLJS.pf(new $CLJS.R(null,
2,5,$CLJS.S,[l,k6(f)],null),d($CLJS.zd(e)))}return null}},null,null)}(a)}())};l6=function(a){a=$CLJS.Uf(a);var b=$CLJS.M.h(a,$CLJS.uQ);return $CLJS.m(b)?$CLJS.Wm.j(a,$CLJS.uQ,Xsa):a};Ysa=function(a){var b=$CLJS.Uf(a);a=$CLJS.M.h(b,$CLJS.fQ);b=$CLJS.Fb(a)?m6.g?m6.g(b):m6.call(null,b):b;return $CLJS.m(a)?l6(b):b};n6=function(a){return $CLJS.ke(a)?$CLJS.A(a):null!=a};
Zsa=function(a){var b=$CLJS.Uf(a);a=$CLJS.M.h(b,$CLJS.GN);var c=$CLJS.M.h(b,$CLJS.YN),d=$CLJS.M.h(b,$CLJS.$O),e=$CLJS.M.h(b,$CLJS.fQ);try{if($CLJS.m(d)){var f=$CLJS.Uf(b),g=$CLJS.M.h(f,$CLJS.$O);var l=$CLJS.Bu($CLJS.Jm.h(f,$CLJS.$O),new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.GN,$CLJS.$O],null),g)}else l=b;var n=$CLJS.m(a)?$CLJS.Wm.j(l,$CLJS.GN,m6):l,q=$CLJS.m(c)?$CLJS.Wm.j(n,$CLJS.YN,$CLJS.fg($CLJS.Vm,R5)):n,u=$CLJS.m(e)?$CLJS.Wm.j(q,$CLJS.fQ,l6):q;return R5(u)}catch(v){if(v instanceof Error)throw n=v,$CLJS.Dj($CLJS.aH("Error canonicalizing query: {0}",
$CLJS.J([$CLJS.rZ(n)])),new $CLJS.k(null,1,[$CLJS.GN,a],null),n);throw v;}};
$sa=function(a){a=$CLJS.Uf(a);var b=$CLJS.M.h(a,$CLJS.GN),c=$CLJS.Uf(b);b=$CLJS.M.h(c,$CLJS.SO);c=$CLJS.M.h(c,$CLJS.AH);return $CLJS.A(b)&&$CLJS.A(c)?(b=$CLJS.yi($CLJS.We($CLJS.wg,$CLJS.A($CLJS.Ag($CLJS.Gb,function g(e,f){try{if($CLJS.qe(f)&&3===$CLJS.E(f))try{var l=$CLJS.G(f,0);if($CLJS.O(l,$CLJS.PP)){var n=$CLJS.G(f,1),q=$CLJS.G(f,2);return new $CLJS.R(null,1,5,$CLJS.S,[new $CLJS.R(null,2,5,$CLJS.S,[f,new $CLJS.R(null,3,5,$CLJS.S,[$CLJS.PP,n,$CLJS.Jm.h(q,$CLJS.bQ)],null)],null)],null)}throw $CLJS.Z;
}catch(u){if(u instanceof Error){l=u;if(l===$CLJS.Z)throw $CLJS.Z;throw l;}throw u;}else throw $CLJS.Z;}catch(u){if(u instanceof Error){l=u;if(l===$CLJS.Z)return $CLJS.WY(g,e,f);throw l;}throw u;}}($CLJS.Rg,b))))),$CLJS.RZ.j(a,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.GN,$CLJS.AH],null),$CLJS.Rm.h($CLJS.Sg,$CLJS.fg($CLJS.Um,b)))):a};
ata=function(a){try{return $sa(a)}catch(c){if(c instanceof Error){var b=c;throw $CLJS.Dj($CLJS.bH("Error performing whole query transformations"),new $CLJS.k(null,1,[$CLJS.GN,a],null),b);}throw c;}};
bta=function(a,b){var c=$CLJS.th.h($CLJS.ae(a),function(){return function f(e){return new $CLJS.Af(null,function(){for(var g=e;;)if(g=$CLJS.A(g)){if($CLJS.re(g)){var l=$CLJS.$c(g),n=$CLJS.E(l),q=$CLJS.Df(n);return function(){for(var z=0;;)if(z<n){var B=$CLJS.be(l,z),H=$CLJS.K(B,0,null);B=$CLJS.K(B,1,null);var I=$CLJS.mf.h(b,H);B=o6.h?o6.h(B,I):o6.call(null,B,I);null!=B&&q.add(new $CLJS.R(null,2,5,$CLJS.S,[H,B],null));z+=1}else return!0}()?$CLJS.If($CLJS.Kf(q),f($CLJS.ad(g))):$CLJS.If($CLJS.Kf(q),
null)}var u=$CLJS.C(g),v=$CLJS.K(u,0,null),x=$CLJS.K(u,1,null);u=function(){var z=x,B=$CLJS.mf.h(b,v);return o6.h?o6.h(z,B):o6.call(null,z,B)}();if(null!=u)return $CLJS.pf(new $CLJS.R(null,2,5,$CLJS.S,[v,u],null),f($CLJS.zd(g)));g=$CLJS.zd(g)}else return null},null,null)}(a)}());return $CLJS.A(c)?c:null};cta=function(a,b){a=$CLJS.Vm.h(function(c){var d=$CLJS.mf.h(b,p6);return o6.h?o6.h(c,d):o6.call(null,c,d)},a);return $CLJS.m($CLJS.ag($CLJS.Gb,a))?a:null};
U5=function U5(a,b){var d=a.exec(b);if(null==d)return null;var e=d[0],f=1===d.length?e:$CLJS.Sg(d);return $CLJS.pf(f,new $CLJS.Af(null,function(){var g=e.length;g=d.index+(1>g?1:g);return g<=b.length?(g=b.substring(g),U5.h?U5.h(a,g):U5.call(null,a,g)):null},null,null))};i6=function i6(a,b){return $CLJS.vZ($CLJS.fg(i6,a),$CLJS.Ze,a.g?a.g(b):a.call(null,b))};dta=new $CLJS.N(null,"value_field","value_field",-980977878);q6=new $CLJS.N(null,"ascending","ascending",-988350486);
r6=new $CLJS.N(null,"named","named",-422393479);s6=new $CLJS.N(null,"values_source_config","values_source_config",-590570309);eta=new $CLJS.N(null,"field-id","field-id",-353751335);t6=new $CLJS.N(null,"descending","descending",-24766135);u6=new $CLJS.N(null,"binning-strategy","binning-strategy",2063329158);v6=new $CLJS.N(null,"datetime-field","datetime-field",21731696);fta=new $CLJS.N(null,"use-as-display-name?","use-as-display-name?",686752941);
w6=new $CLJS.N(null,"field-literal","field-literal",-1295883554);x6=new $CLJS.N(null,"viz-settings","viz-settings",256055379);gta=new $CLJS.N(null,"rows","rows",850049680);hta=new $CLJS.N(null,"special-fn","special-fn",1290649344);p6=new $CLJS.N("metabase.mbql.normalize","sequence","metabase.mbql.normalize/sequence",-1700645683);Z5=new $CLJS.N(null,"ignore-path","ignore-path",944069061);ita=new $CLJS.N(null,"label_field","label_field",-1573182765);jta=new $CLJS.N(null,"fk-\x3e","fk-\x3e",-499026738);
kta=new $CLJS.N(null,"joined-field","joined-field",-2048778268);Usa=new $CLJS.N(null,"visibility_type","visibility_type",-508434247);var y6,lta=$CLJS.ij.g($CLJS.P),mta=$CLJS.ij.g($CLJS.P),nta=$CLJS.ij.g($CLJS.P),ota=$CLJS.ij.g($CLJS.P),pta=$CLJS.M.j($CLJS.P,$CLJS.Vk,$CLJS.rj.A?$CLJS.rj.A():$CLJS.rj.call(null));y6=new $CLJS.Aj($CLJS.$i.h("metabase.mbql.normalize","normalize-mbql-clause-tokens"),$CLJS.Rm.h(S5,$CLJS.C),$CLJS.Uj,pta,lta,mta,nta,ota);y6.o(null,$CLJS.ZO,function(a){$CLJS.K(a,0,null);var b=$CLJS.K(a,1,null);a=$CLJS.K(a,2,null);b=new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.ZO,b],null);return null!=a?$CLJS.mf.h(b,a):b});
y6.o(null,$CLJS.IF,function(a){$CLJS.K(a,0,null);a=$CLJS.K(a,1,null);return new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.IF,a instanceof $CLJS.N?$CLJS.GZ(a):a],null)});y6.o(null,u6,function(a){$CLJS.K(a,0,null);var b=$CLJS.K(a,1,null),c=$CLJS.K(a,2,null);a=$CLJS.K(a,3,null);return $CLJS.m(a)?$CLJS.mf.h(y6.g(new $CLJS.R(null,3,5,$CLJS.S,[u6,b,c],null)),a):new $CLJS.R(null,3,5,$CLJS.S,[u6,Y5.h?Y5.h(b,Z5):Y5.call(null,b,Z5),S5(c)],null)});
y6.o(null,$CLJS.PP,function(a){$CLJS.K(a,0,null);var b=$CLJS.K(a,1,null);a=$CLJS.K(a,2,null);var c=Y5.h?Y5.h(a,Z5):Y5.call(null,a,Z5);return new $CLJS.R(null,3,5,$CLJS.S,[$CLJS.PP,b,function(){var d=$CLJS.m($CLJS.LF.g(c))?$CLJS.Wm.j(c,$CLJS.LF,$CLJS.Ui):c;d=$CLJS.m($CLJS.bQ.g(c))?$CLJS.Wm.j(d,$CLJS.bQ,$CLJS.Ui):d;return $CLJS.m($CLJS.bR.g(c))?$CLJS.Wm.j(d,$CLJS.bR,function(e){return $CLJS.m($CLJS.dK.g(e))?$CLJS.Wm.j(e,$CLJS.dK,$CLJS.Ui):e}):d}()],null)});
y6.o(null,w6,function(a){$CLJS.K(a,0,null);var b=$CLJS.K(a,1,null);a=$CLJS.K(a,2,null);return new $CLJS.R(null,3,5,$CLJS.S,[w6,b instanceof $CLJS.N?$CLJS.GZ(b):b,$CLJS.Ui.g(a)],null)});y6.o(null,v6,function(a){$CLJS.K(a,0,null);var b=$CLJS.K(a,1,null),c=$CLJS.K(a,2,null);a=$CLJS.K(a,3,null);return $CLJS.m(a)?new $CLJS.R(null,4,5,$CLJS.S,[v6,Y5.h?Y5.h(b,Z5):Y5.call(null,b,Z5),$CLJS.gu,S5(a)],null):new $CLJS.R(null,3,5,$CLJS.S,[v6,Y5.h?Y5.h(b,Z5):Y5.call(null,b,Z5),S5(c)],null)});
y6.o(null,$CLJS.wJ,function(a){$CLJS.K(a,0,null);var b=$CLJS.K(a,1,null),c=$CLJS.K(a,2,null),d=$CLJS.K(a,3,null);a=$CLJS.K(a,4,null);return $CLJS.m(a)?$CLJS.mf.h(y6.g(new $CLJS.R(null,4,5,$CLJS.S,[$CLJS.wJ,b,c,d],null)),Y5.h?Y5.h(a,Z5):Y5.call(null,a,Z5)):new $CLJS.R(null,4,5,$CLJS.S,[$CLJS.wJ,Y5.h?Y5.h(b,Z5):Y5.call(null,b,Z5),$CLJS.Ae(c)?c:S5(c),S5(d)],null)});
y6.o(null,$CLJS.wI,function(a){$CLJS.K(a,0,null);var b=$CLJS.K(a,1,null);a=$CLJS.K(a,2,null);return $CLJS.m(a)?new $CLJS.R(null,3,5,$CLJS.S,[$CLJS.wI,b,S5(a)],null):new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.wI,$CLJS.eB],null)});y6.o(null,$CLJS.mI,function(a){$CLJS.K(a,0,null);var b=$CLJS.K(a,1,null);a=$CLJS.K(a,2,null);return new $CLJS.R(null,3,5,$CLJS.S,[$CLJS.mI,b,S5(a)],null)});
y6.o(null,$CLJS.jJ,function(a){$CLJS.K(a,0,null);var b=$CLJS.K(a,1,null),c=$CLJS.K(a,2,null);a=$CLJS.K(a,3,null);return new $CLJS.R(null,4,5,$CLJS.S,[$CLJS.jJ,Y5.h?Y5.h(b,Z5):Y5.call(null,b,Z5),c,S5(a)],null)});y6.o(null,$CLJS.RJ,function(a){$CLJS.K(a,0,null);var b=$CLJS.K(a,1,null),c=$CLJS.K(a,2,null);a=$CLJS.K(a,3,null);return new $CLJS.R(null,4,5,$CLJS.S,[$CLJS.RJ,Y5.h?Y5.h(b,Z5):Y5.call(null,b,Z5),c,S5(a)],null)});
y6.o(null,$CLJS.iJ,function(a){$CLJS.K(a,0,null);var b=$CLJS.K(a,1,null);a=$CLJS.K(a,2,null);return $CLJS.m(a)?new $CLJS.R(null,3,5,$CLJS.S,[$CLJS.iJ,Y5.h?Y5.h(b,Z5):Y5.call(null,b,Z5),S5(a)],null):new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.iJ,Y5.h?Y5.h(b,Z5):Y5.call(null,b,Z5)],null)});
y6.o(null,$CLJS.uJ,function(a){$CLJS.K(a,0,null);var b=$CLJS.K(a,1,null),c=$CLJS.K(a,2,null);a=$CLJS.K(a,3,null);return $CLJS.m(a)?new $CLJS.R(null,4,5,$CLJS.S,[$CLJS.uJ,Y5.h?Y5.h(b,Z5):Y5.call(null,b,Z5),S5(c),S5(a)],null):new $CLJS.R(null,3,5,$CLJS.S,[$CLJS.uJ,Y5.h?Y5.h(b,Z5):Y5.call(null,b,Z5),S5(c)],null)});
y6.o(null,$CLJS.lI,function(a){$CLJS.K(a,0,null);var b=$CLJS.K(a,1,null),c=$CLJS.K(a,2,null);a=$CLJS.K(a,3,null);return new $CLJS.R(null,4,5,$CLJS.S,[$CLJS.lI,Y5.h?Y5.h(b,Z5):Y5.call(null,b,Z5),Y5.h?Y5.h(c,Z5):Y5.call(null,c,Z5),S5(a)],null)});y6.o(null,$CLJS.vl,function(a){$CLJS.K(a,0,null);var b=$CLJS.K(a,1,null);a=$CLJS.K(a,2,null);return new $CLJS.R(null,3,5,$CLJS.S,[$CLJS.vl,b,a],null)});
y6.o(null,$CLJS.Uj,function(a){var b=$CLJS.A(a);a=$CLJS.C(b);b=$CLJS.D(b);return $CLJS.th.j(new $CLJS.R(null,1,5,$CLJS.S,[S5(a)],null),$CLJS.xg.g(function(c){return Y5.h?Y5.h(c,Z5):Y5.call(null,c,Z5)}),b)});
var z6=function z6(a){if($CLJS.m($CLJS.Tm.h($CLJS.rf,$CLJS.Jb)(a))){var c=S5(a);var d=new $CLJS.ti(null,new $CLJS.k(null,18,[$CLJS.vk,null,$CLJS.sm,null,$CLJS.GJ,null,$CLJS.kJ,null,$CLJS.hu,null,$CLJS.SI,null,$CLJS.VJ,null,$CLJS.XJ,null,$CLJS.SH,null,$CLJS.rI,null,$CLJS.rm,null,$CLJS.VH,null,$CLJS.BJ,null,$CLJS.dJ,null,$CLJS.cm,null,$CLJS.cD,null,$CLJS.HI,null,$CLJS.zJ,null],null),null);c=d.g?d.g(c):d.call(null,c)}else c=null;return $CLJS.m(c)?c:$CLJS.m(W5(a))?(a=$CLJS.C(a),z6.g?z6.g(a):z6.call(null,
a)):null},qta=new $CLJS.k(null,8,[$CLJS.al,S5,$CLJS.fQ,function(a){a=T5(a);return $CLJS.A($CLJS.uQ.g(a))?$CLJS.Wm.j(a,$CLJS.uQ,Tsa):a},$CLJS.GN,new $CLJS.k(null,6,[$CLJS.ZO,function A6(a){if($CLJS.m($CLJS.Tm.h($CLJS.rf,$CLJS.Jb)(a)))return S5(a);if($CLJS.m(X5(r6,a))){a=$CLJS.A(a);$CLJS.C(a);var c=$CLJS.D(a);a=$CLJS.C(c);c=$CLJS.D(c);return $CLJS.th.h(new $CLJS.R(null,2,5,$CLJS.S,[r6,A6.g?A6.g(a):A6.call(null,a)],null),c)}return $CLJS.m($CLJS.m(W5(a))?z6($CLJS.Zd(a)):null)?$CLJS.Vm.h(A6,a):Y5.h?Y5.h(a,
Z5):Y5.call(null,a,Z5)},$CLJS.aQ,function(a){return $CLJS.th.h($CLJS.P,function(){return function d(c){return new $CLJS.Af(null,function(){for(;;){var e=$CLJS.A(c);if(e){if($CLJS.re(e)){var f=$CLJS.$c(e),g=$CLJS.E(f),l=$CLJS.Df(g);a:for(var n=0;;)if(n<g){var q=$CLJS.be(f,n),u=$CLJS.K(q,0,null);q=$CLJS.K(q,1,null);u=new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.GZ(u),Y5.h?Y5.h(q,Z5):Y5.call(null,q,Z5)],null);l.add(u);n+=1}else{f=!0;break a}return f?$CLJS.If($CLJS.Kf(l),d($CLJS.ad(e))):$CLJS.If($CLJS.Kf(l),null)}f=
$CLJS.C(e);l=$CLJS.K(f,0,null);f=$CLJS.K(f,1,null);return $CLJS.pf(new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.GZ(l),Y5.h?Y5.h(f,Z5):Y5.call(null,f,Z5)],null),d($CLJS.zd(e)))}return null}},null,null)}(a)}())},$CLJS.kR,function(a){return $CLJS.Sg(function(){return function d(c){return new $CLJS.Af(null,function(){for(;;){var e=$CLJS.A(c);if(e){if($CLJS.re(e)){var f=$CLJS.$c(e),g=$CLJS.E(f),l=$CLJS.Df(g);a:for(var n=0;;)if(n<g){var q=$CLJS.be(f,n);q=$CLJS.m(W5(q))?y6.g(q):$CLJS.nf(y6.g($CLJS.nf(q)));l.add(q);
n+=1}else{f=!0;break a}return f?$CLJS.If($CLJS.Kf(l),d($CLJS.ad(e))):$CLJS.If($CLJS.Kf(l),null)}l=$CLJS.C(e);return $CLJS.pf($CLJS.m(W5(l))?y6.g(l):$CLJS.nf(y6.g($CLJS.nf(l))),d($CLJS.zd(e)))}return null}},null,null)}(a)}())},$CLJS.xQ,function(a){a=T5(a);a=$CLJS.Uf(a);var b=$CLJS.M.h(a,$CLJS.fQ);if($CLJS.m(b))return a=$CLJS.ZM(a,new $CLJS.k(null,1,[$CLJS.fQ,$CLJS.GN],null)),b=new $CLJS.R(null,1,5,$CLJS.S,[$CLJS.fQ],null),a=Y5.h?Y5.h(a,b):Y5.call(null,a,b),$CLJS.ZM(a,new $CLJS.k(null,1,[$CLJS.GN,$CLJS.fQ],
null));b=new $CLJS.R(null,1,5,$CLJS.S,[$CLJS.GN],null);return Y5.h?Y5.h(a,b):Y5.call(null,a,b)},$CLJS.$O,new $CLJS.k(null,1,[p6,$5],null),$CLJS.fO,new $CLJS.k(null,1,[p6,function(a){a=Y5.h?Y5.h(a,$CLJS.GN):Y5.call(null,a,$CLJS.GN);var b=$CLJS.Uf(a),c=$CLJS.M.h(b,$CLJS.dK),d=$CLJS.M.h(b,$CLJS.AH);a=$CLJS.M.h(b,$CLJS.qI);b=$CLJS.m(c)?$CLJS.Wm.j(b,$CLJS.dK,S5):b;d=$CLJS.m($CLJS.Tm.h($CLJS.rf,$CLJS.Jb)(d))?$CLJS.Wm.j(b,$CLJS.AH,S5):b;return $CLJS.m(a)?$CLJS.Wm.j(d,$CLJS.qI,$CLJS.GZ):d}],null)],null),
$CLJS.RD,new $CLJS.k(null,1,[$CLJS.BO,$CLJS.Ze],null),$CLJS.YN,new $CLJS.k(null,1,[p6,function(a){var b=$CLJS.Uf(a),c=$CLJS.M.h(b,$CLJS.al),d=$CLJS.M.h(b,$CLJS.hK),e=$CLJS.M.h(b,$CLJS.Lk);a=$CLJS.M.h(b,s6);b=$CLJS.m(e)?$CLJS.Wm.j(b,$CLJS.Lk,$CLJS.GZ):b;c=$CLJS.m(c)?$CLJS.Wm.j(b,$CLJS.al,S5):b;d=$CLJS.m(d)?$CLJS.Wm.j(c,$CLJS.hK,function(f){return Y5.h?Y5.h(f,Z5):Y5.call(null,f,Z5)}):c;d=$CLJS.m(a)?$CLJS.RZ.j(d,new $CLJS.R(null,2,5,$CLJS.S,[s6,ita],null),function(f){return Y5.h?Y5.h(f,Z5):Y5.call(null,
f,Z5)}):d;return $CLJS.m(a)?$CLJS.RZ.j(d,new $CLJS.R(null,2,5,$CLJS.S,[s6,dta],null),function(f){return Y5.h?Y5.h(f,Z5):Y5.call(null,f,Z5)}):d}],null),$CLJS.WN,function(a){return null==a?null:S5(a)},$CLJS.$O,new $CLJS.k(null,1,[p6,$5],null),x6,S5],null),Y5=function Y5(a){for(var c=[],d=arguments.length,e=0;;)if(e<d)c.push(arguments[e]),e+=1;else break;return Y5.l(arguments[0],1<c.length?new $CLJS.y(c.slice(1),0,null):null)};
Y5.l=function(a,b){b=$CLJS.K(b,0,null);var c=b instanceof $CLJS.N?new $CLJS.R(null,1,5,$CLJS.S,[b],null):$CLJS.Sg(b);b=$CLJS.A(c)?$CLJS.vu(qta,c):null;try{return $CLJS.de(b)?b.g?b.g(a):b.call(null,a):$CLJS.pe(a)?a:$CLJS.oe(a)?$CLJS.th.h($CLJS.P,function(){return function g(f){return new $CLJS.Af(null,function(){for(;;){var l=$CLJS.A(f);if(l){if($CLJS.re(l)){var n=$CLJS.$c(l),q=$CLJS.E(n),u=$CLJS.Df(q);a:for(var v=0;;)if(v<q){var x=$CLJS.be(n,v),z=$CLJS.K(x,0,null);x=$CLJS.K(x,1,null);z=S5(z);z=new $CLJS.R(null,
2,5,$CLJS.S,[z,Y5.l(x,$CLJS.J([$CLJS.mf.h($CLJS.Sg(c),z)]))],null);u.add(z);v+=1}else{n=!0;break a}return n?$CLJS.If($CLJS.Kf(u),g($CLJS.ad(l))):$CLJS.If($CLJS.Kf(u),null)}n=$CLJS.C(l);u=$CLJS.K(n,0,null);n=$CLJS.K(n,1,null);u=S5(u);return $CLJS.pf(new $CLJS.R(null,2,5,$CLJS.S,[u,Y5.l(n,$CLJS.J([$CLJS.mf.h($CLJS.Sg(c),u)]))],null),g($CLJS.zd(l)))}return null}},null,null)}(a)}()):$CLJS.m(W5(a))?y6.g(a):$CLJS.ne(a)?$CLJS.Vm.h(function(e){return Y5.l(e,$CLJS.J([$CLJS.mf.h($CLJS.Sg(c),p6)]))},a):a}catch(e){if(e instanceof
Error){var d=e;throw $CLJS.Dj($CLJS.aH("Error normalizing form: {0}",$CLJS.J([$CLJS.rZ(d)])),new $CLJS.k(null,3,[$CLJS.Gu,a,$CLJS.em,c,hta,b],null),d);}throw e;}};Y5.v=1;Y5.B=function(a){var b=$CLJS.C(a);a=$CLJS.D(a);return this.l(b,a)};
var b6=function(){var a=$CLJS.ij.g($CLJS.P),b=$CLJS.ij.g($CLJS.P),c=$CLJS.ij.g($CLJS.P),d=$CLJS.ij.g($CLJS.P),e=$CLJS.M.j($CLJS.P,$CLJS.Vk,$CLJS.rj.A?$CLJS.rj.A():$CLJS.rj.call(null));return new $CLJS.Aj($CLJS.$i.h("metabase.mbql.normalize","canonicalize-mbql-clause"),function(f){return $CLJS.m(W5(f))?$CLJS.C(f):null},$CLJS.Uj,e,a,b,c,d)}();b6.o(null,$CLJS.Uj,function(a){return a});
b6.o(null,$CLJS.PP,function(a){$CLJS.K(a,0,null);var b=$CLJS.K(a,1,null);a=$CLJS.K(a,2,null);if($CLJS.m(X5($CLJS.PP,b))){$CLJS.K(b,0,null);var c=$CLJS.K(b,1,null);b=$CLJS.K(b,2,null);return b6.g(new $CLJS.R(null,3,5,$CLJS.S,[$CLJS.PP,c,$CLJS.Vf($CLJS.mn.l($CLJS.J([b,a])))],null))}return new $CLJS.R(null,3,5,$CLJS.S,[$CLJS.PP,b,$CLJS.Vf(a)],null)});
b6.o(null,$CLJS.ZO,function(a){$CLJS.K(a,0,null);var b=$CLJS.K(a,1,null);a=$CLJS.K(a,2,null);return $CLJS.je(a)?new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.ZO,b],null):new $CLJS.R(null,3,5,$CLJS.S,[$CLJS.ZO,b,a],null)});b6.o(null,eta,function(a){$CLJS.K(a,0,null);a=$CLJS.K(a,1,null);return $CLJS.m(W5(a))?b6.g(a):new $CLJS.R(null,3,5,$CLJS.S,[$CLJS.PP,a,null],null)});
b6.o(null,w6,function(a){$CLJS.K(a,0,null);var b=$CLJS.K(a,1,null);a=$CLJS.K(a,2,null);return new $CLJS.R(null,3,5,$CLJS.S,[$CLJS.PP,b,new $CLJS.k(null,1,[$CLJS.LF,a],null)],null)});b6.o(null,jta,function(a){$CLJS.K(a,0,null);var b=$CLJS.K(a,1,null);a=$CLJS.K(a,2,null);var c=c6(b);$CLJS.K(c,0,null);b=$CLJS.K(c,1,null);$CLJS.K(c,2,null);c=c6(a);$CLJS.K(c,0,null);a=$CLJS.K(c,1,null);c=$CLJS.K(c,2,null);return new $CLJS.R(null,3,5,$CLJS.S,[$CLJS.PP,a,$CLJS.U.j(c,$CLJS.gO,b)],null)});
b6.o(null,kta,function(a){$CLJS.K(a,0,null);var b=$CLJS.K(a,1,null);a=$CLJS.K(a,2,null);a=c6(a);return $CLJS.Q.C($CLJS.VZ,a,$CLJS.U,$CLJS.J([$CLJS.yP,b]))});
b6.o(null,v6,function(a){var b=$CLJS.E(a);switch(b){case 3:$CLJS.K(a,0,null);b=$CLJS.K(a,1,null);var c=$CLJS.K(a,2,null);a=c6(b);b=c;$CLJS.K(a,0,null);$CLJS.K(a,1,null);c=$CLJS.K(a,2,null);c=$CLJS.Uf(c);c=$CLJS.M.h(c,$CLJS.LF);return $CLJS.Fb(c)||$CLJS.TR.h(c,b)?$CLJS.Q.C($CLJS.VZ,a,$CLJS.U,$CLJS.J([$CLJS.bQ,b])):a;case 4:return $CLJS.K(a,0,null),b=$CLJS.K(a,1,null),$CLJS.K(a,2,null),c=$CLJS.K(a,3,null),b6.g(new $CLJS.R(null,3,5,$CLJS.S,[v6,b,c],null));default:throw Error(["No matching clause: ",
$CLJS.p.g(b)].join(""));}});b6.o(null,u6,function(a){$CLJS.K(a,0,null);var b=$CLJS.K(a,1,null),c=$CLJS.K(a,2,null),d=$CLJS.K(a,3,null);a=$CLJS.K(a,4,null);var e=c6(b);$CLJS.K(e,0,null);b=$CLJS.K(e,1,null);e=$CLJS.K(e,2,null);return new $CLJS.R(null,3,5,$CLJS.S,[$CLJS.PP,b,$CLJS.U.j(e,$CLJS.bR,$CLJS.mn.l($CLJS.J([new $CLJS.k(null,1,[$CLJS.dK,c],null),$CLJS.m(d)?$CLJS.Tf([c,d]):null,a])))],null)});
for(var B6=$CLJS.A(new $CLJS.R(null,3,5,$CLJS.S,[$CLJS.Qj,$CLJS.Gk,$CLJS.Yk],null)),C6=null,D6=0,E6=0;;)if(E6<D6){var F6=C6.aa(null,E6);b6.o(null,F6,function(){return function(a){return d6(a)}}(B6,C6,D6,E6,F6));E6+=1}else{var G6=$CLJS.A(B6);if(G6){var H6=G6;if($CLJS.re(H6)){var I6=$CLJS.$c(H6),rta=$CLJS.ad(H6),sta=I6,tta=$CLJS.E(I6);B6=rta;C6=sta;D6=tta}else{var J6=$CLJS.C(H6);b6.o(null,J6,function(){return function(a){return d6(a)}}(B6,C6,D6,E6,J6,H6,G6));B6=$CLJS.D(H6);C6=null;D6=0}E6=0}else break}
b6.o(null,$CLJS.ZH,function(a){a=$CLJS.A(a);$CLJS.C(a);var b=$CLJS.D(a);a=$CLJS.C(b);var c=$CLJS.D(b);b=$CLJS.C(c);c=$CLJS.D(c);return $CLJS.th.h(new $CLJS.R(null,3,5,$CLJS.S,[$CLJS.ZH,c6(a),c6(b)],null),c)});b6.o(null,$CLJS.wJ,function(a){a=$CLJS.A(a);$CLJS.C(a);var b=$CLJS.D(a);a=$CLJS.C(b);b=$CLJS.D(b);var c=c6(a);a=$CLJS.m($CLJS.HZ($CLJS.PP,a))?$CLJS.VZ.l(c,$CLJS.Jm,$CLJS.J([$CLJS.bQ])):c;return $CLJS.th.h(new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.wJ,a],null),b)});
for(var K6=$CLJS.A(new $CLJS.R(null,15,5,$CLJS.S,[$CLJS.zI,$CLJS.sJ,$CLJS.QI,$CLJS.AI,$CLJS.lm,$CLJS.JJ,$CLJS.mm,$CLJS.zm,$CLJS.pm,$CLJS.ym,$CLJS.QH,$CLJS.eI,$CLJS.DH,$CLJS.sI,$CLJS.PH],null)),L6=null,M6=0,N6=0;;)if(N6<M6){var O6=L6.aa(null,N6);b6.o(null,O6,function(){return function(a){return e6(a)}}(K6,L6,M6,N6,O6));N6+=1}else{var P6=$CLJS.A(K6);if(P6){var Q6=P6;if($CLJS.re(Q6)){var R6=$CLJS.$c(Q6),uta=$CLJS.ad(Q6),vta=R6,wta=$CLJS.E(R6);K6=uta;L6=vta;M6=wta}else{var S6=$CLJS.C(Q6);b6.o(null,S6,
function(){return function(a){return e6(a)}}(K6,L6,M6,N6,S6,Q6,P6));K6=$CLJS.D(Q6);L6=null;M6=0}N6=0}else break}b6.o(null,gta,function(){return null});b6.o(null,$CLJS.yN,function(a){$CLJS.K(a,0,null);var b=$CLJS.K(a,1,null);a=$CLJS.K(a,2,null);return new $CLJS.R(null,3,5,$CLJS.S,[$CLJS.yN,b6.g(b),a],null)});
b6.o(null,r6,function(a){a=$CLJS.A(a);$CLJS.C(a);a=$CLJS.D(a);var b=$CLJS.C(a),c=$CLJS.D(a);a=$CLJS.C(c);var d=$CLJS.D(c);c=b6.g;var e=$CLJS.S;b=b6.g(b);d=$CLJS.K(d,0,null);d=$CLJS.Uf(d);a=!1===$CLJS.M.h(d,fta)?new $CLJS.k(null,1,[$CLJS.V,a],null):new $CLJS.k(null,1,[$CLJS.YH,a],null);return c.call(b6,new $CLJS.R(null,3,5,e,[$CLJS.yN,b,a],null))});
for(var T6=$CLJS.A(new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.cD,$CLJS.SI],null)),U6=null,V6=0,W6=0;;)if(W6<V6){var X6=U6.aa(null,W6);b6.o(null,X6,function(){return function(a){return f6(a)}}(T6,U6,V6,W6,X6));W6+=1}else{var Y6=$CLJS.A(T6);if(Y6){var Z6=Y6;if($CLJS.re(Z6)){var $6=$CLJS.$c(Z6),xta=$CLJS.ad(Z6),yta=$6,zta=$CLJS.E($6);T6=xta;U6=yta;V6=zta}else{var a7=$CLJS.C(Z6);b6.o(null,a7,function(){return function(a){return f6(a)}}(T6,U6,V6,W6,a7,Z6,Y6));T6=$CLJS.D(Z6);U6=null;V6=0}W6=0}else break}
for(var b7=$CLJS.A(new $CLJS.R(null,9,5,$CLJS.S,[$CLJS.HI,$CLJS.YJ,$CLJS.SH,$CLJS.GJ,$CLJS.zJ,$CLJS.vk,$CLJS.cm,$CLJS.BJ,$CLJS.VH],null)),c7=null,d7=0,e7=0;;)if(e7<d7){var f7=c7.aa(null,e7);b6.o(null,f7,function(){return function(a){return g6(a)}}(b7,c7,d7,e7,f7));e7+=1}else{var g7=$CLJS.A(b7);if(g7){var h7=g7;if($CLJS.re(h7)){var i7=$CLJS.$c(h7),Ata=$CLJS.ad(h7),Bta=i7,Cta=$CLJS.E(i7);b7=Ata;c7=Bta;d7=Cta}else{var j7=$CLJS.C(h7);b6.o(null,j7,function(){return function(a){return g6(a)}}(b7,c7,d7,
e7,j7,h7,g7));b7=$CLJS.D(h7);c7=null;d7=0}e7=0}else break}b6.o(null,$CLJS.rI,function(a){$CLJS.K(a,0,null);var b=$CLJS.K(a,1,null);a=$CLJS.K(a,2,null);return new $CLJS.R(null,3,5,$CLJS.S,[$CLJS.rI,c6(b),a],null)});
for(var k7=$CLJS.A(new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.dJ,$CLJS.kJ],null)),l7=null,m7=0,n7=0;;)if(n7<m7){var o7=l7.aa(null,n7);b6.o(null,o7,function(){return function(a){return h6(a)}}(k7,l7,m7,n7,o7));n7+=1}else{var p7=$CLJS.A(k7);if(p7){var q7=p7;if($CLJS.re(q7)){var r7=$CLJS.$c(q7),Dta=$CLJS.ad(q7),Eta=r7,Fta=$CLJS.E(r7);k7=Dta;l7=Eta;m7=Fta}else{var s7=$CLJS.C(q7);b6.o(null,s7,function(){return function(a){return h6(a)}}(k7,l7,m7,n7,s7,q7,p7));k7=$CLJS.D(q7);l7=null;m7=0}n7=0}else break}
b6.o(null,$CLJS.VJ,function(a){$CLJS.K(a,0,null);var b=$CLJS.K(a,1,null);a=$CLJS.K(a,2,null);return new $CLJS.R(null,3,5,$CLJS.S,[$CLJS.VJ,b6.g(b),b6.g(a)],null)});
b6.o(null,$CLJS.dI,function(a){$CLJS.K(a,0,null);var b=$CLJS.K(a,1,null);a=$CLJS.K(a,2,null);return $CLJS.m(a)?$CLJS.mf.h(b6.g(new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.dI,b],null)),Y5.l(a,$CLJS.J([Z5]))):new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.dI,$CLJS.Sg(function(){return function e(d){return new $CLJS.Af(null,function(){for(;;){var f=$CLJS.A(d);if(f){if($CLJS.re(f)){var g=$CLJS.$c(f),l=$CLJS.E(g),n=$CLJS.Df(l);a:for(var q=0;;)if(q<l){var u=$CLJS.be(g,q),v=$CLJS.K(u,0,null);u=$CLJS.K(u,1,null);v=new $CLJS.R(null,
2,5,$CLJS.S,[b6.g(v),b6.g(u)],null);n.add(v);q+=1}else{g=!0;break a}return g?$CLJS.If($CLJS.Kf(n),e($CLJS.ad(f))):$CLJS.If($CLJS.Kf(n),null)}g=$CLJS.C(f);n=$CLJS.K(g,0,null);g=$CLJS.K(g,1,null);return $CLJS.pf(new $CLJS.R(null,2,5,$CLJS.S,[b6.g(n),b6.g(g)],null),e($CLJS.zd(f)))}return null}},null,null)}(b)}())],null)});
b6.o(null,$CLJS.hH,function(a){a=$CLJS.A(a);$CLJS.C(a);var b=$CLJS.D(a);a=$CLJS.C(b);var c=$CLJS.D(b);b=$CLJS.C(c);c=$CLJS.D(c);return $CLJS.th.h(new $CLJS.R(null,3,5,$CLJS.S,[$CLJS.hH,b6.g(a),$CLJS.F.h(0,b)?1:b6.g(b)],null),$CLJS.xg.h(b6,c))});
var j6=function j6(a){return function f(d,e){try{if($CLJS.m(function(){var x=$CLJS.EZ($CLJS.we);return x.g?x.g(e):x.call(null,e)}()))return f(d,$CLJS.Sg(e));throw $CLJS.Z;}catch(x){if(x instanceof Error)if(d=x,d===$CLJS.Z)try{if($CLJS.m(function(){var z=$CLJS.EZ($CLJS.rf);return z.g?z.g(e):z.call(null,e)}()))return new $CLJS.R(null,1,5,$CLJS.S,[new $CLJS.R(null,1,5,$CLJS.S,[e],null)],null);throw $CLJS.Z;}catch(z){if(z instanceof Error)if(d=z,d===$CLJS.Z)try{if($CLJS.qe(e)&&2<=$CLJS.E(e))try{var g=
$CLJS.an.j(e,0,2);if($CLJS.qe(g)&&2===$CLJS.E(g))try{var l=$CLJS.G(g,0);if($CLJS.m($CLJS.Sm.h($CLJS.rf,$CLJS.dg(new $CLJS.ti(null,new $CLJS.k(null,5,[$CLJS.sm,null,$CLJS.hu,null,$CLJS.XJ,null,$CLJS.rm,null,r6,null],null),null)))(l)))try{var n=$CLJS.G(g,1);if($CLJS.m(z6(n)))return $CLJS.Sg($CLJS.We($CLJS.wg,$CLJS.xg.h(j6,a)));throw $CLJS.Z;}catch(B){if(B instanceof Error){var q=B;if(q===$CLJS.Z)throw $CLJS.Z;throw q;}throw B;}else throw $CLJS.Z;}catch(B){if(B instanceof Error){q=B;if(q===$CLJS.Z)throw $CLJS.Z;
throw q;}throw B;}else throw $CLJS.Z;}catch(B){if(B instanceof Error){q=B;if(q===$CLJS.Z)throw $CLJS.Z;throw q;}throw B;}else throw $CLJS.Z;}catch(B){if(B instanceof Error)if(q=B,q===$CLJS.Z)try{if($CLJS.qe(e)&&1<=$CLJS.E(e))try{var u=$CLJS.an.j(e,0,1);if($CLJS.qe(u)&&1===$CLJS.E(u))try{if($CLJS.G(u,0)instanceof $CLJS.N)return new $CLJS.R(null,1,5,$CLJS.S,[e],null);throw $CLJS.Z;}catch(H){if(H instanceof Error){var v=H;if(v===$CLJS.Z)throw $CLJS.Z;throw v;}throw H;}else throw $CLJS.Z;}catch(H){if(H instanceof
Error){v=H;if(v===$CLJS.Z)throw $CLJS.Z;throw v;}throw H;}else throw $CLJS.Z;}catch(H){if(H instanceof Error){v=H;if(v===$CLJS.Z)return e;throw v;}throw H;}else throw q;else throw B;}else throw d;else throw z;}else throw d;else throw x;}}($CLJS.Rg,a)},t7=function t7(a){return function f(d,e){try{var g=$CLJS.EZ($CLJS.we);var l=g.g?g.g(e):g.call(null,e);if($CLJS.m(l))return f(d,$CLJS.Sg(e));throw $CLJS.Z;}catch(B){if(B instanceof Error)if(l=B,l===$CLJS.Z)try{if($CLJS.qe(e)&&2===$CLJS.E(e))try{var n=
$CLJS.G(e,1);if($CLJS.O(n,$CLJS.KI)){var q=$CLJS.G(e,0);return f(d,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.KI,q],null))}throw $CLJS.Z;}catch(H){if(H instanceof Error)if(l=H,l===$CLJS.Z)try{n=$CLJS.G(e,1);if($CLJS.O(n,$CLJS.xI))return q=$CLJS.G(e,0),f(d,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.xI,q],null));throw $CLJS.Z;}catch(I){if(I instanceof Error){var u=I;if(u===$CLJS.Z)try{n=$CLJS.G(e,1);if($CLJS.O(n,q6))return q=$CLJS.G(e,0),f(d,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.KI,q],null));throw $CLJS.Z;}catch(T){if(T instanceof
Error)if(l=T,l===$CLJS.Z)try{n=$CLJS.G(e,1);if($CLJS.O(n,t6))return q=$CLJS.G(e,0),f(d,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.xI,q],null));throw $CLJS.Z;}catch(W){if(W instanceof Error)if(n=W,n===$CLJS.Z)try{var v=$CLJS.G(e,0);if($CLJS.O(v,q6))return q=$CLJS.G(e,1),f(d,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.KI,q],null));throw $CLJS.Z;}catch(ba){if(ba instanceof Error)if(n=ba,n===$CLJS.Z)try{v=$CLJS.G(e,0);if($CLJS.O(v,t6))return q=$CLJS.G(e,1),f(d,new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.xI,q],null));throw $CLJS.Z;
}catch(ha){if(ha instanceof Error)if(n=ha,n===$CLJS.Z)try{v=$CLJS.G(e,0);if($CLJS.O(v,$CLJS.KI))return q=$CLJS.G(e,1),new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.KI,c6(q)],null);throw $CLJS.Z;}catch(pa){if(pa instanceof Error)if(n=pa,n===$CLJS.Z)try{v=$CLJS.G(e,0);if($CLJS.O(v,$CLJS.xI))return q=$CLJS.G(e,1),new $CLJS.R(null,2,5,$CLJS.S,[$CLJS.xI,c6(q)],null);throw $CLJS.Z;}catch(Ga){if(Ga instanceof Error){q=Ga;if(q===$CLJS.Z)throw $CLJS.Z;throw q;}throw Ga;}else throw n;else throw pa;}else throw n;else throw ha;
}else throw n;else throw ba;}else throw n;else throw W;}else throw l;else throw T;}else throw u;}else throw I;}else throw l;else throw H;}else throw $CLJS.Z;}catch(H){if(H instanceof Error)if(l=H,l===$CLJS.Z)try{if($CLJS.qe(e)&&0<=$CLJS.E(e))try{var x=$CLJS.an.j(e,0,0);if($CLJS.qe(x)&&0===$CLJS.E(x))try{var z=$CLJS.an.h(e,0);if($CLJS.F.h(z,a))return $CLJS.Sg($CLJS.on.g($CLJS.xg.h(t7,a)));throw $CLJS.Z;}catch(I){if(I instanceof Error){u=I;if(u===$CLJS.Z)throw $CLJS.Z;throw u;}throw I;}else throw $CLJS.Z;
}catch(I){if(I instanceof Error){u=I;if(u===$CLJS.Z)throw $CLJS.Z;throw u;}throw I;}else throw $CLJS.Z;}catch(I){if(I instanceof Error){u=I;if(u===$CLJS.Z)return $CLJS.FZ(f,d,e);throw u;}throw I;}else throw l;else throw H;}else throw l;else throw B;}}($CLJS.Rg,a)},m6=$CLJS.Rm.h(R5,function(a){var b=n6($CLJS.ZO.g(a))?$CLJS.Wm.j(a,$CLJS.ZO,Vsa):a;b=n6($CLJS.SO.g(a))?$CLJS.Wm.j(b,$CLJS.SO,Wsa):b;b=n6($CLJS.AH.g(a))?$CLJS.Wm.j(b,$CLJS.AH,$CLJS.fg($CLJS.Vm,a6)):b;b=n6($CLJS.kR.g(a))?$CLJS.Wm.j(b,$CLJS.kR,
t7):b;return n6($CLJS.xQ.g(a))?$CLJS.Wm.j(b,$CLJS.xQ,Ysa):b}),Gta=new $CLJS.k(null,3,[$CLJS.fQ,$CLJS.Ze,$CLJS.GN,new $CLJS.k(null,2,[$CLJS.xQ,function(a){a=$CLJS.Uf(a);var b=$CLJS.M.h(a,$CLJS.fQ);if($CLJS.m(b))return a=$CLJS.ZM(a,new $CLJS.k(null,1,[$CLJS.fQ,$CLJS.GN],null)),b=new $CLJS.R(null,1,5,$CLJS.S,[$CLJS.fQ],null),a=o6.h?o6.h(a,b):o6.call(null,a,b),$CLJS.ZM(a,new $CLJS.k(null,1,[$CLJS.GN,$CLJS.fQ],null));b=new $CLJS.R(null,1,5,$CLJS.S,[$CLJS.GN],null);return o6.h?o6.h(a,b):o6.call(null,a,
b)},$CLJS.fO,new $CLJS.k(null,1,[p6,function(a){var b=new $CLJS.R(null,1,5,$CLJS.S,[$CLJS.GN],null);return o6.h?o6.h(a,b):o6.call(null,a,b)}],null)],null),x6,$CLJS.Ze],null),o6=function o6(a){switch(arguments.length){case 1:return o6.g(arguments[0]);case 2:return o6.h(arguments[0],arguments[1]);default:throw Error(["Invalid arity: ",$CLJS.p.g(arguments.length)].join(""));}};o6.g=function(a){return o6.h(a,$CLJS.Rg)};
o6.h=function(a,b){try{var c=$CLJS.A(b)?$CLJS.vu(Gta,b):null;return $CLJS.de(c)?c.g?c.g(a):c.call(null,a):$CLJS.pe(a)?a:$CLJS.oe(a)?bta(a,b):$CLJS.ne(a)?cta(a,b):a}catch(d){if(d instanceof Error)throw $CLJS.Dj("Error removing empty clauses from form.",new $CLJS.k(null,2,[$CLJS.Gu,a,$CLJS.em,b],null),d);throw d;}};o6.v=2;
$CLJS.u7=function(){var a=$CLJS.Rm.l(o6,ata,Zsa,$CLJS.J([Y5]));return function(b){try{return a(b)}catch(d){if(d instanceof Error){var c=d;throw $CLJS.Dj($CLJS.aH("Error normalizing query: {0}",$CLJS.J([$CLJS.rZ(c)])),new $CLJS.k(null,1,[$CLJS.GN,b],null),c);}throw d;}}}();