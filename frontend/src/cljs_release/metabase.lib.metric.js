var window=global;var $CLJS=require("./cljs_env.js");require("./cljs.core.js");require("./metabase.lib.convert.js");require("./metabase.lib.metadata.js");require("./metabase.lib.metadata.calculation.js");require("./metabase.lib.metadata.protocols.js");require("./metabase.lib.ref.js");require("./metabase.lib.schema.js");require("./metabase.lib.schema.expression.js");require("./metabase.lib.schema.id.js");require("./metabase.lib.util.js");require("./metabase.mbql.normalize.js");require("./metabase.shared.util.i18n.js");require("./metabase.util.malli.js");
'use strict';var v7=function(a,b){if(null!=a&&null!=a.Yg)a=a.Yg(a,b);else{var c=v7[$CLJS.Na(null==a?null:a)];if(null!=c)a=c.h?c.h(a,b):c.call(null,a,b);else if(c=v7._,null!=c)a=c.h?c.h(a,b):c.call(null,a,b);else throw $CLJS.Ob("MetadataProvider.metric",a);}return a},w7=function(a,b){return v7($CLJS.v0(a),b)},x7=function(a){a=$CLJS.Uf(a);var b=$CLJS.M.h(a,$CLJS.kpa);$CLJS.m(b)?$CLJS.m(Hta.g(b))?a=b:(a=$CLJS.W2.g,b=$CLJS.mn.l($CLJS.J([new $CLJS.k(null,2,[$CLJS.YP,Number.MAX_SAFE_INTEGER,$CLJS.al,$CLJS.GN],
null),$CLJS.m($CLJS.fQ.g(b))?new $CLJS.k(null,1,[$CLJS.fQ,$CLJS.ZM(b,new $CLJS.k(null,1,[$CLJS.fQ,$CLJS.GN],null))],null):new $CLJS.k(null,1,[$CLJS.GN,b],null)])),a=$CLJS.s0(a.call($CLJS.W2,(0,$CLJS.u7)(b)),-1)):a=null;return a},y7=function(){return $CLJS.bH("[Unknown Metric]")},Ita=function(a,b,c){a=$CLJS.s0(a,b);a=$CLJS.Uf(a);a=$CLJS.M.h(a,$CLJS.ZO);return $CLJS.ye($CLJS.ag(function(d){var e=$CLJS.K(d,0,null);return $CLJS.F.h(e,$CLJS.mP)?($CLJS.K(d,0,null),$CLJS.K(d,1,null),d=$CLJS.K(d,2,null),
$CLJS.F.h(d,c)):null},a))},Hta=new $CLJS.N("mbql","type","mbql/type",1170405116);$CLJS.rV.o(null,$CLJS.yV,function(a){var b=$CLJS.Uf(a);a=$CLJS.M.h(b,$CLJS.Lk);var c=function(){var e=$CLJS.qk.g(b);if($CLJS.m(e))return e;e=$CLJS.LF.g(b);if($CLJS.m(e))return e;e=$CLJS.C($CLJS.ZO.g(x7(b)));return $CLJS.m(e)?(e=$CLJS.LK(e),$CLJS.XG(e,$CLJS.sl)?e:null):null}(),d=function(){var e=new $CLJS.k(null,1,[$CLJS.EK,$CLJS.p.g($CLJS.IK())],null);return $CLJS.m(c)?$CLJS.U.j(e,$CLJS.qk,c):e}();return new $CLJS.R(null,3,5,$CLJS.S,[$CLJS.mP,d,a],null)});
$CLJS.Z0.o(null,$CLJS.yV,function(a,b,c){c=$CLJS.Vf($CLJS.ZO.g(x7(c)));$CLJS.m(c)?(c=$CLJS.K(c,0,null),a=$CLJS.$0.j(a,b,c)):a=null;return $CLJS.m(a)?a:$CLJS.sl});$CLJS.Z0.o(null,$CLJS.mP,function(a,b,c){$CLJS.K(c,0,null);$CLJS.K(c,1,null);c=$CLJS.K(c,2,null);c=$CLJS.Ae(c)?w7(a,c):null;a=$CLJS.m(c)?$CLJS.$0.j(a,b,c):null;return $CLJS.m(a)?a:$CLJS.sl});$CLJS.V0.o(null,$CLJS.yV,function(a,b,c){a=$CLJS.Tm.h($CLJS.YH,$CLJS.V)(c);return $CLJS.m(a)?a:y7()});
$CLJS.V0.o(null,$CLJS.mP,function(a,b,c,d){$CLJS.K(c,0,null);$CLJS.K(c,1,null);c=$CLJS.K(c,2,null);c=$CLJS.Ae(c)?w7(a,c):null;a=$CLJS.m(c)?$CLJS.z0.C(a,b,c,d):null;return $CLJS.m(a)?a:y7()});
$CLJS.a1.o(null,$CLJS.yV,function(a,b,c){var d=$CLJS.Uf(c);c=$CLJS.M.h(d,$CLJS.Lk);var e=$CLJS.M.h(d,$CLJS.$F),f=$CLJS.mn.l,g=$CLJS.yj($CLJS.a1,$CLJS.Uj);d=g.j?g.j(a,b,d):g.call(null,a,b,d);return f.call($CLJS.mn,$CLJS.J([d,new $CLJS.k(null,1,[$CLJS.$F,e],null),Ita(a,b,c)?new $CLJS.k(null,1,[$CLJS.H0,!0],null):null]))});
$CLJS.a1.o(null,$CLJS.mP,function(a,b,c){$CLJS.K(c,0,null);$CLJS.K(c,1,null);c=$CLJS.K(c,2,null);c=$CLJS.Ae(c)?w7(a,c):null;return $CLJS.m(c)?$CLJS.C0.j(a,b,c):new $CLJS.k(null,3,[$CLJS.qk,$CLJS.sl,$CLJS.YH,y7(),$CLJS.B0,y7()],null)});$CLJS.W0.o(null,$CLJS.mP,function(a,b,c){$CLJS.K(c,0,null);$CLJS.K(c,1,null);c=$CLJS.K(c,2,null);c=$CLJS.Ae(c)?w7(a,c):null;a=$CLJS.m(c)?$CLJS.X0.j(a,b,c):null;return $CLJS.m(a)?a:"metric"});