["^ ","~:output",["^ ","~:js","goog.provide('metabase.lib.convert');\nmetabase.lib.convert._STAR_pMBQL_uuid__GT_legacy_index_STAR_ = cljs.core.PersistentArrayMap.EMPTY;\nmetabase.lib.convert._STAR_legacy_index__GT_pMBQL_uuid_STAR_ = cljs.core.PersistentArrayMap.EMPTY;\nmetabase.lib.convert.clean_location = (function metabase$lib$convert$clean_location(almost_stage,error_type,error_location){\nvar operate_on_parent_QMARK_ = new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(\"malli.core\",\"missing-key\",\"malli.core/missing-key\",1439107666),null,new cljs.core.Keyword(\"malli.core\",\"end-of-input\",\"malli.core/end-of-input\",-491237771),null], null), null);\nvar location__$1 = (cljs.core.truth_((operate_on_parent_QMARK_.cljs$core$IFn$_invoke$arity$1 ? operate_on_parent_QMARK_.cljs$core$IFn$_invoke$arity$1(error_type) : operate_on_parent_QMARK_.call(null,error_type)))?cljs.core.drop_last.cljs$core$IFn$_invoke$arity$2((2),error_location):cljs.core.drop_last.cljs$core$IFn$_invoke$arity$2((1),error_location));\nvar vec__48675 = (cljs.core.truth_((operate_on_parent_QMARK_.cljs$core$IFn$_invoke$arity$1 ? operate_on_parent_QMARK_.cljs$core$IFn$_invoke$arity$1(error_type) : operate_on_parent_QMARK_.call(null,error_type)))?cljs.core.take_last((2),error_location):cljs.core.take_last((1),error_location));\nvar location_key = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__48675,(0),null);\nif(cljs.core.seq(location__$1)){\nreturn cljs.core.update_in.cljs$core$IFn$_invoke$arity$3(almost_stage,location__$1,(function (error_loc){\nvar result = cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(error_loc,location_key,null);\nif(cljs.core.vector_QMARK_(error_loc)){\nreturn cljs.core.into.cljs$core$IFn$_invoke$arity$3(cljs.core.PersistentVector.EMPTY,cljs.core.remove.cljs$core$IFn$_invoke$arity$1(cljs.core.nil_QMARK_),result);\n} else {\nif(cljs.core.map_QMARK_(error_loc)){\nreturn metabase.util.remove_nils(result);\n} else {\nreturn result;\n\n}\n}\n}));\n} else {\nreturn cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(almost_stage,location_key);\n}\n});\nmetabase.lib.convert.stage_keys = new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 7, [new cljs.core.Keyword(null,\"filters\",\"filters\",974726919),null,new cljs.core.Keyword(null,\"fields\",\"fields\",-1932066230),null,new cljs.core.Keyword(null,\"joins\",\"joins\",1033962699),null,new cljs.core.Keyword(null,\"expressions\",\"expressions\",255689909),null,new cljs.core.Keyword(null,\"breakout\",\"breakout\",-732419050),null,new cljs.core.Keyword(null,\"order-by\",\"order-by\",1527318070),null,new cljs.core.Keyword(null,\"aggregation\",\"aggregation\",1597476696),null], null), null);\nmetabase.lib.convert.clean_stage = (function metabase$lib$convert$clean_stage(almost_stage){\nvar almost_stage__$1 = almost_stage;\nvar removals = cljs.core.PersistentVector.EMPTY;\nwhile(true){\nvar temp__5802__auto__ = cljs.core.first(cljs.core.map.cljs$core$IFn$_invoke$arity$2(cljs.core.juxt.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\"type\",\"type\",1174270348),new cljs.core.Keyword(null,\"in\",\"in\",-1531184865)),cljs.core.filter.cljs$core$IFn$_invoke$arity$2(cljs.core.comp.cljs$core$IFn$_invoke$arity$3(metabase.lib.convert.stage_keys,cljs.core.first,new cljs.core.Keyword(null,\"in\",\"in\",-1531184865)),new cljs.core.Keyword(null,\"errors\",\"errors\",-908790718).cljs$core$IFn$_invoke$arity$1(malli.core.explain.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(\"metabase.lib.schema\",\"stage.mbql\",\"metabase.lib.schema/stage.mbql\",1051351388),almost_stage__$1)))));\nif(cljs.core.truth_(temp__5802__auto__)){\nvar vec__48685 = temp__5802__auto__;\nvar error_type = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__48685,(0),null);\nvar error_location = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__48685,(1),null);\nvar new_stage = metabase.lib.convert.clean_location(almost_stage__$1,error_type,error_location);\nvar level__30248__auto___49175 = metabase.util.log.glogi_level(new cljs.core.Keyword(null,\"warn\",\"warn\",-436710552));\nvar logger__30249__auto___49176 = \"metabase.lib.convert\";\nif(cljs.core.truth_(metabase.util.log.is_loggable_QMARK_(logger__30249__auto___49176,level__30248__auto___49175))){\nvar x__30250__auto___49177 = \"Clean: Removing bad clause in %s due to error %s:\\n%s\";\nif((x__30250__auto___49177 instanceof Error)){\nlambdaisland.glogi.log.cljs$core$IFn$_invoke$arity$4(logger__30249__auto___49176,level__30248__auto___49175,metabase.util.log.format_msg.cljs$core$IFn$_invoke$arity$variadic(metabase.util.colorize.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\"yellow\",\"yellow\",-881035449),cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([error_location], 0))], 0)),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([metabase.util.colorize.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\"yellow\",\"yellow\",-881035449),cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([(function (){var or__5045__auto__ = error_type;\nif(cljs.core.truth_(or__5045__auto__)){\nreturn or__5045__auto__;\n} else {\nreturn malli.error.humanize.cljs$core$IFn$_invoke$arity$1(malli.core.explain.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(\"metabase.lib.schema\",\"stage.mbql\",\"metabase.lib.schema/stage.mbql\",1051351388),almost_stage__$1));\n}\n})()], 0))], 0)),metabase.util.colorize.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\"red\",\"red\",-969428204),metabase.util.pprint_to_str.cljs$core$IFn$_invoke$arity$1(cljs.core.first(clojure.data.diff(almost_stage__$1,new_stage)))], 0))], 0)),x__30250__auto___49177);\n} else {\nlambdaisland.glogi.log.cljs$core$IFn$_invoke$arity$4(logger__30249__auto___49176,level__30248__auto___49175,metabase.util.log.format_msg.cljs$core$IFn$_invoke$arity$variadic(x__30250__auto___49177,cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([metabase.util.colorize.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\"yellow\",\"yellow\",-881035449),cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([error_location], 0))], 0)),metabase.util.colorize.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\"yellow\",\"yellow\",-881035449),cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([(function (){var or__5045__auto__ = error_type;\nif(cljs.core.truth_(or__5045__auto__)){\nreturn or__5045__auto__;\n} else {\nreturn malli.error.humanize.cljs$core$IFn$_invoke$arity$1(malli.core.explain.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(\"metabase.lib.schema\",\"stage.mbql\",\"metabase.lib.schema/stage.mbql\",1051351388),almost_stage__$1));\n}\n})()], 0))], 0)),metabase.util.colorize.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\"red\",\"red\",-969428204),metabase.util.pprint_to_str.cljs$core$IFn$_invoke$arity$1(cljs.core.first(clojure.data.diff(almost_stage__$1,new_stage)))], 0))], 0)),null);\n}\n} else {\n}\n\nif(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new_stage,almost_stage__$1)){\nreturn almost_stage__$1;\n} else {\nvar G__49178 = new_stage;\nvar G__49179 = cljs.core.conj.cljs$core$IFn$_invoke$arity$2(removals,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [error_type,error_location], null));\nalmost_stage__$1 = G__49178;\nremovals = G__49179;\ncontinue;\n}\n} else {\nreturn almost_stage__$1;\n}\nbreak;\n}\n});\nmetabase.lib.convert.clean = (function metabase$lib$convert$clean(almost_query){\nvar almost_query__$1 = almost_query;\nvar stage_index = (0);\nwhile(true){\nvar current_stage = cljs.core.nth.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\"stages\",\"stages\",-442109532).cljs$core$IFn$_invoke$arity$1(almost_query__$1),stage_index);\nvar new_stage = metabase.lib.convert.clean_stage(current_stage);\nif(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(current_stage,new_stage)){\nif(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(stage_index,(cljs.core.count(new cljs.core.Keyword(null,\"stages\",\"stages\",-442109532).cljs$core$IFn$_invoke$arity$1(almost_query__$1)) - (1)))){\nreturn almost_query__$1;\n} else {\nvar G__49180 = almost_query__$1;\nvar G__49181 = (stage_index + (1));\nalmost_query__$1 = G__49180;\nstage_index = G__49181;\ncontinue;\n}\n} else {\nvar G__49182 = cljs.core.update.cljs$core$IFn$_invoke$arity$5(almost_query__$1,new cljs.core.Keyword(null,\"stages\",\"stages\",-442109532),cljs.core.assoc,stage_index,new_stage);\nvar G__49183 = stage_index;\nalmost_query__$1 = G__49182;\nstage_index = G__49183;\ncontinue;\n}\nbreak;\n}\n});\n/**\n * Coerce something to pMBQL (the version of MBQL manipulated by Dashboard Lib v2) if it's not already pMBQL.\n */\nmetabase.lib.convert.__GT_pMBQL = (function (){var method_table__5642__auto__ = cljs.core.atom.cljs$core$IFn$_invoke$arity$1(cljs.core.PersistentArrayMap.EMPTY);\nvar prefer_table__5643__auto__ = cljs.core.atom.cljs$core$IFn$_invoke$arity$1(cljs.core.PersistentArrayMap.EMPTY);\nvar method_cache__5644__auto__ = cljs.core.atom.cljs$core$IFn$_invoke$arity$1(cljs.core.PersistentArrayMap.EMPTY);\nvar cached_hierarchy__5645__auto__ = cljs.core.atom.cljs$core$IFn$_invoke$arity$1(cljs.core.PersistentArrayMap.EMPTY);\nvar hierarchy__5646__auto__ = cljs.core.get.cljs$core$IFn$_invoke$arity$3(new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\"hierarchy\",\"hierarchy\",-1053470341),metabase.lib.hierarchy.hierarchy], null),new cljs.core.Keyword(null,\"hierarchy\",\"hierarchy\",-1053470341),(function (){var fexpr__48702 = cljs.core.get_global_hierarchy;\nreturn (fexpr__48702.cljs$core$IFn$_invoke$arity$0 ? fexpr__48702.cljs$core$IFn$_invoke$arity$0() : fexpr__48702.call(null));\n})());\nreturn (new cljs.core.MultiFn(cljs.core.symbol.cljs$core$IFn$_invoke$arity$2(\"metabase.lib.convert\",\"->pMBQL\"),metabase.lib.dispatch.dispatch_value,new cljs.core.Keyword(null,\"default\",\"default\",-1987822328),hierarchy__5646__auto__,method_table__5642__auto__,prefer_table__5643__auto__,method_cache__5644__auto__,cached_hierarchy__5645__auto__));\n})();\nmetabase.lib.convert.default_MBQL_clause__GT_pMBQL = (function metabase$lib$convert$default_MBQL_clause__GT_pMBQL(mbql_clause){\nvar last_elem = cljs.core.peek(mbql_clause);\nvar last_elem_option_QMARK_ = cljs.core.map_QMARK_(last_elem);\nvar vec__48704 = (function (){var G__48709 = mbql_clause;\nif(last_elem_option_QMARK_){\nreturn cljs.core.pop(G__48709);\n} else {\nreturn G__48709;\n}\n})();\nvar seq__48705 = cljs.core.seq(vec__48704);\nvar first__48706 = cljs.core.first(seq__48705);\nvar seq__48705__$1 = cljs.core.next(seq__48705);\nvar clause_type = first__48706;\nvar args = seq__48705__$1;\nvar options = ((last_elem_option_QMARK_)?last_elem:cljs.core.PersistentArrayMap.EMPTY);\nreturn metabase.lib.options.ensure_uuid(cljs.core.into.cljs$core$IFn$_invoke$arity$3(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [clause_type,options], null),cljs.core.map.cljs$core$IFn$_invoke$arity$1(metabase.lib.convert.__GT_pMBQL),args));\n});\nmetabase.lib.convert.__GT_pMBQL.cljs$core$IMultiFn$_add_method$arity$3(null,new cljs.core.Keyword(null,\"default\",\"default\",-1987822328),(function (x){\nif(((cljs.core.vector_QMARK_(x)) && ((cljs.core.first(x) instanceof cljs.core.Keyword)))){\nreturn metabase.lib.convert.default_MBQL_clause__GT_pMBQL(x);\n} else {\nreturn x;\n}\n}));\nmetabase.lib.convert.__GT_pMBQL.cljs$core$IMultiFn$_add_method$arity$3(null,new cljs.core.Keyword(\"mbql\",\"query\",\"mbql/query\",-1285688662),(function (query){\nreturn query;\n}));\n/**\n * In legacy MBQL, join `:alias` was optional, and if unspecified, this was the default alias used. In reality all joins\n *   normally had an explicit `:alias` since the QB would generate one and you generally need one to do useful things\n *   with the join anyway.\n * \n *   Since the new pMBQL schema makes `:alias` required, we'll explicitly add the implicit default when we encounter a\n *   join without an alias, and remove it so we can round-trip without changes.\n */\nmetabase.lib.convert.legacy_default_join_alias = \"__join\";\n/**\n * Join `:alias`es had to be unique in legacy MBQL, but they were optional. Since we add [[legacy-default-join-alias]]\n *   to each join that doesn't have an explicit `:alias` for pMBQL compatibility now, we need to deduplicate the aliases\n *   if it is used more than once.\n * \n *   Only deduplicate the default `__join` aliases; we don't want the [[lib.util/unique-name-generator]] to touch other\n *   aliases and truncate them or anything like that.\n */\nmetabase.lib.convert.deduplicate_join_aliases = (function metabase$lib$convert$deduplicate_join_aliases(joins){\nvar unique_name_fn = metabase.lib.util.unique_name_generator();\nreturn cljs.core.mapv.cljs$core$IFn$_invoke$arity$2((function (join){\nvar G__48745 = join;\nif(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\"alias\",\"alias\",-2039751630).cljs$core$IFn$_invoke$arity$1(join),metabase.lib.convert.legacy_default_join_alias)){\nreturn cljs.core.update.cljs$core$IFn$_invoke$arity$3(G__48745,new cljs.core.Keyword(null,\"alias\",\"alias\",-2039751630),unique_name_fn);\n} else {\nreturn G__48745;\n}\n}),joins);\n});\n/**\n * If a query `stage` has a legacy `card__<id>` `:source-table`, convert it to a pMBQL-style `:source-card`.\n */\nmetabase.lib.convert.stage_source_card_id__GT_pMBQL = (function metabase$lib$convert$stage_source_card_id__GT_pMBQL(stage){\nif(typeof new cljs.core.Keyword(null,\"source-table\",\"source-table\",-225307692).cljs$core$IFn$_invoke$arity$1(stage) === 'string'){\nreturn cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(stage,new cljs.core.Keyword(null,\"source-card\",\"source-card\",-1580820390),metabase.lib.util.legacy_string_table_id__GT_card_id(new cljs.core.Keyword(null,\"source-table\",\"source-table\",-225307692).cljs$core$IFn$_invoke$arity$1(stage))),new cljs.core.Keyword(null,\"source-table\",\"source-table\",-225307692));\n} else {\nreturn stage;\n}\n});\nmetabase.lib.convert.__GT_pMBQL.cljs$core$IMultiFn$_add_method$arity$3(null,new cljs.core.Keyword(\"mbql.stage\",\"mbql\",\"mbql.stage/mbql\",1578747798),(function (stage){\nvar aggregations = metabase.lib.convert.__GT_pMBQL.cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword(null,\"aggregation\",\"aggregation\",1597476696).cljs$core$IFn$_invoke$arity$1(stage));\nvar expressions = cljs.core.not_empty(cljs.core.mapv.cljs$core$IFn$_invoke$arity$2((function (p__48747){\nvar vec__48749 = p__48747;\nvar k = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__48749,(0),null);\nvar v = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__48749,(1),null);\nreturn metabase.lib.util.named_expression_clause(metabase.lib.convert.__GT_pMBQL.cljs$core$IFn$_invoke$arity$1(v),k);\n}),new cljs.core.Keyword(null,\"expressions\",\"expressions\",255689909).cljs$core$IFn$_invoke$arity$1(stage)));\nvar _STAR_legacy_index__GT_pMBQL_uuid_STAR__orig_val__48752 = metabase.lib.convert._STAR_legacy_index__GT_pMBQL_uuid_STAR_;\nvar _STAR_legacy_index__GT_pMBQL_uuid_STAR__temp_val__48753 = cljs.core.into.cljs$core$IFn$_invoke$arity$3(cljs.core.PersistentArrayMap.EMPTY,cljs.core.map_indexed.cljs$core$IFn$_invoke$arity$1((function (idx,p__48757){\nvar vec__48758 = p__48757;\nvar _tag = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__48758,(0),null);\nvar map__48761 = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__48758,(1),null);\nvar map__48761__$1 = cljs.core.__destructure_map(map__48761);\nvar ag_uuid = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__48761__$1,new cljs.core.Keyword(\"lib\",\"uuid\",\"lib/uuid\",-2145250720));\nreturn new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [idx,ag_uuid], null);\n})),aggregations);\n(metabase.lib.convert._STAR_legacy_index__GT_pMBQL_uuid_STAR_ = _STAR_legacy_index__GT_pMBQL_uuid_STAR__temp_val__48753);\n\ntry{var stage__$1 = medley.core.assoc_some.cljs$core$IFn$_invoke$arity$variadic(metabase.lib.convert.stage_source_card_id__GT_pMBQL(stage),new cljs.core.Keyword(null,\"aggregation\",\"aggregation\",1597476696),aggregations,cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\"expressions\",\"expressions\",255689909),expressions], 0));\nvar stage__$2 = cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (stage__$2,k){\nif(cljs.core.not(cljs.core.get.cljs$core$IFn$_invoke$arity$2(stage__$2,k))){\nreturn stage__$2;\n} else {\nreturn cljs.core.update.cljs$core$IFn$_invoke$arity$3(stage__$2,k,metabase.lib.convert.__GT_pMBQL);\n}\n}),stage__$1,cljs.core.disj.cljs$core$IFn$_invoke$arity$variadic(metabase.lib.convert.stage_keys,new cljs.core.Keyword(null,\"aggregation\",\"aggregation\",1597476696),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\"expressions\",\"expressions\",255689909)], 0)));\nvar G__48763 = stage__$2;\nif(cljs.core.truth_(new cljs.core.Keyword(null,\"joins\",\"joins\",1033962699).cljs$core$IFn$_invoke$arity$1(stage__$2))){\nreturn cljs.core.update.cljs$core$IFn$_invoke$arity$3(G__48763,new cljs.core.Keyword(null,\"joins\",\"joins\",1033962699),metabase.lib.convert.deduplicate_join_aliases);\n} else {\nreturn G__48763;\n}\n}finally {(metabase.lib.convert._STAR_legacy_index__GT_pMBQL_uuid_STAR_ = _STAR_legacy_index__GT_pMBQL_uuid_STAR__orig_val__48752);\n}}));\nmetabase.lib.convert.__GT_pMBQL.cljs$core$IMultiFn$_add_method$arity$3(null,new cljs.core.Keyword(\"mbql.stage\",\"native\",\"mbql.stage/native\",359422194),(function (stage){\nreturn medley.core.update_existing.cljs$core$IFn$_invoke$arity$4(stage,new cljs.core.Keyword(null,\"template-tags\",\"template-tags\",1853115685),cljs.core.update_vals,(function (tag){\nreturn medley.core.update_existing.cljs$core$IFn$_invoke$arity$3(tag,new cljs.core.Keyword(null,\"dimension\",\"dimension\",543254198),metabase.lib.convert.__GT_pMBQL);\n}));\n}));\nmetabase.lib.convert.__GT_pMBQL.cljs$core$IMultiFn$_add_method$arity$3(null,new cljs.core.Keyword(\"mbql\",\"join\",\"mbql/join\",-709512370),(function (join){\nvar join__$1 = cljs.core.update.cljs$core$IFn$_invoke$arity$3(cljs.core.update.cljs$core$IFn$_invoke$arity$3(join,new cljs.core.Keyword(null,\"conditions\",\"conditions\",-1647236270),metabase.lib.convert.__GT_pMBQL),new cljs.core.Keyword(null,\"stages\",\"stages\",-442109532),metabase.lib.convert.__GT_pMBQL);\nvar G__48764 = join__$1;\nvar G__48764__$1 = (cljs.core.truth_(new cljs.core.Keyword(null,\"fields\",\"fields\",-1932066230).cljs$core$IFn$_invoke$arity$1(join__$1))?cljs.core.update.cljs$core$IFn$_invoke$arity$3(G__48764,new cljs.core.Keyword(null,\"fields\",\"fields\",-1932066230),(function (fields){\nif(cljs.core.seqable_QMARK_(fields)){\nreturn cljs.core.mapv.cljs$core$IFn$_invoke$arity$2(metabase.lib.convert.__GT_pMBQL,fields);\n} else {\nreturn cljs.core.keyword.cljs$core$IFn$_invoke$arity$1(fields);\n}\n})):G__48764);\nif(cljs.core.not(new cljs.core.Keyword(null,\"alias\",\"alias\",-2039751630).cljs$core$IFn$_invoke$arity$1(join__$1))){\nreturn cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(G__48764__$1,new cljs.core.Keyword(null,\"alias\",\"alias\",-2039751630),metabase.lib.convert.legacy_default_join_alias);\n} else {\nreturn G__48764__$1;\n}\n}));\nmetabase.lib.convert.__GT_pMBQL.cljs$core$IMultiFn$_add_method$arity$3(null,new cljs.core.Keyword(\"dispatch-type\",\"sequential\",\"dispatch-type/sequential\",1056993969),(function (xs){\nreturn cljs.core.mapv.cljs$core$IFn$_invoke$arity$2(metabase.lib.convert.__GT_pMBQL,xs);\n}));\nmetabase.lib.convert.__GT_pMBQL.cljs$core$IMultiFn$_add_method$arity$3(null,new cljs.core.Keyword(\"dispatch-type\",\"map\",\"dispatch-type/map\",-758153422),(function (m){\nif(cljs.core.truth_(new cljs.core.Keyword(null,\"type\",\"type\",1174270348).cljs$core$IFn$_invoke$arity$1(m))){\nreturn metabase.lib.convert.clean(cljs.core.update.cljs$core$IFn$_invoke$arity$3(metabase.lib.util.pipeline(m),new cljs.core.Keyword(null,\"stages\",\"stages\",-442109532),(function (stages){\nreturn cljs.core.mapv.cljs$core$IFn$_invoke$arity$2(metabase.lib.convert.__GT_pMBQL,stages);\n})));\n} else {\nreturn cljs.core.update_vals(m,metabase.lib.convert.__GT_pMBQL);\n}\n}));\nmetabase.lib.convert.__GT_pMBQL.cljs$core$IMultiFn$_add_method$arity$3(null,new cljs.core.Keyword(null,\"field\",\"field\",-1302436500),(function (p__48775){\nvar vec__48776 = p__48775;\nvar _tag = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__48776,(0),null);\nvar x = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__48776,(1),null);\nvar y = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__48776,(2),null);\nvar vec__48779 = ((cljs.core.map_QMARK_(x))?new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [y,x], null):new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [x,y], null));\nvar id_or_name = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__48779,(0),null);\nvar options = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__48779,(1),null);\nreturn metabase.lib.options.ensure_uuid(new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\"field\",\"field\",-1302436500),options,id_or_name], null));\n}));\nmetabase.lib.convert.__GT_pMBQL.cljs$core$IMultiFn$_add_method$arity$3(null,new cljs.core.Keyword(null,\"value\",\"value\",305978217),(function (p__48783){\nvar vec__48785 = p__48783;\nvar _tag = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__48785,(0),null);\nvar value = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__48785,(1),null);\nvar opts = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__48785,(2),null);\nvar opts__$1 = clojure.set.rename_keys(opts,new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\"base_type\",\"base_type\",1908272670),new cljs.core.Keyword(null,\"base-type\",\"base-type\",1167971299),new cljs.core.Keyword(null,\"semantic_type\",\"semantic_type\",272485089),new cljs.core.Keyword(null,\"semantic-type\",\"semantic-type\",-310722107),new cljs.core.Keyword(null,\"database_type\",\"database_type\",-54700895),new cljs.core.Keyword(null,\"database-type\",\"database-type\",-426840562)], null));\nvar opts__$2 = cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(opts__$1,new cljs.core.Keyword(null,\"effective-type\",\"effective-type\",-355725458),(function (){var or__5045__auto__ = new cljs.core.Keyword(null,\"effective-type\",\"effective-type\",-355725458).cljs$core$IFn$_invoke$arity$1(opts__$1);\nif(cljs.core.truth_(or__5045__auto__)){\nreturn or__5045__auto__;\n} else {\nvar or__5045__auto____$1 = new cljs.core.Keyword(null,\"base-type\",\"base-type\",1167971299).cljs$core$IFn$_invoke$arity$1(opts__$1);\nif(cljs.core.truth_(or__5045__auto____$1)){\nreturn or__5045__auto____$1;\n} else {\nreturn metabase.lib.schema.expression.type_of(value);\n}\n}\n})());\nreturn metabase.lib.options.ensure_uuid(new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\"value\",\"value\",305978217),opts__$2,value], null));\n}));\nmetabase.lib.convert.__GT_pMBQL.cljs$core$IMultiFn$_add_method$arity$3(null,new cljs.core.Keyword(null,\"case\",\"case\",1143702196),(function (p__48789){\nvar vec__48790 = p__48789;\nvar _tag = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__48790,(0),null);\nvar pred_expr_pairs = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__48790,(1),null);\nvar options = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__48790,(2),null);\nvar default$ = new cljs.core.Keyword(null,\"default\",\"default\",-1987822328).cljs$core$IFn$_invoke$arity$1(options);\nvar G__48793 = new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\"case\",\"case\",1143702196),cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(options,new cljs.core.Keyword(null,\"default\",\"default\",-1987822328)),cljs.core.mapv.cljs$core$IFn$_invoke$arity$2(metabase.lib.convert.__GT_pMBQL,pred_expr_pairs)], null);\nvar G__48793__$1 = metabase.lib.options.ensure_uuid(G__48793)\n;\nif((!((default$ == null)))){\nreturn cljs.core.conj.cljs$core$IFn$_invoke$arity$2(G__48793__$1,metabase.lib.convert.__GT_pMBQL.cljs$core$IFn$_invoke$arity$1(default$));\n} else {\nreturn G__48793__$1;\n}\n}));\nmetabase.lib.convert.__GT_pMBQL.cljs$core$IMultiFn$_add_method$arity$3(null,new cljs.core.Keyword(null,\"expression\",\"expression\",202311876),(function (p__48799){\nvar vec__48800 = p__48799;\nvar tag = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__48800,(0),null);\nvar value = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__48800,(1),null);\nvar opts = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__48800,(2),null);\nreturn metabase.lib.options.ensure_uuid(new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [tag,opts,value], null));\n}));\nmetabase.lib.convert.get_or_throw_BANG_ = (function metabase$lib$convert$get_or_throw_BANG_(m,k){\nvar result = cljs.core.get.cljs$core$IFn$_invoke$arity$3(m,k,new cljs.core.Keyword(\"metabase.lib.convert\",\"not-found\",\"metabase.lib.convert/not-found\",967996550));\nif((!(cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(result,new cljs.core.Keyword(\"metabase.lib.convert\",\"not-found\",\"metabase.lib.convert/not-found\",967996550))))){\nreturn result;\n} else {\nthrow cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2([\"Unable to find \",cljs.core.pr_str.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([k], 0)),\" in map.\"].join(''),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\"m\",\"m\",1632677161),m,new cljs.core.Keyword(null,\"k\",\"k\",-2146297393),k], null));\n}\n});\nmetabase.lib.convert.__GT_pMBQL.cljs$core$IMultiFn$_add_method$arity$3(null,new cljs.core.Keyword(null,\"aggregation\",\"aggregation\",1597476696),(function (p__48804){\nvar vec__48805 = p__48804;\nvar tag = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__48805,(0),null);\nvar value = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__48805,(1),null);\nvar opts = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__48805,(2),null);\nreturn metabase.lib.options.ensure_uuid(new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [tag,opts,metabase.lib.convert.get_or_throw_BANG_(metabase.lib.convert._STAR_legacy_index__GT_pMBQL_uuid_STAR_,value)], null));\n}));\nmetabase.lib.convert.__GT_pMBQL.cljs$core$IMultiFn$_add_method$arity$3(null,new cljs.core.Keyword(null,\"aggregation-options\",\"aggregation-options\",-1904917550),(function (p__48820){\nvar vec__48822 = p__48820;\nvar _tag = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__48822,(0),null);\nvar aggregation = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__48822,(1),null);\nvar options = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__48822,(2),null);\nvar vec__48830 = metabase.lib.convert.__GT_pMBQL.cljs$core$IFn$_invoke$arity$1(aggregation);\nvar seq__48831 = cljs.core.seq(vec__48830);\nvar first__48832 = cljs.core.first(seq__48831);\nvar seq__48831__$1 = cljs.core.next(seq__48831);\nvar tag = first__48832;\nvar first__48832__$1 = cljs.core.first(seq__48831__$1);\nvar seq__48831__$2 = cljs.core.next(seq__48831__$1);\nvar opts = first__48832__$1;\nvar args = seq__48831__$2;\nreturn cljs.core.into.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [tag,cljs.core.merge.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([opts,options], 0))], null),args);\n}));\n/**\n * Convert a legacy 'inner query' to a full legacy 'outer query' so you can pass it to stuff\n *   like [[metabase.mbql.normalize/normalize]], and then probably to [[->pMBQL]].\n */\nmetabase.lib.convert.legacy_query_from_inner_query = (function metabase$lib$convert$legacy_query_from_inner_query(database_id,inner_query){\nreturn cljs.core.merge.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,\"database\",\"database\",1849087575),database_id,new cljs.core.Keyword(null,\"type\",\"type\",1174270348),new cljs.core.Keyword(null,\"query\",\"query\",-1288509510)], null),(cljs.core.truth_(new cljs.core.Keyword(null,\"native\",\"native\",-613060878).cljs$core$IFn$_invoke$arity$1(inner_query))?new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\"native\",\"native\",-613060878),clojure.set.rename_keys(inner_query,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\"native\",\"native\",-613060878),new cljs.core.Keyword(null,\"query\",\"query\",-1288509510)], null))], null):new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\"query\",\"query\",-1288509510),inner_query], null))], 0));\n});\n/**\n * Coerce something to legacy MBQL (the version of MBQL understood by the query processor and Dashboard Lib v1) if it's\n *   not already legacy MBQL.\n */\nmetabase.lib.convert.__GT_legacy_MBQL = (function (){var method_table__5642__auto__ = cljs.core.atom.cljs$core$IFn$_invoke$arity$1(cljs.core.PersistentArrayMap.EMPTY);\nvar prefer_table__5643__auto__ = cljs.core.atom.cljs$core$IFn$_invoke$arity$1(cljs.core.PersistentArrayMap.EMPTY);\nvar method_cache__5644__auto__ = cljs.core.atom.cljs$core$IFn$_invoke$arity$1(cljs.core.PersistentArrayMap.EMPTY);\nvar cached_hierarchy__5645__auto__ = cljs.core.atom.cljs$core$IFn$_invoke$arity$1(cljs.core.PersistentArrayMap.EMPTY);\nvar hierarchy__5646__auto__ = cljs.core.get.cljs$core$IFn$_invoke$arity$3(new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\"hierarchy\",\"hierarchy\",-1053470341),metabase.lib.hierarchy.hierarchy], null),new cljs.core.Keyword(null,\"hierarchy\",\"hierarchy\",-1053470341),(function (){var fexpr__48838 = cljs.core.get_global_hierarchy;\nreturn (fexpr__48838.cljs$core$IFn$_invoke$arity$0 ? fexpr__48838.cljs$core$IFn$_invoke$arity$0() : fexpr__48838.call(null));\n})());\nreturn (new cljs.core.MultiFn(cljs.core.symbol.cljs$core$IFn$_invoke$arity$2(\"metabase.lib.convert\",\"->legacy-MBQL\"),metabase.lib.dispatch.dispatch_value,new cljs.core.Keyword(null,\"default\",\"default\",-1987822328),hierarchy__5646__auto__,method_table__5642__auto__,prefer_table__5643__auto__,method_cache__5644__auto__,cached_hierarchy__5645__auto__));\n})();\n/**\n * Remove any keys starting with the `:lib/` namespace from map `m`.\n * \n *   No args = return transducer to remove `:lib/` keys from a map. One arg = update a map `m`.\n */\nmetabase.lib.convert.disqualify = (function metabase$lib$convert$disqualify(var_args){\nvar G__48840 = arguments.length;\nswitch (G__48840) {\ncase 0:\nreturn metabase.lib.convert.disqualify.cljs$core$IFn$_invoke$arity$0();\n\nbreak;\ncase 1:\nreturn metabase.lib.convert.disqualify.cljs$core$IFn$_invoke$arity$1((arguments[(0)]));\n\nbreak;\ndefault:\nthrow (new Error([\"Invalid arity: \",cljs.core.str.cljs$core$IFn$_invoke$arity$1(arguments.length)].join('')));\n\n}\n});\n\n(metabase.lib.convert.disqualify.cljs$core$IFn$_invoke$arity$0 = (function (){\nreturn cljs.core.remove.cljs$core$IFn$_invoke$arity$1((function (p__48841){\nvar vec__48842 = p__48841;\nvar k = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__48842,(0),null);\nvar _v = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__48842,(1),null);\nreturn ((cljs.core.qualified_keyword_QMARK_(k)) && (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.namespace(k),\"lib\")));\n}));\n}));\n\n(metabase.lib.convert.disqualify.cljs$core$IFn$_invoke$arity$1 = (function (m){\nreturn cljs.core.into.cljs$core$IFn$_invoke$arity$3(cljs.core.PersistentArrayMap.EMPTY,metabase.lib.convert.disqualify.cljs$core$IFn$_invoke$arity$0(),m);\n}));\n\n(metabase.lib.convert.disqualify.cljs$lang$maxFixedArity = 1);\n\n/**\n * Convert an options map in an MBQL clause to the equivalent shape for legacy MBQL. Remove `:lib/*` keys and\n *   `:effective-type`, which is not used in options maps in legacy MBQL.\n */\nmetabase.lib.convert.options__GT_legacy_MBQL = (function metabase$lib$convert$options__GT_legacy_MBQL(m){\nreturn cljs.core.not_empty(cljs.core.into.cljs$core$IFn$_invoke$arity$3(cljs.core.PersistentArrayMap.EMPTY,cljs.core.comp.cljs$core$IFn$_invoke$arity$2(metabase.lib.convert.disqualify.cljs$core$IFn$_invoke$arity$0(),cljs.core.remove.cljs$core$IFn$_invoke$arity$1((function (p__48845){\nvar vec__48846 = p__48845;\nvar k = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__48846,(0),null);\nvar _v = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__48846,(1),null);\nreturn cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(k,new cljs.core.Keyword(null,\"effective-type\",\"effective-type\",-355725458));\n}))),m));\n});\nmetabase.lib.convert.aggregation__GT_legacy_MBQL = (function metabase$lib$convert$aggregation__GT_legacy_MBQL(p__48849){\nvar vec__48850 = p__48849;\nvar seq__48851 = cljs.core.seq(vec__48850);\nvar first__48852 = cljs.core.first(seq__48851);\nvar seq__48851__$1 = cljs.core.next(seq__48851);\nvar tag = first__48852;\nvar first__48852__$1 = cljs.core.first(seq__48851__$1);\nvar seq__48851__$2 = cljs.core.next(seq__48851__$1);\nvar options = first__48852__$1;\nvar args = seq__48851__$2;\nvar inner = cljs.core.into.cljs$core$IFn$_invoke$arity$3(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [tag], null),cljs.core.map.cljs$core$IFn$_invoke$arity$1(metabase.lib.convert.__GT_legacy_MBQL),args);\nvar inner__$1 = ((((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(tag,new cljs.core.Keyword(null,\"case\",\"case\",1143702196))) && (cljs.core.next(args))))?cljs.core.conj.cljs$core$IFn$_invoke$arity$2(cljs.core.pop(inner),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\"default\",\"default\",-1987822328),cljs.core.peek(inner)], null)):inner);\nvar temp__5802__auto__ = cljs.core.not_empty(metabase.lib.convert.options__GT_legacy_MBQL(options));\nif(cljs.core.truth_(temp__5802__auto__)){\nvar aggregation_opts = temp__5802__auto__;\nreturn new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\"aggregation-options\",\"aggregation-options\",-1904917550),inner__$1,aggregation_opts], null);\n} else {\nreturn inner__$1;\n}\n});\nmetabase.lib.convert.clause_with_options__GT_legacy_MBQL = (function metabase$lib$convert$clause_with_options__GT_legacy_MBQL(p__48856){\nvar vec__48857 = p__48856;\nvar seq__48858 = cljs.core.seq(vec__48857);\nvar first__48859 = cljs.core.first(seq__48858);\nvar seq__48858__$1 = cljs.core.next(seq__48858);\nvar k = first__48859;\nvar first__48859__$1 = cljs.core.first(seq__48858__$1);\nvar seq__48858__$2 = cljs.core.next(seq__48858__$1);\nvar options = first__48859__$1;\nvar args = seq__48858__$2;\nif(cljs.core.map_QMARK_(options)){\nreturn cljs.core.into.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [k], null),cljs.core.concat.cljs$core$IFn$_invoke$arity$2(cljs.core.map.cljs$core$IFn$_invoke$arity$2(metabase.lib.convert.__GT_legacy_MBQL,args),(function (){var temp__5804__auto__ = metabase.lib.convert.options__GT_legacy_MBQL(options);\nif(cljs.core.truth_(temp__5804__auto__)){\nvar options__$1 = temp__5804__auto__;\nreturn new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [options__$1], null);\n} else {\nreturn null;\n}\n})()));\n} else {\nreturn cljs.core.into.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [k], null),cljs.core.map.cljs$core$IFn$_invoke$arity$2(metabase.lib.convert.__GT_legacy_MBQL,cljs.core.cons(options,args)));\n}\n});\nmetabase.lib.convert.__GT_legacy_MBQL.cljs$core$IMultiFn$_add_method$arity$3(null,new cljs.core.Keyword(null,\"default\",\"default\",-1987822328),(function (x){\nif(((cljs.core.vector_QMARK_(x)) && ((cljs.core.first(x) instanceof cljs.core.Keyword)))){\nreturn metabase.lib.convert.clause_with_options__GT_legacy_MBQL(x);\n} else {\nif(cljs.core.map_QMARK_(x)){\nreturn cljs.core.update_vals(metabase.lib.convert.disqualify.cljs$core$IFn$_invoke$arity$1(x),metabase.lib.convert.__GT_legacy_MBQL);\n} else {\nreturn x;\n\n}\n}\n}));\nvar seq__48864_49218 = cljs.core.seq(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(\"metabase.lib.convert\",\"aggregation\",\"metabase.lib.convert/aggregation\",108290790),new cljs.core.Keyword(\"metabase.lib.convert\",\"expression\",\"metabase.lib.convert/expression\",1648102782)], null));\nvar chunk__48865_49219 = null;\nvar count__48866_49220 = (0);\nvar i__48867_49221 = (0);\nwhile(true){\nif((i__48867_49221 < count__48866_49220)){\nvar tag_49222 = chunk__48865_49219.cljs$core$IIndexed$_nth$arity$2(null,i__48867_49221);\nmetabase.lib.hierarchy.derive(tag_49222,new cljs.core.Keyword(\"metabase.lib.convert\",\"aggregation-or-expression\",\"metabase.lib.convert/aggregation-or-expression\",1924029672));\n\n\nvar G__49223 = seq__48864_49218;\nvar G__49224 = chunk__48865_49219;\nvar G__49225 = count__48866_49220;\nvar G__49226 = (i__48867_49221 + (1));\nseq__48864_49218 = G__49223;\nchunk__48865_49219 = G__49224;\ncount__48866_49220 = G__49225;\ni__48867_49221 = G__49226;\ncontinue;\n} else {\nvar temp__5804__auto___49227 = cljs.core.seq(seq__48864_49218);\nif(temp__5804__auto___49227){\nvar seq__48864_49228__$1 = temp__5804__auto___49227;\nif(cljs.core.chunked_seq_QMARK_(seq__48864_49228__$1)){\nvar c__5568__auto___49229 = cljs.core.chunk_first(seq__48864_49228__$1);\nvar G__49230 = cljs.core.chunk_rest(seq__48864_49228__$1);\nvar G__49231 = c__5568__auto___49229;\nvar G__49232 = cljs.core.count(c__5568__auto___49229);\nvar G__49233 = (0);\nseq__48864_49218 = G__49230;\nchunk__48865_49219 = G__49231;\ncount__48866_49220 = G__49232;\ni__48867_49221 = G__49233;\ncontinue;\n} else {\nvar tag_49234 = cljs.core.first(seq__48864_49228__$1);\nmetabase.lib.hierarchy.derive(tag_49234,new cljs.core.Keyword(\"metabase.lib.convert\",\"aggregation-or-expression\",\"metabase.lib.convert/aggregation-or-expression\",1924029672));\n\n\nvar G__49235 = cljs.core.next(seq__48864_49228__$1);\nvar G__49236 = null;\nvar G__49237 = (0);\nvar G__49238 = (0);\nseq__48864_49218 = G__49235;\nchunk__48865_49219 = G__49236;\ncount__48866_49220 = G__49237;\ni__48867_49221 = G__49238;\ncontinue;\n}\n} else {\n}\n}\nbreak;\n}\nvar seq__48870_49239 = cljs.core.seq(new cljs.core.PersistentVector(null, 12, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\"count\",\"count\",2139924085),new cljs.core.Keyword(null,\"avg\",\"avg\",197406200),new cljs.core.Keyword(null,\"count-where\",\"count-where\",385407720),new cljs.core.Keyword(null,\"distinct\",\"distinct\",-1788879121),new cljs.core.Keyword(null,\"max\",\"max\",61366548),new cljs.core.Keyword(null,\"median\",\"median\",569566131),new cljs.core.Keyword(null,\"min\",\"min\",444991522),new cljs.core.Keyword(null,\"percentile\",\"percentile\",-601188752),new cljs.core.Keyword(null,\"share\",\"share\",-589433933),new cljs.core.Keyword(null,\"stddev\",\"stddev\",-865474939),new cljs.core.Keyword(null,\"sum\",\"sum\",136986814),new cljs.core.Keyword(null,\"sum-where\",\"sum-where\",2135348428)], null));\nvar chunk__48871_49240 = null;\nvar count__48872_49241 = (0);\nvar i__48873_49242 = (0);\nwhile(true){\nif((i__48873_49242 < count__48872_49241)){\nvar tag_49243 = chunk__48871_49240.cljs$core$IIndexed$_nth$arity$2(null,i__48873_49242);\nmetabase.lib.hierarchy.derive(tag_49243,new cljs.core.Keyword(\"metabase.lib.convert\",\"aggregation\",\"metabase.lib.convert/aggregation\",108290790));\n\n\nvar G__49244 = seq__48870_49239;\nvar G__49245 = chunk__48871_49240;\nvar G__49246 = count__48872_49241;\nvar G__49247 = (i__48873_49242 + (1));\nseq__48870_49239 = G__49244;\nchunk__48871_49240 = G__49245;\ncount__48872_49241 = G__49246;\ni__48873_49242 = G__49247;\ncontinue;\n} else {\nvar temp__5804__auto___49248 = cljs.core.seq(seq__48870_49239);\nif(temp__5804__auto___49248){\nvar seq__48870_49249__$1 = temp__5804__auto___49248;\nif(cljs.core.chunked_seq_QMARK_(seq__48870_49249__$1)){\nvar c__5568__auto___49250 = cljs.core.chunk_first(seq__48870_49249__$1);\nvar G__49251 = cljs.core.chunk_rest(seq__48870_49249__$1);\nvar G__49252 = c__5568__auto___49250;\nvar G__49253 = cljs.core.count(c__5568__auto___49250);\nvar G__49254 = (0);\nseq__48870_49239 = G__49251;\nchunk__48871_49240 = G__49252;\ncount__48872_49241 = G__49253;\ni__48873_49242 = G__49254;\ncontinue;\n} else {\nvar tag_49255 = cljs.core.first(seq__48870_49249__$1);\nmetabase.lib.hierarchy.derive(tag_49255,new cljs.core.Keyword(\"metabase.lib.convert\",\"aggregation\",\"metabase.lib.convert/aggregation\",108290790));\n\n\nvar G__49256 = cljs.core.next(seq__48870_49249__$1);\nvar G__49257 = null;\nvar G__49258 = (0);\nvar G__49259 = (0);\nseq__48870_49239 = G__49256;\nchunk__48871_49240 = G__49257;\ncount__48872_49241 = G__49258;\ni__48873_49242 = G__49259;\ncontinue;\n}\n} else {\n}\n}\nbreak;\n}\nvar seq__48883_49260 = cljs.core.seq(cljs.core.PersistentVector.fromArray([new cljs.core.Keyword(null,\"+\",\"+\",1913524883),new cljs.core.Keyword(null,\"-\",\"-\",-2112348439),new cljs.core.Keyword(null,\"*\",\"*\",-1294732318),new cljs.core.Keyword(null,\"/\",\"/\",1282502798),new cljs.core.Keyword(null,\"case\",\"case\",1143702196),new cljs.core.Keyword(null,\"coalesce\",\"coalesce\",654622029),new cljs.core.Keyword(null,\"abs\",\"abs\",-246026477),new cljs.core.Keyword(null,\"log\",\"log\",-1595516004),new cljs.core.Keyword(null,\"exp\",\"exp\",-261706262),new cljs.core.Keyword(null,\"sqrt\",\"sqrt\",-1270051929),new cljs.core.Keyword(null,\"ceil\",\"ceil\",-1824929952),new cljs.core.Keyword(null,\"floor\",\"floor\",1882041021),new cljs.core.Keyword(null,\"round\",\"round\",2009433328),new cljs.core.Keyword(null,\"power\",\"power\",-937852079),new cljs.core.Keyword(null,\"interval\",\"interval\",1708495417),new cljs.core.Keyword(null,\"relative-datetime\",\"relative-datetime\",1285169278),new cljs.core.Keyword(null,\"time\",\"time\",1385887882),new cljs.core.Keyword(null,\"absolute-datetime\",\"absolute-datetime\",-560340465),new cljs.core.Keyword(null,\"now\",\"now\",-1650525531),new cljs.core.Keyword(null,\"convert-timezone\",\"convert-timezone\",-124803001),new cljs.core.Keyword(null,\"get-week\",\"get-week\",-888059349),new cljs.core.Keyword(null,\"get-year\",\"get-year\",-936011274),new cljs.core.Keyword(null,\"get-month\",\"get-month\",-369374731),new cljs.core.Keyword(null,\"get-day\",\"get-day\",127568857),new cljs.core.Keyword(null,\"get-hour\",\"get-hour\",622714059),new cljs.core.Keyword(null,\"get-minute\",\"get-minute\",1468086343),new cljs.core.Keyword(null,\"get-second\",\"get-second\",-2065946318),new cljs.core.Keyword(null,\"get-quarter\",\"get-quarter\",1327778593),new cljs.core.Keyword(null,\"datetime-add\",\"datetime-add\",209603411),new cljs.core.Keyword(null,\"datetime-subtract\",\"datetime-subtract\",275307697),new cljs.core.Keyword(null,\"concat\",\"concat\",-2108183992),new cljs.core.Keyword(null,\"substring\",\"substring\",1140866276),new cljs.core.Keyword(null,\"replace\",\"replace\",-786587770),new cljs.core.Keyword(null,\"regexextract\",\"regexextract\",689742894),new cljs.core.Keyword(null,\"regex-match-first\",\"regex-match-first\",-657299718),new cljs.core.Keyword(null,\"length\",\"length\",588987862),new cljs.core.Keyword(null,\"trim\",\"trim\",774319767),new cljs.core.Keyword(null,\"ltrim\",\"ltrim\",1654269283),new cljs.core.Keyword(null,\"rtrim\",\"rtrim\",-661336449),new cljs.core.Keyword(null,\"upper\",\"upper\",246243906),new cljs.core.Keyword(null,\"lower\",\"lower\",1120320821)], true));\nvar chunk__48884_49261 = null;\nvar count__48885_49262 = (0);\nvar i__48886_49263 = (0);\nwhile(true){\nif((i__48886_49263 < count__48885_49262)){\nvar tag_49264 = chunk__48884_49261.cljs$core$IIndexed$_nth$arity$2(null,i__48886_49263);\nmetabase.lib.hierarchy.derive(tag_49264,new cljs.core.Keyword(\"metabase.lib.convert\",\"expression\",\"metabase.lib.convert/expression\",1648102782));\n\n\nvar G__49265 = seq__48883_49260;\nvar G__49266 = chunk__48884_49261;\nvar G__49267 = count__48885_49262;\nvar G__49268 = (i__48886_49263 + (1));\nseq__48883_49260 = G__49265;\nchunk__48884_49261 = G__49266;\ncount__48885_49262 = G__49267;\ni__48886_49263 = G__49268;\ncontinue;\n} else {\nvar temp__5804__auto___49269 = cljs.core.seq(seq__48883_49260);\nif(temp__5804__auto___49269){\nvar seq__48883_49270__$1 = temp__5804__auto___49269;\nif(cljs.core.chunked_seq_QMARK_(seq__48883_49270__$1)){\nvar c__5568__auto___49271 = cljs.core.chunk_first(seq__48883_49270__$1);\nvar G__49272 = cljs.core.chunk_rest(seq__48883_49270__$1);\nvar G__49273 = c__5568__auto___49271;\nvar G__49274 = cljs.core.count(c__5568__auto___49271);\nvar G__49275 = (0);\nseq__48883_49260 = G__49272;\nchunk__48884_49261 = G__49273;\ncount__48885_49262 = G__49274;\ni__48886_49263 = G__49275;\ncontinue;\n} else {\nvar tag_49276 = cljs.core.first(seq__48883_49270__$1);\nmetabase.lib.hierarchy.derive(tag_49276,new cljs.core.Keyword(\"metabase.lib.convert\",\"expression\",\"metabase.lib.convert/expression\",1648102782));\n\n\nvar G__49277 = cljs.core.next(seq__48883_49270__$1);\nvar G__49278 = null;\nvar G__49279 = (0);\nvar G__49280 = (0);\nseq__48883_49260 = G__49277;\nchunk__48884_49261 = G__49278;\ncount__48885_49262 = G__49279;\ni__48886_49263 = G__49280;\ncontinue;\n}\n} else {\n}\n}\nbreak;\n}\nmetabase.lib.convert.__GT_legacy_MBQL.cljs$core$IMultiFn$_add_method$arity$3(null,new cljs.core.Keyword(\"metabase.lib.convert\",\"aggregation-or-expression\",\"metabase.lib.convert/aggregation-or-expression\",1924029672),(function (input){\nreturn metabase.lib.convert.aggregation__GT_legacy_MBQL(input);\n}));\nmetabase.lib.convert.stage_metadata__GT_legacy_metadata = (function metabase$lib$convert$stage_metadata__GT_legacy_metadata(stage_metadata){\nreturn cljs.core.into.cljs$core$IFn$_invoke$arity$3(cljs.core.PersistentVector.EMPTY,cljs.core.comp.cljs$core$IFn$_invoke$arity$2(cljs.core.map.cljs$core$IFn$_invoke$arity$1((function (p1__48893_SHARP_){\nreturn cljs.core.update_keys(p1__48893_SHARP_,metabase.util.__GT_snake_case_en);\n})),cljs.core.map.cljs$core$IFn$_invoke$arity$1(metabase.lib.convert.__GT_legacy_MBQL)),new cljs.core.Keyword(null,\"columns\",\"columns\",1998437288).cljs$core$IFn$_invoke$arity$1(stage_metadata));\n});\nmetabase.lib.convert.chain_stages = (function metabase$lib$convert$chain_stages(p__48923){\nvar map__48924 = p__48923;\nvar map__48924__$1 = cljs.core.__destructure_map(map__48924);\nvar stages = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__48924__$1,new cljs.core.Keyword(null,\"stages\",\"stages\",-442109532));\nvar inner_query = cljs.core.first(cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (p__48928,stage){\nvar vec__48931 = p__48928;\nvar inner = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__48931,(0),null);\nvar stage_metadata = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__48931,(1),null);\nreturn new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(function (){var G__48936 = metabase.lib.convert.__GT_legacy_MBQL.cljs$core$IFn$_invoke$arity$1(stage);\nvar G__48936__$1 = (cljs.core.truth_(inner)?cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(G__48936,new cljs.core.Keyword(null,\"source-query\",\"source-query\",198004422),inner):G__48936);\nif(cljs.core.truth_(stage_metadata)){\nreturn cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(G__48936__$1,new cljs.core.Keyword(null,\"source-metadata\",\"source-metadata\",-477816085),metabase.lib.convert.stage_metadata__GT_legacy_metadata(stage_metadata));\n} else {\nreturn G__48936__$1;\n}\n})(),new cljs.core.Keyword(\"lib\",\"stage-metadata\",\"lib/stage-metadata\",1079153610).cljs$core$IFn$_invoke$arity$1(stage)], null);\n}),null,stages));\nvar G__48943 = inner_query;\nif(cljs.core.truth_(new cljs.core.Keyword(null,\"native\",\"native\",-613060878).cljs$core$IFn$_invoke$arity$1(inner_query))){\nreturn clojure.set.rename_keys(G__48943,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\"native\",\"native\",-613060878),new cljs.core.Keyword(null,\"query\",\"query\",-1288509510)], null));\n} else {\nreturn G__48943;\n}\n});\nmetabase.lib.convert.__GT_legacy_MBQL.cljs$core$IMultiFn$_add_method$arity$3(null,new cljs.core.Keyword(\"dispatch-type\",\"map\",\"dispatch-type/map\",-758153422),(function (m){\nreturn cljs.core.into.cljs$core$IFn$_invoke$arity$3(cljs.core.PersistentArrayMap.EMPTY,cljs.core.comp.cljs$core$IFn$_invoke$arity$2(metabase.lib.convert.disqualify.cljs$core$IFn$_invoke$arity$0(),cljs.core.map.cljs$core$IFn$_invoke$arity$1((function (p__48971){\nvar vec__48974 = p__48971;\nvar k = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__48974,(0),null);\nvar v = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__48974,(1),null);\nreturn new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [k,metabase.lib.convert.__GT_legacy_MBQL.cljs$core$IFn$_invoke$arity$1(v)], null);\n}))),m);\n}));\nmetabase.lib.convert.__GT_legacy_MBQL.cljs$core$IMultiFn$_add_method$arity$3(null,new cljs.core.Keyword(null,\"aggregation\",\"aggregation\",1597476696),(function (p__48989){\nvar vec__48992 = p__48989;\nvar _ = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__48992,(0),null);\nvar opts = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__48992,(1),null);\nvar agg_uuid = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__48992,(2),null);\nvar ag = vec__48992;\nif(cljs.core.map_QMARK_(opts)){\nvar opts__$1 = metabase.lib.convert.options__GT_legacy_MBQL(opts);\nvar G__49000 = new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\"aggregation\",\"aggregation\",1597476696),metabase.lib.convert.get_or_throw_BANG_(metabase.lib.convert._STAR_pMBQL_uuid__GT_legacy_index_STAR_,agg_uuid)], null);\nif(cljs.core.truth_(opts__$1)){\nreturn cljs.core.conj.cljs$core$IFn$_invoke$arity$2(G__49000,opts__$1);\n} else {\nreturn G__49000;\n}\n} else {\nreturn ag;\n}\n}));\nmetabase.lib.convert.__GT_legacy_MBQL.cljs$core$IMultiFn$_add_method$arity$3(null,new cljs.core.Keyword(\"dispatch-type\",\"sequential\",\"dispatch-type/sequential\",1056993969),(function (xs){\nreturn cljs.core.mapv.cljs$core$IFn$_invoke$arity$2(metabase.lib.convert.__GT_legacy_MBQL,xs);\n}));\nmetabase.lib.convert.__GT_legacy_MBQL.cljs$core$IMultiFn$_add_method$arity$3(null,new cljs.core.Keyword(null,\"field\",\"field\",-1302436500),(function (p__49014){\nvar vec__49016 = p__49014;\nvar _ = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__49016,(0),null);\nvar opts = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__49016,(1),null);\nvar id = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__49016,(2),null);\nvar vec__49023 = (((((opts == null)) || (cljs.core.map_QMARK_(opts))))?new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [opts,id], null):new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [id,opts], null));\nvar opts__$1 = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__49023,(0),null);\nvar id__$1 = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__49023,(1),null);\nreturn new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\"field\",\"field\",-1302436500),metabase.lib.convert.__GT_legacy_MBQL.cljs$core$IFn$_invoke$arity$1(id__$1),metabase.lib.convert.options__GT_legacy_MBQL(opts__$1)], null);\n}));\nmetabase.lib.convert.__GT_legacy_MBQL.cljs$core$IMultiFn$_add_method$arity$3(null,new cljs.core.Keyword(null,\"value\",\"value\",305978217),(function (p__49038){\nvar vec__49064 = p__49038;\nvar _tag = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__49064,(0),null);\nvar opts = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__49064,(1),null);\nvar value = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__49064,(2),null);\nvar opts__$1 = metabase.lib.convert.options__GT_legacy_MBQL(clojure.set.rename_keys(opts,new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,\"base-type\",\"base-type\",1167971299),new cljs.core.Keyword(null,\"base_type\",\"base_type\",1908272670),new cljs.core.Keyword(null,\"semantic-type\",\"semantic-type\",-310722107),new cljs.core.Keyword(null,\"semantic_type\",\"semantic_type\",272485089),new cljs.core.Keyword(null,\"database-type\",\"database-type\",-426840562),new cljs.core.Keyword(null,\"database_type\",\"database_type\",-54700895)], null)));\nreturn new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\"value\",\"value\",305978217),value,opts__$1], null);\n}));\nmetabase.lib.convert.update_list__GT_legacy_boolean_expression = (function metabase$lib$convert$update_list__GT_legacy_boolean_expression(m,pMBQL_key,legacy_key){\nvar G__49068 = m;\nvar G__49068__$1 = ((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.count(cljs.core.get.cljs$core$IFn$_invoke$arity$2(m,pMBQL_key)),(1)))?medley.core.update_existing.cljs$core$IFn$_invoke$arity$3(G__49068,pMBQL_key,cljs.core.comp.cljs$core$IFn$_invoke$arity$2(metabase.lib.convert.__GT_legacy_MBQL,cljs.core.first)):G__49068);\nvar G__49068__$2 = (((cljs.core.count(cljs.core.get.cljs$core$IFn$_invoke$arity$2(m,pMBQL_key)) > (1)))?medley.core.update_existing.cljs$core$IFn$_invoke$arity$3(G__49068__$1,pMBQL_key,(function (p1__49067_SHARP_){\nreturn cljs.core.into.cljs$core$IFn$_invoke$arity$3(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\"and\",\"and\",-971899817)], null),cljs.core.map.cljs$core$IFn$_invoke$arity$1(metabase.lib.convert.__GT_legacy_MBQL),p1__49067_SHARP_);\n})):G__49068__$1);\nreturn clojure.set.rename_keys(G__49068__$2,cljs.core.PersistentArrayMap.createAsIfByAssoc([pMBQL_key,legacy_key]));\n\n});\nmetabase.lib.convert.__GT_legacy_MBQL.cljs$core$IMultiFn$_add_method$arity$3(null,new cljs.core.Keyword(\"mbql\",\"join\",\"mbql/join\",-709512370),(function (join){\nvar base = (function (){var G__49070 = metabase.lib.convert.disqualify.cljs$core$IFn$_invoke$arity$1(join);\nif(clojure.string.starts_with_QMARK_(new cljs.core.Keyword(null,\"alias\",\"alias\",-2039751630).cljs$core$IFn$_invoke$arity$1(join),metabase.lib.convert.legacy_default_join_alias)){\nreturn cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(G__49070,new cljs.core.Keyword(null,\"alias\",\"alias\",-2039751630));\n} else {\nreturn G__49070;\n}\n})();\nreturn cljs.core.merge.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([cljs.core.update_vals(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$variadic(base,new cljs.core.Keyword(null,\"stages\",\"stages\",-442109532),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\"conditions\",\"conditions\",-1647236270)], 0)),metabase.lib.convert.__GT_legacy_MBQL),metabase.lib.convert.update_list__GT_legacy_boolean_expression(cljs.core.select_keys(base,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,\"conditions\",\"conditions\",-1647236270)], null)),new cljs.core.Keyword(null,\"conditions\",\"conditions\",-1647236270),new cljs.core.Keyword(null,\"condition\",\"condition\",1668437652)),metabase.lib.convert.chain_stages(base)], 0));\n}));\n/**\n * If a pMBQL query stage has `:source-card` convert it to legacy-style `:source-table \"card__<id>\"`.\n */\nmetabase.lib.convert.source_card__GT_legacy_source_table = (function metabase$lib$convert$source_card__GT_legacy_source_table(stage){\nvar temp__5802__auto__ = new cljs.core.Keyword(null,\"source-card\",\"source-card\",-1580820390).cljs$core$IFn$_invoke$arity$1(stage);\nif(cljs.core.truth_(temp__5802__auto__)){\nvar source_card_id = temp__5802__auto__;\nreturn cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$2(stage,new cljs.core.Keyword(null,\"source-card\",\"source-card\",-1580820390)),new cljs.core.Keyword(null,\"source-table\",\"source-table\",-225307692),[\"card__\",cljs.core.str.cljs$core$IFn$_invoke$arity$1(source_card_id)].join(''));\n} else {\nreturn stage;\n}\n});\nmetabase.lib.convert.__GT_legacy_MBQL.cljs$core$IMultiFn$_add_method$arity$3(null,new cljs.core.Keyword(\"mbql.stage\",\"mbql\",\"mbql.stage/mbql\",1578747798),(function (stage){\nvar _STAR_pMBQL_uuid__GT_legacy_index_STAR__orig_val__49107 = metabase.lib.convert._STAR_pMBQL_uuid__GT_legacy_index_STAR_;\nvar _STAR_pMBQL_uuid__GT_legacy_index_STAR__temp_val__49108 = cljs.core.into.cljs$core$IFn$_invoke$arity$3(cljs.core.PersistentArrayMap.EMPTY,cljs.core.map_indexed.cljs$core$IFn$_invoke$arity$1((function (idx,p__49118){\nvar vec__49125 = p__49118;\nvar _tag = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__49125,(0),null);\nvar map__49128 = cljs.core.nth.cljs$core$IFn$_invoke$arity$3(vec__49125,(1),null);\nvar map__49128__$1 = cljs.core.__destructure_map(map__49128);\nvar ag_uuid = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__49128__$1,new cljs.core.Keyword(\"lib\",\"uuid\",\"lib/uuid\",-2145250720));\nreturn new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [ag_uuid,idx], null);\n})),new cljs.core.Keyword(null,\"aggregation\",\"aggregation\",1597476696).cljs$core$IFn$_invoke$arity$1(stage));\n(metabase.lib.convert._STAR_pMBQL_uuid__GT_legacy_index_STAR_ = _STAR_pMBQL_uuid__GT_legacy_index_STAR__temp_val__49108);\n\ntry{return cljs.core.reduce.cljs$core$IFn$_invoke$arity$3((function (p1__49102_SHARP_,p2__49103_SHARP_){\nreturn medley.core.update_existing.cljs$core$IFn$_invoke$arity$3(p1__49102_SHARP_,p2__49103_SHARP_,metabase.lib.convert.__GT_legacy_MBQL);\n}),metabase.lib.convert.update_list__GT_legacy_boolean_expression(medley.core.update_existing.cljs$core$IFn$_invoke$arity$3(medley.core.update_existing.cljs$core$IFn$_invoke$arity$3(metabase.lib.convert.source_card__GT_legacy_source_table(metabase.lib.convert.disqualify.cljs$core$IFn$_invoke$arity$1(stage)),new cljs.core.Keyword(null,\"aggregation\",\"aggregation\",1597476696),(function (p1__49104_SHARP_){\nreturn cljs.core.mapv.cljs$core$IFn$_invoke$arity$2(metabase.lib.convert.aggregation__GT_legacy_MBQL,p1__49104_SHARP_);\n})),new cljs.core.Keyword(null,\"expressions\",\"expressions\",255689909),(function (expressions){\nreturn cljs.core.into.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,(function (){var iter__5523__auto__ = (function metabase$lib$convert$iter__49144(s__49145){\nreturn (new cljs.core.LazySeq(null,(function (){\nvar s__49145__$1 = s__49145;\nwhile(true){\nvar temp__5804__auto__ = cljs.core.seq(s__49145__$1);\nif(temp__5804__auto__){\nvar s__49145__$2 = temp__5804__auto__;\nif(cljs.core.chunked_seq_QMARK_(s__49145__$2)){\nvar c__5521__auto__ = cljs.core.chunk_first(s__49145__$2);\nvar size__5522__auto__ = cljs.core.count(c__5521__auto__);\nvar b__49147 = cljs.core.chunk_buffer(size__5522__auto__);\nif((function (){var i__49146 = (0);\nwhile(true){\nif((i__49146 < size__5522__auto__)){\nvar expression = cljs.core._nth(c__5521__auto__,i__49146);\nvar legacy_clause = metabase.lib.convert.__GT_legacy_MBQL.cljs$core$IFn$_invoke$arity$1(expression);\ncljs.core.chunk_append(b__49147,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [metabase.lib.util.expression_name(expression),((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\"value\",\"value\",305978217),cljs.core.first(legacy_clause)))?cljs.core.second(legacy_clause):legacy_clause)], null));\n\nvar G__49322 = (i__49146 + (1));\ni__49146 = G__49322;\ncontinue;\n} else {\nreturn true;\n}\nbreak;\n}\n})()){\nreturn cljs.core.chunk_cons(cljs.core.chunk(b__49147),metabase$lib$convert$iter__49144(cljs.core.chunk_rest(s__49145__$2)));\n} else {\nreturn cljs.core.chunk_cons(cljs.core.chunk(b__49147),null);\n}\n} else {\nvar expression = cljs.core.first(s__49145__$2);\nvar legacy_clause = metabase.lib.convert.__GT_legacy_MBQL.cljs$core$IFn$_invoke$arity$1(expression);\nreturn cljs.core.cons(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [metabase.lib.util.expression_name(expression),((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,\"value\",\"value\",305978217),cljs.core.first(legacy_clause)))?cljs.core.second(legacy_clause):legacy_clause)], null),metabase$lib$convert$iter__49144(cljs.core.rest(s__49145__$2)));\n}\n} else {\nreturn null;\n}\nbreak;\n}\n}),null,null));\n});\nreturn iter__5523__auto__(expressions);\n})());\n})),new cljs.core.Keyword(null,\"filters\",\"filters\",974726919),new cljs.core.Keyword(null,\"filter\",\"filter\",-948537934)),cljs.core.disj.cljs$core$IFn$_invoke$arity$variadic(metabase.lib.convert.stage_keys,new cljs.core.Keyword(null,\"aggregation\",\"aggregation\",1597476696),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\"filters\",\"filters\",974726919),new cljs.core.Keyword(null,\"expressions\",\"expressions\",255689909)], 0)));\n}finally {(metabase.lib.convert._STAR_pMBQL_uuid__GT_legacy_index_STAR_ = _STAR_pMBQL_uuid__GT_legacy_index_STAR__orig_val__49107);\n}}));\nmetabase.lib.convert.__GT_legacy_MBQL.cljs$core$IMultiFn$_add_method$arity$3(null,new cljs.core.Keyword(\"mbql.stage\",\"native\",\"mbql.stage/native\",359422194),(function (stage){\nreturn cljs.core.update_vals(metabase.lib.convert.disqualify.cljs$core$IFn$_invoke$arity$1(stage),metabase.lib.convert.__GT_legacy_MBQL);\n}));\nmetabase.lib.convert.__GT_legacy_MBQL.cljs$core$IMultiFn$_add_method$arity$3(null,new cljs.core.Keyword(\"mbql\",\"query\",\"mbql/query\",-1285688662),(function (query){\nvar base = metabase.lib.convert.disqualify.cljs$core$IFn$_invoke$arity$1(query);\nvar parameters = new cljs.core.Keyword(null,\"parameters\",\"parameters\",-1229919748).cljs$core$IFn$_invoke$arity$1(base);\nvar inner_query = metabase.lib.convert.chain_stages(base);\nvar query_type = ((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(\"lib\",\"type\",\"lib/type\",1175424801).cljs$core$IFn$_invoke$arity$1(cljs.core.last(new cljs.core.Keyword(null,\"stages\",\"stages\",-442109532).cljs$core$IFn$_invoke$arity$1(query))),new cljs.core.Keyword(\"mbql.stage\",\"native\",\"mbql.stage/native\",359422194)))?new cljs.core.Keyword(null,\"native\",\"native\",-613060878):new cljs.core.Keyword(null,\"query\",\"query\",-1288509510));\nreturn cljs.core.merge.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([cljs.core.update_vals(cljs.core.dissoc.cljs$core$IFn$_invoke$arity$variadic(base,new cljs.core.Keyword(null,\"stages\",\"stages\",-442109532),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,\"parameters\",\"parameters\",-1229919748)], 0)),metabase.lib.convert.__GT_legacy_MBQL),(function (){var G__49165 = cljs.core.PersistentArrayMap.createAsIfByAssoc([new cljs.core.Keyword(null,\"type\",\"type\",1174270348),query_type,query_type,inner_query]);\nif(cljs.core.seq(parameters)){\nreturn cljs.core.assoc.cljs$core$IFn$_invoke$arity$3(G__49165,new cljs.core.Keyword(null,\"parameters\",\"parameters\",-1229919748),parameters);\n} else {\nreturn G__49165;\n}\n})()], 0));\n}));\n","~:ns-info",["^ ","~:rename-macros",null,"~:renames",["^ "],"~:meta",["^ ","~:file","metabase/lib/convert.cljc","~:line",1,"~:column",5,"~:end-line",1,"~:end-column",25],"~:ns-aliases",["^ ","~$cljs.loader","~$shadow.loader","~$clojure.core","~$cljs.core","~$clojure.spec.gen.alpha","~$cljs.spec.gen.alpha","~$clojure.pprint","~$cljs.pprint","~$clojure.core.match","~$cljs.core.match"],"~:use-macros",null,"~:excludes",["~#set",[]],"~:name","~$metabase.lib.convert","~:reader-aliases",["^ "],"~:op","~:ns","~:imports",null,"~:requires",["^ ","~$metabase.lib.schema","^P","~$set","~$clojure.set","~$mc","~$malli.core","~$me","~$malli.error","~$log","~$metabase.util.log","~$data","~$clojure.data","~$u","~$metabase.util","^V","^V","~$lib.schema.expression","~$metabase.lib.schema.expression","^?","^?","~$metabase.lib.util","^12","~$goog","^13","~$lib.schema","^P","~$lib.options","~$metabase.lib.options","^T","^T","^11","^11","~$lib.hierarchy","~$metabase.lib.hierarchy","^R","^R","~$m","~$medley.core","^[","^[","~$lib.util","^12","~$lib.dispatch","~$metabase.lib.dispatch","^X","^X","~$str","~$clojure.string","^18","^18","^16","^16","^1>","^1>","^Z","^Z","^1<","^1<","^19","^19"],"~:seen",["^H",["~:require"]],"~:uses",null,"~:require-macros",["^ ","^S","^T","^W","^X","~$u","^[","^10","^11","^?","^?","^T","^T","^11","^11","^[","^[","^X","^X"],"~:form",["~#list",["~$ns","^J",["^1D",["^1@",["^Z","~:as","^Y"],["^R","^1F","^Q"],["^1>","^1F","^1="],["^T","^1F","^S"],["^V","^1F","^U"],["^19","^1F","~$m"],["^1<","^1F","^1;"],["^18","^1F","^17"],["^16","^1F","^15"],["^P","^1F","^14"],["^11","^1F","^10"],["^12","^1F","^1:"],["^[","^1F","~$u"],["^X","^1F","^W"]]]]],"~:flags",["^ ","^1@",["^H",[]]],"~:js-deps",["^ "],"~:deps",["^13","^?","^Z","^R","^1>","^T","^V","^19","^1<","^18","^16","^P","^11","^12","^[","^X"]],"^M","^J","~:resource-id",["~:shadow.build.classpath/resource","metabase/lib/convert.cljc"],"~:compiled-at",1692612528874,"^K",["^ ","^P","^P","^Q","^R","^S","^T","^U","^V","^W","^X","^Y","^Z","~$u","^[","^V","^V","^10","^11","^?","^?","^12","^12","^13","^13","^14","^P","^15","^16","^T","^T","^11","^11","^17","^18","^R","^R","~$m","^19","^[","^[","^1:","^12","^1;","^1<","^X","^X","^1=","^1>","^18","^18","^16","^16","^1>","^1>","^Z","^Z","^1<","^1<","^19","^19"],"~:resource-name","metabase/lib/convert.cljc","~:warnings",[],"~:source","(ns metabase.lib.convert\n  (:require\n   [clojure.data :as data]\n   [clojure.set :as set]\n   [clojure.string :as str]\n   [malli.core :as mc]\n   [malli.error :as me]\n   [medley.core :as m]\n   [metabase.lib.dispatch :as lib.dispatch]\n   [metabase.lib.hierarchy :as lib.hierarchy]\n   [metabase.lib.options :as lib.options]\n   [metabase.lib.schema :as lib.schema]\n   [metabase.lib.schema.expression :as lib.schema.expression]\n   [metabase.lib.util :as lib.util]\n   [metabase.util :as u]\n   [metabase.util.log :as log]))\n\n(def ^:private ^:dynamic *pMBQL-uuid->legacy-index*\n  {})\n\n(def ^:private ^:dynamic *legacy-index->pMBQL-uuid*\n  {})\n\n(defn- clean-location [almost-stage error-type error-location]\n  (let [operate-on-parent? #{:malli.core/missing-key :malli.core/end-of-input}\n        location (if (operate-on-parent? error-type)\n                   (drop-last 2 error-location)\n                   (drop-last 1 error-location))\n        [location-key] (if (operate-on-parent? error-type)\n                         (take-last 2 error-location)\n                         (take-last 1 error-location))]\n    (if (seq location)\n      (update-in almost-stage\n                 location\n                 (fn [error-loc]\n                   (let [result (assoc error-loc location-key nil)]\n                     (cond\n                       (vector? error-loc) (into [] (remove nil?) result)\n                       (map? error-loc) (u/remove-nils result)\n                       :else result))))\n      (dissoc almost-stage location-key))))\n\n(def ^:private stage-keys\n  #{:aggregation :breakout :expressions :fields :filters :order-by :joins})\n\n(defn- clean-stage [almost-stage]\n  (loop [almost-stage almost-stage\n         removals []]\n    (if-let [[error-type error-location] (->> (mc/explain ::lib.schema/stage.mbql almost-stage)\n                                              :errors\n                                              (filter (comp stage-keys first :in))\n                                              (map (juxt :type :in))\n                                              first)]\n      (let [new-stage (clean-location almost-stage error-type error-location)]\n        (log/warnf \"Clean: Removing bad clause in %s due to error %s:\\n%s\"\n                   (u/colorize :yellow (pr-str error-location))\n                   (u/colorize :yellow (pr-str (or error-type\n                                                   ;; if `error-type` is missing, which seems to happen sometimes,\n                                                   ;; fall back to humanizing the entire error.\n                                                   (me/humanize (mc/explain ::lib.schema/stage.mbql almost-stage)))))\n                   (u/colorize :red (u/pprint-to-str (first (data/diff almost-stage new-stage)))))\n        (if (= new-stage almost-stage)\n          almost-stage\n          (recur new-stage (conj removals [error-type error-location]))))\n      almost-stage)))\n\n(defn- clean [almost-query]\n  (loop [almost-query almost-query\n         stage-index 0]\n    (let [current-stage (nth (:stages almost-query) stage-index)\n          new-stage (clean-stage current-stage)]\n      (if (= current-stage new-stage)\n        (if (= stage-index (dec (count (:stages almost-query))))\n          almost-query\n          (recur almost-query (inc stage-index)))\n        (recur (update almost-query :stages assoc stage-index new-stage) stage-index)))))\n\n(defmulti ->pMBQL\n  \"Coerce something to pMBQL (the version of MBQL manipulated by Dashboard Lib v2) if it's not already pMBQL.\"\n  {:arglists '([x])}\n  lib.dispatch/dispatch-value\n  :hierarchy lib.hierarchy/hierarchy)\n\n(defn- default-MBQL-clause->pMBQL [mbql-clause]\n  (let [last-elem (peek mbql-clause)\n        last-elem-option? (map? last-elem)\n        [clause-type & args] (cond-> mbql-clause\n                               last-elem-option? pop)\n        options (if last-elem-option?\n                  last-elem\n                  {})]\n    (lib.options/ensure-uuid (into [clause-type options] (map ->pMBQL) args))))\n\n(defmethod ->pMBQL :default\n  [x]\n  (if (and (vector? x)\n           (keyword? (first x)))\n    (default-MBQL-clause->pMBQL x)\n    x))\n\n(defmethod ->pMBQL :mbql/query\n  [query]\n  query)\n\n(def legacy-default-join-alias\n  \"In legacy MBQL, join `:alias` was optional, and if unspecified, this was the default alias used. In reality all joins\n  normally had an explicit `:alias` since the QB would generate one and you generally need one to do useful things\n  with the join anyway.\n\n  Since the new pMBQL schema makes `:alias` required, we'll explicitly add the implicit default when we encounter a\n  join without an alias, and remove it so we can round-trip without changes.\"\n  \"__join\")\n\n(defn- deduplicate-join-aliases\n  \"Join `:alias`es had to be unique in legacy MBQL, but they were optional. Since we add [[legacy-default-join-alias]]\n  to each join that doesn't have an explicit `:alias` for pMBQL compatibility now, we need to deduplicate the aliases\n  if it is used more than once.\n\n  Only deduplicate the default `__join` aliases; we don't want the [[lib.util/unique-name-generator]] to touch other\n  aliases and truncate them or anything like that.\"\n  [joins]\n  (let [unique-name-fn (lib.util/unique-name-generator)]\n    (mapv (fn [join]\n            (cond-> join\n              (= (:alias join) legacy-default-join-alias) (update :alias unique-name-fn)))\n          joins)))\n\n(defn- stage-source-card-id->pMBQL\n  \"If a query `stage` has a legacy `card__<id>` `:source-table`, convert it to a pMBQL-style `:source-card`.\"\n  [stage]\n  (if (string? (:source-table stage))\n    (-> stage\n        (assoc :source-card (lib.util/legacy-string-table-id->card-id (:source-table stage)))\n        (dissoc :source-table))\n    stage))\n\n(defmethod ->pMBQL :mbql.stage/mbql\n  [stage]\n  (let [aggregations (->pMBQL (:aggregation stage))\n        expressions  (->> stage\n                          :expressions\n                          (mapv (fn [[k v]]\n                                  (-> v\n                                      ->pMBQL\n                                      (lib.util/named-expression-clause k))))\n                          not-empty)]\n    (binding [*legacy-index->pMBQL-uuid* (into {}\n                                               (map-indexed (fn [idx [_tag {ag-uuid :lib/uuid}]]\n                                                              [idx ag-uuid]))\n                                               aggregations)]\n      (let [stage (-> stage\n                      stage-source-card-id->pMBQL\n                      (m/assoc-some :aggregation aggregations :expressions expressions))\n            stage (reduce\n                   (fn [stage k]\n                     (if-not (get stage k)\n                       stage\n                       (update stage k ->pMBQL)))\n                   stage\n                   (disj stage-keys :aggregation :expressions))]\n        (cond-> stage\n          (:joins stage) (update :joins deduplicate-join-aliases))))))\n\n(defmethod ->pMBQL :mbql.stage/native\n  [stage]\n  (m/update-existing stage :template-tags update-vals (fn [tag] (m/update-existing tag :dimension ->pMBQL))))\n\n(defmethod ->pMBQL :mbql/join\n  [join]\n  (let [join (-> join\n                 (update :conditions ->pMBQL)\n                 (update :stages ->pMBQL))]\n    (cond-> join\n      (:fields join) (update :fields (fn [fields]\n                                       (if (seqable? fields)\n                                         (mapv ->pMBQL fields)\n                                         (keyword fields))))\n      (not (:alias join)) (assoc :alias legacy-default-join-alias))))\n\n(defmethod ->pMBQL :dispatch-type/sequential\n  [xs]\n  (mapv ->pMBQL xs))\n\n(defmethod ->pMBQL :dispatch-type/map\n  [m]\n  (if (:type m)\n    (-> (lib.util/pipeline m)\n        (update :stages (fn [stages]\n                          (mapv ->pMBQL stages)))\n        clean)\n    (update-vals m ->pMBQL)))\n\n(defmethod ->pMBQL :field\n  [[_tag x y]]\n  (let [[id-or-name options] (if (map? x)\n                               [y x]\n                               [x y])]\n    (lib.options/ensure-uuid [:field options id-or-name])))\n\n(defmethod ->pMBQL :value\n  [[_tag value opts]]\n  ;; `:value` uses `:snake_case` keys in legacy MBQL for some insane reason (actually this was to match the shape of\n  ;; the keys in Field metadata), at least for the three type keys enumerated below.\n  ;; See [[metabase.mbql.schema/ValueTypeInfo]].\n  (let [opts (set/rename-keys opts {:base_type     :base-type\n                                    :semantic_type :semantic-type\n                                    :database_type :database-type})\n        ;; in pMBQL, `:effective-type` is a required key for `:value`. `:value` SHOULD have always had `:base-type`,\n        ;; but on the off chance it did not, get the type from value so the schema doesn't fail entirely.\n        opts (assoc opts :effective-type (or (:effective-type opts)\n                                             (:base-type opts)\n                                             (lib.schema.expression/type-of value)))]\n    (lib.options/ensure-uuid [:value opts value])))\n\n(defmethod ->pMBQL :case\n  [[_tag pred-expr-pairs options]]\n  (let [default (:default options)]\n    (cond-> [:case (dissoc options :default) (mapv ->pMBQL pred-expr-pairs)]\n      :always lib.options/ensure-uuid\n      (some? default) (conj (->pMBQL default)))))\n\n(defmethod ->pMBQL :expression\n  [[tag value opts]]\n  (lib.options/ensure-uuid [tag opts value]))\n\n(defn- get-or-throw!\n  [m k]\n  (let [result (get m k ::not-found)]\n    (if-not (= result ::not-found)\n      result\n      (throw (ex-info (str \"Unable to find \" (pr-str k) \" in map.\")\n                      {:m m\n                       :k k})))))\n\n(defmethod ->pMBQL :aggregation\n  [[tag value opts]]\n  (lib.options/ensure-uuid [tag opts (get-or-throw! *legacy-index->pMBQL-uuid* value)]))\n\n(defmethod ->pMBQL :aggregation-options\n  [[_tag aggregation options]]\n  (let [[tag opts & args] (->pMBQL aggregation)]\n    (into [tag (merge opts options)] args)))\n\n(defn legacy-query-from-inner-query\n  \"Convert a legacy 'inner query' to a full legacy 'outer query' so you can pass it to stuff\n  like [[metabase.mbql.normalize/normalize]], and then probably to [[->pMBQL]].\"\n  [database-id inner-query]\n  (merge {:database database-id, :type :query}\n         (if (:native inner-query)\n           {:native (set/rename-keys inner-query {:native :query})}\n           {:query inner-query})))\n\n(defmulti ->legacy-MBQL\n  \"Coerce something to legacy MBQL (the version of MBQL understood by the query processor and Dashboard Lib v1) if it's\n  not already legacy MBQL.\"\n  {:arglists '([x])}\n  lib.dispatch/dispatch-value\n  :hierarchy lib.hierarchy/hierarchy)\n\n(defn- disqualify\n  \"Remove any keys starting with the `:lib/` namespace from map `m`.\n\n  No args = return transducer to remove `:lib/` keys from a map. One arg = update a map `m`.\"\n  ([]\n   (remove (fn [[k _v]]\n             (and (qualified-keyword? k)\n                  (= (namespace k) \"lib\")))))\n  ([m]\n   (into {} (disqualify) m)))\n\n(defn- options->legacy-MBQL\n  \"Convert an options map in an MBQL clause to the equivalent shape for legacy MBQL. Remove `:lib/*` keys and\n  `:effective-type`, which is not used in options maps in legacy MBQL.\"\n  [m]\n  (not-empty\n   (into {}\n         (comp (disqualify)\n               (remove (fn [[k _v]]\n                         (= k :effective-type))))\n         m)))\n\n(defn- aggregation->legacy-MBQL [[tag options & args]]\n  (let [inner (into [tag] (map ->legacy-MBQL) args)\n        ;; the default value of the :case expression is in the options\n        ;; in legacy MBQL\n        inner (if (and (= tag :case) (next args))\n                (conj (pop inner) {:default (peek inner)})\n                inner)]\n    (if-let [aggregation-opts (not-empty (options->legacy-MBQL options))]\n      [:aggregation-options inner aggregation-opts]\n      inner)))\n\n(defn- clause-with-options->legacy-MBQL [[k options & args]]\n  (if (map? options)\n    (into [k] (concat (map ->legacy-MBQL args)\n                      (when-let [options (options->legacy-MBQL options)]\n                        [options])))\n    (into [k] (map ->legacy-MBQL (cons options args)))))\n\n(defmethod ->legacy-MBQL :default\n  [x]\n  (cond\n    (and (vector? x)\n         (keyword? (first x))) (clause-with-options->legacy-MBQL x)\n    (map? x)                   (-> x\n                                   disqualify\n                                   (update-vals ->legacy-MBQL))\n    :else x))\n\n(doseq [tag [::aggregation ::expression]]\n  (lib.hierarchy/derive tag ::aggregation-or-expression))\n\n(doseq [tag [:count :avg :count-where :distinct\n             :max :median :min :percentile\n             :share :stddev :sum :sum-where]]\n  (lib.hierarchy/derive tag ::aggregation))\n\n(doseq [tag [:+ :- :* :/\n             :case :coalesce\n             :abs :log :exp :sqrt :ceil :floor :round :power :interval\n             :relative-datetime :time :absolute-datetime :now :convert-timezone\n             :get-week :get-year :get-month :get-day :get-hour\n             :get-minute :get-second :get-quarter\n             :datetime-add :datetime-subtract\n             :concat :substring :replace :regexextract :regex-match-first\n             :length :trim :ltrim :rtrim :upper :lower]]\n  (lib.hierarchy/derive tag ::expression))\n\n(defmethod ->legacy-MBQL ::aggregation-or-expression\n  [input]\n  (aggregation->legacy-MBQL input))\n\n(defn- stage-metadata->legacy-metadata [stage-metadata]\n  (into []\n        (comp (map #(update-keys % u/->snake_case_en))\n              (map ->legacy-MBQL))\n        (:columns stage-metadata)))\n\n(defn- chain-stages [{:keys [stages]}]\n  ;; :source-metadata aka :lib/stage-metadata is handled differently in the two formats.\n  ;; In legacy, an inner query might have both :source-query, and :source-metadata giving the metadata for that nested\n  ;; :source-query.\n  ;; In pMBQL, the :lib/stage-metadata is attached to the same stage it applies to.\n  ;; So when chaining pMBQL stages back into legacy form, if stage n has :lib/stage-metadata, stage n+1 needs\n  ;; :source-metadata attached.\n  (let [inner-query (first (reduce (fn [[inner stage-metadata] stage]\n                                     [(cond-> (->legacy-MBQL stage)\n                                        inner          (assoc :source-query inner)\n                                        stage-metadata (assoc :source-metadata (stage-metadata->legacy-metadata stage-metadata)))\n                                      ;; Get the :lib/stage-metadata off the original pMBQL stage, not the converted one.\n                                      (:lib/stage-metadata stage)])\n                                   nil\n                                   stages))]\n    (cond-> inner-query\n      ;; If this is a native query, inner query will be used like: `{:type :native :native #_inner-query {:query ...}}`\n      (:native inner-query) (set/rename-keys {:native :query}))))\n\n(defmethod ->legacy-MBQL :dispatch-type/map [m]\n  (into {}\n        (comp (disqualify)\n              (map (fn [[k v]]\n                     [k (->legacy-MBQL v)])))\n        m))\n\n(defmethod ->legacy-MBQL :aggregation [[_ opts agg-uuid :as ag]]\n  (if (map? opts)\n    (let [opts (options->legacy-MBQL opts)]\n      (cond-> [:aggregation (get-or-throw! *pMBQL-uuid->legacy-index* agg-uuid)]\n        opts (conj opts)))\n    ;; Our conversion is a bit too aggressive and we're hitting legacy refs like [:aggregation 0] inside source_metadata that are only used for legacy and thus can be ignored\n    ag))\n\n(defmethod ->legacy-MBQL :dispatch-type/sequential [xs]\n  (mapv ->legacy-MBQL xs))\n\n(defmethod ->legacy-MBQL :field [[_ opts id]]\n  ;; Fields are not like the normal clauses - they need that options field even if it's null.\n  ;; TODO: Sometimes the given field is in the legacy order - that seems wrong.\n  (let [[opts id] (if (or (nil? opts) (map? opts))\n                    [opts id]\n                    [id opts])]\n    [:field\n     (->legacy-MBQL id)\n     (options->legacy-MBQL opts)]))\n\n(defmethod ->legacy-MBQL :value\n  [[_tag opts value]]\n  (let [opts (-> opts\n                 ;; as mentioned above, `:value` in legacy MBQL expects `snake_case` keys for type info keys.\n                 (set/rename-keys  {:base-type     :base_type\n                                    :semantic-type :semantic_type\n                                    :database-type :database_type})\n                 options->legacy-MBQL)]\n    ;; in legacy MBQL, `:value` has to be three args; `opts` has to be present, but it should can be `nil` if it is\n    ;; empty.\n    [:value value opts]))\n\n(defn- update-list->legacy-boolean-expression\n  [m pMBQL-key legacy-key]\n  (cond-> m\n    (= (count (get m pMBQL-key)) 1) (m/update-existing pMBQL-key (comp ->legacy-MBQL first))\n    (> (count (get m pMBQL-key)) 1) (m/update-existing pMBQL-key #(into [:and] (map ->legacy-MBQL) %))\n    :always (set/rename-keys {pMBQL-key legacy-key})))\n\n(defmethod ->legacy-MBQL :mbql/join [join]\n  (let [base (cond-> (disqualify join)\n               (str/starts-with? (:alias join) legacy-default-join-alias) (dissoc :alias))]\n    (merge (-> base\n               (dissoc :stages :conditions)\n               (update-vals ->legacy-MBQL))\n           (-> base\n               (select-keys [:conditions])\n               (update-list->legacy-boolean-expression :conditions :condition))\n           (chain-stages base))))\n\n(defn- source-card->legacy-source-table\n  \"If a pMBQL query stage has `:source-card` convert it to legacy-style `:source-table \\\"card__<id>\\\"`.\"\n  [stage]\n  (if-let [source-card-id (:source-card stage)]\n    (-> stage\n        (dissoc :source-card)\n        (assoc :source-table (str \"card__\" source-card-id)))\n    stage))\n\n(defmethod ->legacy-MBQL :mbql.stage/mbql\n  [stage]\n  (binding [*pMBQL-uuid->legacy-index* (into {}\n                                             (map-indexed (fn [idx [_tag {ag-uuid :lib/uuid}]]\n                                                            [ag-uuid idx]))\n                                             (:aggregation stage))]\n    (reduce #(m/update-existing %1 %2 ->legacy-MBQL)\n            (-> stage\n                disqualify\n                source-card->legacy-source-table\n                (m/update-existing :aggregation #(mapv aggregation->legacy-MBQL %))\n                (m/update-existing :expressions (fn [expressions]\n                                                  (into {}\n                                                        (for [expression expressions\n                                                              :let [legacy-clause (->legacy-MBQL expression)]]\n                                                          [(lib.util/expression-name expression)\n                                                           ;; We wrap literals in :value ->pMBQL\n                                                           ;; so unwrap this direction\n                                                           (if (= :value (first legacy-clause))\n                                                             (second legacy-clause)\n                                                             legacy-clause)]))))\n                (update-list->legacy-boolean-expression :filters :filter))\n            (disj stage-keys :aggregation :filters :expressions))))\n\n(defmethod ->legacy-MBQL :mbql.stage/native [stage]\n  (-> stage\n      disqualify\n      (update-vals ->legacy-MBQL)))\n\n(defmethod ->legacy-MBQL :mbql/query [query]\n  (let [base        (disqualify query)\n        parameters  (:parameters base)\n        inner-query (chain-stages base)\n        query-type  (if (-> query :stages last :lib/type (= :mbql.stage/native))\n                      :native\n                      :query)]\n    (merge (-> base\n               (dissoc :stages :parameters)\n               (update-vals ->legacy-MBQL))\n           (cond-> {:type query-type query-type inner-query}\n             (seq parameters) (assoc :parameters parameters)))))\n","~:reader-features",["^H",["~:cljs-release","~:cljs"]],"~:cljc",true,"~:source-map-compact",["^ ","mappings","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","names",["metabase.lib.convert/*pMBQL-uuid->legacy-index*","metabase.lib.convert/*legacy-index->pMBQL-uuid*","metabase.lib.convert/clean-location","almost-stage","error-type","error-location","vec__48675","cljs.core.nth","operate-on-parent?","location","cljs.core.drop_last","location-key","cljs.core/take-last","cljs.core/seq","cljs.core.update_in","error-loc","result","cljs.core.assoc","cljs.core/vector?","cljs.core.into","cljs.core.remove","cljs.core/nil?","cljs.core/map?","metabase.util/remove-nils","cljs.core.dissoc","metabase.lib.convert/stage-keys","metabase.lib.convert/clean-stage","removals","temp__5802__auto__","vec__48685","malli.core.explain","cljs.core.filter","cljs.core.comp","cljs.core/first","cljs.core.map","cljs.core.juxt","new-stage","level__30248__auto__","metabase.util.log/glogi-level","logger__30249__auto__","metabase.util.log/is-loggable?","x__30250__auto__","js/Error","lambdaisland.glogi.log","metabase.util.log.format_msg","metabase.util.colorize","cljs.core.pr_str","or__5045__auto__","malli.error.humanize","metabase.util.pprint_to_str","clojure.data/diff","cljs.core._EQ_","cljs.core.conj","metabase.lib.convert/clean","almost-query","stage-index","current-stage","cljs.core/count","cljs.core.update","cljs.core/assoc","method-table__5642__auto__","cljs.core.atom","prefer-table__5643__auto__","method-cache__5644__auto__","cached-hierarchy__5645__auto__","hierarchy__5646__auto__","cljs.core.get","fexpr__48702","cljs.core/MultiFn","cljs.core.symbol","metabase.lib.convert/->pMBQL","metabase.lib.dispatch/dispatch-value","metabase.lib.hierarchy/hierarchy","metabase.lib.convert/default-MBQL-clause->pMBQL","mbql-clause","vec__48704","seq__48705","first__48706","cljs.core/next","last-elem","cljs.core/peek","last-elem-option?","clause-type","args","G__48709","cljs.core/pop","options","metabase.lib.options/ensure-uuid","x","cljs.core/Keyword","query","metabase.lib.convert/legacy-default-join-alias","metabase.lib.convert/deduplicate-join-aliases","joins","unique-name-fn","metabase.lib.util/unique-name-generator","cljs.core.mapv","join","G__48745","metabase.lib.convert/stage-source-card-id->pMBQL","stage","metabase.lib.util/legacy-string-table-id->card-id","aggregations","expressions","p__48747","vec__48749","k","v","metabase.lib.util/named-expression-clause","cljs.core/not-empty","*legacy-index->pMBQL-uuid*-orig-val__48752","*legacy-index->pMBQL-uuid*-temp-val__48753","cljs.core.map_indexed","p__48757","vec__48758","map__48761","cljs.core/--destructure-map","idx","_tag","ag-uuid","medley.core.assoc_some","cljs.core.reduce","cljs.core/not","cljs.core.disj","G__48763","medley.core.update_existing","cljs.core/update-vals","tag","G__48764","fields","cljs.core/seqable?","cljs.core.keyword","xs","m","metabase.lib.util/pipeline","stages","p__48775","vec__48776","y","vec__48779","id-or-name","p__48783","vec__48785","value","opts","clojure.set/rename-keys","metabase.lib.schema.expression/type-of","p__48789","vec__48790","pred-expr-pairs","default","G__48793","p__48799","vec__48800","metabase.lib.convert/get-or-throw!","cljs.core.ex_info","p__48804","vec__48805","p__48820","vec__48822","aggregation","vec__48830","seq__48831","first__48832","cljs.core.merge","metabase.lib.convert/legacy-query-from-inner-query","database-id","inner-query","fexpr__48838","metabase.lib.convert/->legacy-MBQL","var_args","G__48840","metabase.lib.convert/disqualify","p__48841","vec__48842","_v","cljs.core/qualified-keyword?","cljs.core/namespace","metabase.lib.convert.disqualify","metabase.lib.convert/options->legacy-MBQL","p__48845","vec__48846","p__48849","vec__48850","seq__48851","first__48852","metabase.lib.convert/aggregation->legacy-MBQL","inner","aggregation-opts","p__48856","vec__48857","seq__48858","first__48859","metabase.lib.convert/clause-with-options->legacy-MBQL","cljs.core.concat","temp__5804__auto__","cljs.core/cons","seq__48864","chunk__48865","count__48866","i__48867","cljs.core/chunked-seq?","c__5568__auto__","cljs.core/chunk-first","cljs.core/chunk-rest","metabase.lib.hierarchy/derive","seq__48870","chunk__48871","count__48872","i__48873","seq__48883","chunk__48884","count__48885","i__48886","input","metabase.lib.convert/stage-metadata->legacy-metadata","stage-metadata","p1__48893#","cljs.core/update-keys","metabase.util/->snake_case_en","p__48923","map__48924","metabase.lib.convert/chain-stages","p__48928","vec__48931","G__48936","G__48943","p__48971","vec__48974","p__48989","vec__48992","_","agg-uuid","ag","G__49000","p__49014","vec__49016","id","vec__49023","p__49038","vec__49064","metabase.lib.convert/update-list->legacy-boolean-expression","pMBQL-key","legacy-key","G__49068","p1__49067#","base","G__49070","clojure.string/starts-with?","cljs.core/select-keys","metabase.lib.convert/source-card->legacy-source-table","source-card-id","*pMBQL-uuid->legacy-index*-orig-val__49107","*pMBQL-uuid->legacy-index*-temp-val__49108","p__49118","vec__49125","map__49128","p1__49102#","p2__49103#","p1__49104#","iter__5523__auto__","s__49145","cljs.core/LazySeq","c__5521__auto__","size__5522__auto__","b__49147","cljs.core/chunk-buffer","i__49146","cljs.core/-nth","cljs.core/chunk-append","cljs.core/chunk-cons","cljs.core/chunk","iter__49144","cljs.core/rest","expression","legacy-clause","metabase.lib.util/expression-name","cljs.core/second","parameters","query-type","cljs.core/last","G__49165"]],"~:used-vars",["^H",["~$metabase.lib.util/legacy-string-table-id->card-id","~$cljs.core/--destructure-map","~$metabase.lib.util/pipeline","~$cljs.core/comp","~$cljs.core/rest","~$metabase.lib.convert/aggregation->legacy-MBQL","~$metabase.lib.convert/stage-metadata->legacy-metadata","~$cljs.core/keyword","~$malli.core/explain","~$metabase.lib.convert/*pMBQL-uuid->legacy-index*","~$cljs.core/MultiFn","~$clojure.string/starts-with?","~$metabase.lib.convert/clean-stage","~$metabase.lib.util/unique-name-generator","~$metabase.util/remove-nils","~$cljs.core/vector?","~$cljs.core/filter","~$cljs.core/=","~$metabase.lib.convert/*legacy-index->pMBQL-uuid*","~$cljs.core/update-keys","~$cljs.core/count","~$metabase.lib.options/ensure-uuid","~$metabase.lib.convert/->pMBQL","~$cljs.core/reduce","~$cljs.core/seq","~$cljs.core/chunk-first","~$cljs.core/Keyword","~$cljs.core/last","~$cljs.core/chunk","~$cljs.core/mapv","~$cljs.core/dissoc","~$cljs.core/LazySeq","~$cljs.core/chunk-rest","~$lambdaisland.glogi/log","~$cljs.core/atom","~$cljs.core/qualified-keyword?","~$cljs.core/concat","~$metabase.lib.util/named-expression-clause","~$metabase.util/colorize","~$metabase.util.log/is-loggable?","~$cljs.core/pop","~$cljs.core/pr-str","~$metabase.lib.schema.expression/type-of","~$metabase.lib.convert/clause-with-options->legacy-MBQL","~$metabase.lib.hierarchy/derive","~$cljs.core/into","~$cljs.core/map?","~$cljs.core/conj","~$metabase.lib.convert/default-MBQL-clause->pMBQL","~$metabase.lib.convert/update-list->legacy-boolean-expression","~$cljs.core/update","~$metabase.util.log/format-msg","~$cljs.core/namespace","~$cljs.core/juxt","~$cljs.core/peek","~$cljs.core/map","~$metabase.lib.convert/stage-keys","~$metabase.lib.convert/clean","~$medley.core/update-existing","~$cljs.core/update-vals","~$metabase.lib.convert/get-or-throw!","~$clojure.set/rename-keys","~$cljs.core/-add-method","~$metabase.lib.convert/source-card->legacy-source-table","~$cljs.core/get","~$clojure.data/diff","~$medley.core/assoc-some","~$cljs.core/chunk-append","~$cljs.core/-nth","~$cljs.core/remove","~$cljs.core/drop-last","~$cljs.core/not-empty","~$metabase.util.log/glogi-level","~$cljs.core/symbol","~$metabase.lib.convert/options->legacy-MBQL","~$metabase.lib.convert/legacy-query-from-inner-query","~$cljs.core/nil?","~$metabase.lib.convert/disqualify","~$cljs.core/nth","~$cljs.core/ex-info","~$cljs.core/second","~$metabase.lib.dispatch/dispatch-value","~$metabase.lib.hierarchy/hierarchy","~$cljs.core/next","~$metabase.lib.util/expression-name","~$metabase.lib.convert/chain-stages","~$cljs.core/select-keys","~$cljs.core/chunk-cons","~$cljs.core/not","~$cljs.core/disj","~$cljs.core/cons","~$cljs.core/assoc","~$cljs.core/chunk-buffer","~$cljs.core/seqable?","~$cljs.core/map-indexed","~$metabase.lib.convert/deduplicate-join-aliases","~$metabase.lib.convert/clean-location","~$metabase.util/pprint-to-str","~$metabase.lib.convert/stage-source-card-id->pMBQL","~$cljs.core/take-last","~$cljs.core/first","~$metabase.lib.convert/->legacy-MBQL","~$cljs.core/merge","~$cljs.core/update-in","~$js/Error","~$metabase.lib.convert/legacy-default-join-alias","~$malli.error/humanize","~$cljs.core/chunked-seq?","~$metabase.util/->snake_case_en"]]],"~:cache-keys",["~#cmap",[["^1K","camel_snake_kebab/internals/misc.cljc"],["5ae08f83ceb8959971e6334596bff0214bf6fdf2","~:shadow.build.compiler/resolve",["^ ","~:require-id",null,"~:deps-ids",["^H",[]],"~:deps-syms",["^13","^?","~$camel-snake-kebab.internals.string-separator","^1>"]]],["^1K","goog/dom/tagname.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","~$goog.dom.HtmlElement"]]],["^1K","metabase/shared/util/i18n.cljs"],["6c3c8615004b349dae9851ed547d516d45e04bd0","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","~$shadow.js.shim.module$ttag","^1>"]]],["^1K","goog/labs/useragent/platform.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","~$goog.string.internal","~$goog.labs.userAgent.util","~$goog.labs.userAgent.highEntropy.highEntropyValue","~$goog.labs.userAgent.highEntropy.highEntropyData","~$goog.labs.userAgent"]]],["^1K","metabase/types.cljc"],["00232bf78b259e26a21c218c8f2d746ba7003a15","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^R","~$metabase.types.coercion-hierarchies","^["]]],["^1K","cljs/spec/gen/alpha.cljs"],["bc14df6666853ed869d7b88aaa864111c65d0c7f","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","~$goog.Uri"]]],["^1K","metabase/lib/util.cljc"],["11c3262368d876979e323f3e646aab21fbf9b86e","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","~$shadow.js.shim.module$crc_32","~$goog.string","~$goog.string.format","^R","^1>","^19","~$metabase.lib.common","^16","^P","~$metabase.lib.schema.common","^11","~$metabase.lib.schema.id","~$metabase.mbql.util","~$metabase.shared.util.i18n","^[","~$metabase.util.malli"]]],["^1K","lambdaisland/glogi.cljs"],["76286836d4172602aa08006b2a754dda736ffe09","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","~$goog.log","~$goog.debug.Console","~$goog.array","^1>","~$goog.object","~$goog.debug.FancyWindow","~$goog.debug.DivConsole"]]],["^1K","goog/math/math.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","~$goog.asserts"]]],["^1K","goog/html/trustedtypes.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13"]]],["^1K","goog/string/stringformat.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^4R"]]],["^1K","malli/registry.cljc"],["514c6f7d69d7e40b56fa75bfd1a49a683ca15982","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?"]]],["^1K","goog/labs/useragent/browser.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^4K","^4L","^54","^4J","^4M","^4N"]]],["^1K","goog/html/safeurl.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^54","~$goog.fs.url","~$goog.html.TrustedResourceUrl","~$goog.string.Const","~$goog.string.TypedString","^4J"]]],["^1K","goog/style/style.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^54","~$goog.dom","~$goog.dom.NodeType","~$goog.dom.TagName","~$goog.dom.safe","~$goog.dom.vendor","~$goog.html.SafeStyleSheet","~$goog.math.Box","~$goog.math.Coordinate","~$goog.math.Rect","~$goog.math.Size","^51","~$goog.reflect","^4R","~$goog.userAgent"]]],["^1K","goog/array/array.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^54"]]],["~:shadow.build.js-support/require","moment"],["~$shadow.js.shim.module$moment","shadow.js.shim.module$moment.js","require","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13"]]],["^5E","moment-timezone"],["~$shadow.js.shim.module$moment_timezone","shadow.js.shim.module$moment_timezone.js","require","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13"]]],["^1K","metabase/mbql/schema/macros.cljs"],["2af09bd42ffb1e15b66723cf7ba15db7dc75d10b","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?"]]],["^1K","metabase/lib/schema/mbql_clause.cljc"],["e5bdd00c58db706b1219843528fd3cd9dd8ab728","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^4U","^11","~$metabase.types","^4Y","~$metabase.util.malli.registry"]]],["^1K","goog/useragent/useragent.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","~$goog.labs.userAgent.browser","~$goog.labs.userAgent.engine","~$goog.labs.userAgent.platform","^4K","^5C","^4J"]]],["^1K","malli/generator.cljc"],["514c6f7d69d7e40b56fa75bfd1a49a683ca15982","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^A","^1>","~$clojure.test.check","~$clojure.test.check.generators","~$clojure.test.check.properties","~$clojure.test.check.random","~$clojure.test.check.rose-tree","^T","~$malli.registry"]]],["^1K","clojure/test/check/properties.cljc"],["f33d988fd57bc9c11af1952db81c10f319c91416","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^5N","~$clojure.test.check.results"]]],["^1K","clojure/test/check/generators.cljc"],["f33d988fd57bc9c11af1952db81c10f319c91416","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^1>","^5P","^5Q","^4R"]]],["^1K","goog/debug/error.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13"]]],["^1K","metabase/lib/common.cljc"],["a3bc6343077ef13a3da77612b68f23f9b2a3d890","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^1<","^18","^16","~$metabase.lib.ref","^4U","^4Y"]]],["^1K","metabase/lib/schema/util.cljc"],["14a9e8a90c56f5e44b4ecd361e962722fd97aecf","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^16"]]],["^1K","goog/flags/flags.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13"]]],["^1K","malli/util.cljc"],["514c6f7d69d7e40b56fa75bfd1a49a683ca15982","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^?","^T"]]],["^1K","clojure/test/check/random/doubles.cljs"],["f33d988fd57bc9c11af1952db81c10f319c91416","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","~$clojure.test.check.random.longs"]]],["^1K","net/cgrand/macrovich.cljc"],["abcb26cbfe0f8eef363b25525210c0fe1eb1f693","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?"]]],["^1K","malli/destructure.cljc"],["514c6f7d69d7e40b56fa75bfd1a49a683ca15982","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","~$clojure.walk","^T","~$malli.impl.util"]]],["^1K","schema/spec/variant.cljc"],["0dacc3066a87f33088c9a332b6c21e8b0560011c","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","~$schema.utils","~$schema.spec.core"]]],["^1K","goog/structs/circularbuffer.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13"]]],["^1K","weavejester/dependency.cljc"],["7fd7f8879313f6a7e295f7447e668bdf492c42c1","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^R"]]],["^1K","metabase/lib/schema/common.cljc"],["3f51a06335a7cb84c835d859c422919499874414","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^1>","^5H","^5I"]]],["^1K","goog/dom/nodetype.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13"]]],["^1K","goog/labs/useragent/highentropy/highentropyvalue.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^4K","^4J"]]],["^1K","cljs/pprint.cljs"],["bc14df6666853ed869d7b88aaa864111c65d0c7f","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^1>","^4R","~$goog.string.StringBuffer"]]],["^1K","metabase/lib/schema/template_tag.cljc"],["f1b6289b8e576857fe667aed3da134e4ad1ea26a","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^T","^4U","^4V","~$metabase.mbql.schema","^5I"]]],["^1K","metabase/lib/schema/ref.cljc"],["5037a60b3d2f427702cf5cedf23f02bcc394d051","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^1>","^1<","^18","^4U","^11","^4V","~$metabase.lib.schema.mbql-clause","~$metabase.lib.schema.temporal-bucketing","^5H","^5I"]]],["^1K","clojure/test/check/rose_tree.cljc"],["f33d988fd57bc9c11af1952db81c10f319c91416","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?"]]],["^1K","clojure/test/check/impl.cljc"],["f33d988fd57bc9c11af1952db81c10f319c91416","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?"]]],["^1K","camel_snake_kebab/internals/string_separator.cljc"],["5ae08f83ceb8959971e6334596bff0214bf6fdf2","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^1>"]]],["^1K","clojure/test/check/random.cljs"],["f33d988fd57bc9c11af1952db81c10f319c91416","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","~$clojure.test.check.random.doubles","^5U"]]],["^1K","metabase/lib/schema/expression/arithmetic.cljc"],["e6936a3e0b11bc3cd40d4e396c708af4622c21cb","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^T","^19","^18","^4U","^11","^60","^61","^5H","^5I"]]],["^1K","goog/string/typedstring.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13"]]],["^1K","metabase/lib/schema/expression/string.cljc"],["b2d7de575aaaa880fdc88dfc31642c8e002c3669","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^11","^60"]]],["^1K","goog/object/object.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13"]]],["^1K","metabase/lib/schema/filter.cljc"],["0147dea423ebfd097bf1edb97f0325c9e2908a85","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^4U","^11","^60","^61","^5I"]]],["^1K","goog/dom/asserts.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^54"]]],"~:SHADOW-TIMESTAMP",[1689947046000,1689947046000,1689947050000],["^1K","metabase/lib/ref.cljc"],["86a9fbeddec3e58f7bb54e61f5342658b370fb3b","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^1<","~$metabase.lib.schema.ref","^4Y"]]],["^1K","goog/math/long.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^54","^5C"]]],["^1K","goog/html/trustedresourceurl.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^54","~$goog.fs.blob","^55","~$goog.html.SafeScript","~$goog.html.trustedtypes","^57","^58"]]],["^1K","schema/spec/leaf.cljc"],["0dacc3066a87f33088c9a332b6c21e8b0560011c","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^5Y"]]],["^1K","metabase/util/format.cljc"],["875f86a08288cb3ad5a6f15df988897eaf8613af","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^4R"]]],["^1K","goog/math/irect.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13"]]],["^1K","goog/math/box.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^54","^5@"]]],["^1K","metabase/lib/options.cljc"],["1870276153adf026e09a3e9ed1ba8beaad80e1c8","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^4U","^4X","^[","^4Y"]]],["^1K","goog/string/internal.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13"]]],["^1K","clojure/test/check.cljc"],["f33d988fd57bc9c11af1952db81c10f319c91416","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^5N","^5P","^5S","^5Q","~$clojure.test.check.impl"]]],["^1K","goog/functions/functions.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13"]]],["^1K","goog/html/safestyle.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^57","~$goog.html.SafeUrl","^58","^54","^4J"]]],["^1K","goog/dom/safe.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^54","~$goog.asserts.dom","~$goog.dom.asserts","~$goog.functions","~$goog.html.SafeHtml","^66","~$goog.html.SafeStyle","^69","^56","~$goog.html.uncheckedconversions","^57","^4J"]]],["^1K","goog/asserts/dom.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^5;","^54","~$goog.dom.element"]]],["^1K","medley/core.cljc"],["f5117fa4c15ff14c4a0ab7db414b0f102afb0b8a","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?"]]],["^1K","clojure/walk.cljs"],["bc14df6666853ed869d7b88aaa864111c65d0c7f","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?"]]],["^1K","metabase/lib/schema/expression/conditional.cljc"],["226c4623394b90853fcb014e9a95e84ffc8bd6db","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^R","^11","^60","^5H","^5I"]]],["^1K","lambdaisland/glogi/console.cljs"],["76286836d4172602aa08006b2a754dda736ffe09","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","~$lambdaisland.glogi","~$lambdaisland.glogi.print","^51","^4["]]],["^1K","goog/html/safehtml.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^57","^66","^6>","^5>","^69","^5;","^56","^58","^54","^5J","^50","^51","^4J","~$goog.dom.tags","^67"]]],["^1K","goog/dom/tags.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^51"]]],["^1K","goog/math/size.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13"]]],["^1K","malli/error.cljc"],["514c6f7d69d7e40b56fa75bfd1a49a683ca15982","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^1>","^T","~$malli.util"]]],["^1K","metabase/lib/dispatch.cljc"],["914208cd51b78412eff1b402519bbb422845497a","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^["]]],["^1K","metabase/util/malli.cljc"],["0f9ba23be6bb9fa629617001e985b988d2322b17","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^?","^T","~$malli.destructure","^V","~$malli.generator","^6D","^4X","^["]]],["^1K","goog/labs/useragent/engine.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^50","^4J","^4K"]]],["^1K","goog/fs/blob.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13"]]],["^1K","metabase/mbql/schema/helpers.cljc"],["b1f6002b97b59423b504abb666e13c9b0228b768","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^1>","^5H","~$schema.core"]]],["^1K","goog/dom/dom.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^50","^54","^6:","~$goog.dom.BrowserFeature","^5:","^5;","^5<","^6=","^6?","^5@","^5B","^51","^4R","^57","~$goog.string.Unicode","^5D"]]],["^1K","borkdude/dynaload.cljc"],["accd696ba364b850b4d92e38f5a34d0e828a0ad1","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?"]]],["^1K","metabase/util/log.cljs"],["7d8a3bf01eb27c2ba7269dc90dc218e46bcc1d3a","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^4Z","^4R","^4S","^6A","~$lambdaisland.glogi.console"]]],["^1K","goog/asserts/asserts.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","~$goog.debug.Error","^5:"]]],["^1K","goog/debug/relativetimeprovider.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13"]]],["^1K","malli/sci.cljc"],["514c6f7d69d7e40b56fa75bfd1a49a683ca15982","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","~$borkdude.dynaload"]]],["^1K","metabase/lib/schema/expression.cljc"],["f5c5c3ff3dc0f9a8b407cd7d06a68c6787061991","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^1<","^18","^4U","^4X","^5H","^4Y","^5I"]]],["^1K","goog/math/rect.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^54","^5?","^5@","~$goog.math.IRect","^5B"]]],["^1K","flatland/ordered/map.cljs"],["3a9cb9d79e47d77ecd4f4d550371ecf01464c461","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?"]]],["^1K","goog/uri/uri.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^50","^54","~$goog.collections.maps","^4R","~$goog.structs","~$goog.uri.utils","~$goog.uri.utils.ComponentIndex","~$goog.uri.utils.StandardQueryParam"]]],["^1K","metabase/util/malli/registry.cljc"],["921d4f259bbe54cbeb6b88ae56937df492bdfb5e","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^T","^5R","^6D"]]],["^1K","goog/labs/useragent/highentropy/highentropydata.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^4L"]]],["^1K","metabase/types/coercion_hierarchies.cljc"],["c3d70ef6080e044d61f13ff6bfd76490e2dcd0ac","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^R"]]],["^1K","goog/collections/maps.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13"]]],["^1K","goog/debug/divconsole.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","~$goog.debug.HtmlFormatter","~$goog.dom.DomHelper","^5;","^5<","^6=","^5>","^4Z","^57","~$goog.style"]]],["^1K","schema/spec/collection.cljc"],["0dacc3066a87f33088c9a332b6c21e8b0560011c","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^5X","^5Y"]]],["^1K","malli/impl/util.cljc"],["514c6f7d69d7e40b56fa75bfd1a49a683ca15982","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?"]]],["^1K","metabase/lib/schema/order_by.cljc"],["3f577f71e4ecba1aa1061f2228f6026ab45312ff","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^11","^60","^5I"]]],["^1K","schema/utils.cljc"],["0dacc3066a87f33088c9a332b6c21e8b0560011c","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^4S","^51","^4R","^1>"]]],["^1K","metabase/lib/schema/aggregation.cljc"],["ea4a70903cfc3ffeaa60ebdedb5ea00892da4dbe","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^18","^11","^60","^4X","^5I"]]],["^1K","cljs/core/match.cljs"],["f419c02deee501e9f4b29f81215ba81ffcefe9b6","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?"]]],["^1K","goog/debug/fancywindow.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^50","^54","~$goog.debug.DebugWindow","^6T","^5;","^5<","^6=","^5>","^4Z","^51","^4R","^57","^5D"]]],["^1K","goog/debug/formatter.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","~$goog.debug","~$goog.debug.RelativeTimeProvider","^6=","^69","^6?","^4Z","^57"]]],["^1K","metabase/shared/util/namespaces.cljs"],["00687008abd6eb291bc9d5ff1fff73210e0bbe6e","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?"]]],["^1K","metabase/mbql/util/match/impl.cljc"],["4150e01975339d308f5cfedda77875eda19c030d","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?"]]],["^1K","goog/fs/url.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13"]]],["^1K","goog/base.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",[]]],["^1K","goog/structs/structs.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^50","^51"]]],["^1K","clojure/string.cljs"],["bc14df6666853ed869d7b88aaa864111c65d0c7f","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^4R","^5Z"]]],["^1K","metabase/lib/schema/temporal_bucketing.cljc"],["9cb7bba3e46e1de2fbb37d61df332336da6d9f66","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^R","^5I"]]],["^1K","metabase/util.cljc"],["2eb945a6741f1450ecac08a9087b862ce52b9e3a","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","~$camel-snake-kebab.internals.macros","^Z","^C","^R","^1>","^5V","~$flatland.ordered.map","^19","^4X","~$metabase.shared.util.namespaces","~$metabase.util.format","^X","~$net.cgrand.macrovich","~$weavejester.dependency"]]],["^1K","clojure/test/check/random/longs/bit_count_impl.cljs"],["f33d988fd57bc9c11af1952db81c10f319c91416","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?"]]],["^1K","malli/impl/regex.cljc"],["514c6f7d69d7e40b56fa75bfd1a49a683ca15982","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^5W"]]],["^1K","camel_snake_kebab/internals/macros.cljc"],["5ae08f83ceb8959971e6334596bff0214bf6fdf2","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","~$camel-snake-kebab.internals.alter-name","~$camel-snake-kebab.internals.misc"]]],["^1K","metabase/lib/schema/expression/temporal.cljc"],["f1f22c1655e7d335b884a22b010f2b8b08ad1e94","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^R","^T","^18","^4U","^11","~$metabase.lib.schema.literal","^60","^61","^5I","^5F","^5G"]]],["^1K","goog/string/string.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^5<","^6?","^57","^4J"]]],["^1K","schema/core.cljc"],["0dacc3066a87f33088c9a332b6c21e8b0560011c","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^1>","^5X","^5Y","~$schema.spec.leaf","~$schema.spec.variant","~$schema.spec.collection"]]],["^1K","metabase/mbql/schema.cljc"],["c51bf2a180ecbc12d6a1cd42a4049323f46a0085","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^5F","^5G","^?","^R","~$metabase.mbql.schema.helpers","~$metabase.mbql.schema.macros","^6G"]]],["^1K","metabase/mbql/util/match.cljs"],["d65aaa9fbcb7960b90ba7ca97258b1dc8a40be2b","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^E","~$metabase.mbql.util.match.impl"]]],["^1K","malli/core.cljc"],["514c6f7d69d7e40b56fa75bfd1a49a683ca15982","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^?","~$malli.impl.regex","^5W","^5R","~$malli.sci"]]],["^1K","metabase/lib/schema.cljc"],["122fe4013d55087fc7287141eb7dc6f630436424","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","~$metabase.lib.schema.aggregation","^4U","^11","~$metabase.lib.schema.expression.arithmetic","~$metabase.lib.schema.expression.conditional","~$metabase.lib.schema.expression.string","~$metabase.lib.schema.expression.temporal","~$metabase.lib.schema.filter","^4V","~$metabase.lib.schema.join","^75","~$metabase.lib.schema.order-by","^64","~$metabase.lib.schema.template-tag","~$metabase.lib.schema.util","~$metabase.mbql.util.match","^5I"]]],["^1K","clojure/data.cljs"],["bc14df6666853ed869d7b88aaa864111c65d0c7f","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^R"]]],["^1K","goog/reflect/reflect.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13"]]],["^1K","goog/labs/useragent/util.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^4J","^4N"]]],["^1K","goog/debug/debug.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^50","~$goog.debug.errorcontext"]]],["^1K","goog/string/stringbuffer.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13"]]],["^1K","schema/spec/core.cljc"],["0dacc3066a87f33088c9a332b6c21e8b0560011c","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^5X"]]],["^5E","ttag"],["^4I","shadow.js.shim.module$ttag.js","require","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13"]]],["^1K","goog/math/coordinate.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","~$goog.math"]]],["^1K","goog/debug/errorcontext.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13"]]],["^1K","metabase/lib/convert.cljc"],["02b5f0cb2d10c8707d14831510e21c7d65dc15b4","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^Z","^R","^1>","^T","^V","^19","^1<","^18","^16","^P","^11","^12","^[","^X"]]],["^1K","goog/labs/useragent/useragent.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","~$goog.flags"]]],["^1K","goog/dom/element.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^5:","^5;"]]],["^1K","goog/html/uncheckedconversions.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^54","^6=","^66","^6>","^5>","^69","^56","^57","^4J"]]],["^1K","goog/debug/debugwindow.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^6S","^5<","^6=","^5>","^4Z","^57","~$goog.structs.CircularBuffer","^5D"]]],["^1K","metabase/mbql/util.cljc"],["2532d5faa94d2a89dd06e529c641d594e298e2aa","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^1>","~$metabase.mbql.predicates","^5[","^79","^7H","^4X","^6G"]]],["^1K","goog/dom/htmlelement.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13"]]],["^1K","cljs/core.cljs"],["bc14df6666853ed869d7b88aaa864111c65d0c7f","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","~$goog.math.Long","~$goog.math.Integer","^4R","^51","^50","^4P","^5Z"]]],["^1K","goog/html/safescript.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^57","^58","^67","^54"]]],["^1K","clojure/test/check/random/longs.cljs"],["f33d988fd57bc9c11af1952db81c10f319c91416","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","~$clojure.test.check.random.longs.bit-count-impl","^7N","^?"]]],["^1K","goog/log/log.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^54","^6W"]]],["^1K","camel_snake_kebab/internals/alter_name.cljc"],["5ae08f83ceb8959971e6334596bff0214bf6fdf2","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?"]]],["^1K","goog/html/safestylesheet.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^57","^6>","^58","^51","^54","^4J"]]],["^1K","goog/math/integer.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^5C"]]],["^1K","goog/debug/console.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","~$goog.debug.TextFormatter","^4Z"]]],["^1K","lambdaisland/glogi/print.cljs"],["76286836d4172602aa08006b2a754dda736ffe09","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^6A","^51"]]],["^1K","goog/dom/browserfeature.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^5D"]]],["^1K","clojure/set.cljs"],["bc14df6666853ed869d7b88aaa864111c65d0c7f","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?"]]],["^1K","goog/uri/utils.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^54","^4R"]]],["^1K","goog/string/const.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^54","^58"]]],["^1K","metabase/lib/schema/id.cljc"],["7cdfc70702a9a9e04b75ca7c9dc898ddf546f99d","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^4U","^5[","^5I"]]],["^1K","goog/dom/vendor.js"],["533ce2bdbb7925db781449abb6527af1e6c5e782","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^4R","^5D"]]],["^1K","metabase/lib/schema/literal.cljc"],["f8f31bfaef820ab25b896b49fd404b937d0df64e","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^T","^4U","^11","^60","^5I"]]],["^1K","metabase/lib/hierarchy.cljc"],["c9d228603522de5c85546fb645c59736d4eb94d2","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?"]]],["^1K","metabase/mbql/predicates.cljc"],["20ab1a5ccd943c35c646c5f7396ea40f9bfa7ac4","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^5[","^6G"]]],["^1K","clojure/test/check/results.cljc"],["f33d988fd57bc9c11af1952db81c10f319c91416","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?"]]],["^5E","crc-32"],["^4Q","shadow.js.shim.module$crc_32.js","require","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13"]]],["^1K","metabase/lib/schema/join.cljc"],["924e0ca4abbab776fa05357d6d22bafb8a596648","^4C",["^ ","^4D",null,"^4E",["^H",[]],"^4F",["^13","^?","^4U","^11","^4X","^5I"]]]]],"~:clj-info",["^ ","jar:file:/root/.m2/repository/org/clojure/clojurescript/1.11.60/clojurescript-1.11.60.jar!/cljs/analyzer/impl.cljc",1689947050000,"jar:file:/root/.m2/repository/instaparse/instaparse/1.4.12/instaparse-1.4.12.jar!/instaparse/line_col.clj",1689946146000,"jar:file:/root/.m2/repository/org/clojure/clojurescript/1.11.60/clojurescript-1.11.60.jar!/cljs/source_map/base64_vlq.clj",1689947050000,"jar:file:/root/.m2/repository/instaparse/instaparse/1.4.12/instaparse-1.4.12.jar!/instaparse/viz.clj",1689946146000,"jar:file:/root/.m2/repository/org/clojure/tools.namespace/1.4.4/tools.namespace-1.4.4.jar!/clojure/tools/namespace/parse.cljc",1689946139000,"jar:file:/root/.m2/repository/weavejester/dependency/0.2.1/dependency-0.2.1.jar!/weavejester/dependency.cljc",1689946093000,"jar:file:/root/.m2/repository/instaparse/instaparse/1.4.12/instaparse-1.4.12.jar!/instaparse/transform.clj",1689946146000,"jar:file:/root/.m2/repository/ring/ring-codec/1.2.0/ring-codec-1.2.0.jar!/ring/util/codec.clj",1689946172000,"file:/home/gmrworkspace/dashboard/src/metabase/lib/hierarchy.cljc",1690286812000,"jar:file:/root/.m2/repository/org/clojure/clojurescript/1.11.60/clojurescript-1.11.60.jar!/cljs/instant.clj",1689947050000,"jar:file:/root/.m2/repository/org/clojure/tools.reader/1.3.6/tools.reader-1.3.6.jar!/clojure/tools/reader/default_data_readers.clj",1689946174000,"jar:file:/root/.m2/repository/org/clojure/clojurescript/1.11.60/clojurescript-1.11.60.jar!/cljs/pprint.cljc",1689947050000,"jar:file:/root/.m2/repository/org/clojure/clojurescript/1.11.60/clojurescript-1.11.60.jar!/cljs/externs.clj",1689947050000,"file:/home/gmrworkspace/dashboard/shared/src/metabase/mbql/util/match.clj",1690286812000,"jar:file:/root/.m2/repository/org/clojure/clojurescript/1.11.60/clojurescript-1.11.60.jar!/cljs/vendor/clojure/tools/reader/default_data_readers.clj",1689947050000,"file:/home/gmrworkspace/dashboard/shared/src/metabase/mbql/schema/helpers.cljc",1692013156305,"jar:file:/root/.m2/repository/prismatic/schema/1.4.1/schema-1.4.1.jar!/schema/core.cljc",1689946172000,"file:/home/gmrworkspace/dashboard/shared/src/metabase/shared/util/i18n.clj",1690286812000,"jar:file:/root/.m2/repository/org/clojure/tools.reader/1.3.6/tools.reader-1.3.6.jar!/clojure/tools/reader/edn.clj",1689946174000,"jar:file:/root/.m2/repository/org/clojure/clojurescript/1.11.60/clojurescript-1.11.60.jar!/cljs/compiler.cljc",1689947050000,"jar:file:/root/.m2/repository/org/clojure/clojurescript/1.11.60/clojurescript-1.11.60.jar!/cljs/env.cljc",1689947050000,"jar:file:/root/.m2/repository/org/clojure/clojurescript/1.11.60/clojurescript-1.11.60.jar!/cljs/analyzer/impl/namespaces.cljc",1689947050000,"jar:file:/root/.m2/repository/prismatic/schema/1.4.1/schema-1.4.1.jar!/schema/macros.clj",1689946172000,"file:/home/gmrworkspace/dashboard/src/metabase/util/i18n/plural.clj",1690286813000,"jar:file:/root/.m2/repository/metosin/malli/0.10.2/malli-0.10.2.jar!/malli/core.cljc",1689946170000,"jar:file:/root/.m2/repository/org/clojure/clojurescript/1.11.60/clojurescript-1.11.60.jar!/cljs/source_map.clj",1689947050000,"jar:file:/root/.m2/repository/org/clojure/clojurescript/1.11.60/clojurescript-1.11.60.jar!/cljs/util.cljc",1689947050000,"file:/home/gmrworkspace/dashboard/src/metabase/util.cljc",1690286813000,"jar:file:/root/.m2/repository/nano-id/nano-id/1.0.0/nano-id-1.0.0.jar!/nano_id/core.cljc",1689946171000,"file:/home/gmrworkspace/dashboard/src/metabase/lib/dispatch.cljc",1690286812000,"file:/home/gmrworkspace/dashboard/src/metabase/lib/schema/common.cljc",1690286812000,"file:/home/gmrworkspace/dashboard/src/metabase/plugins/classloader.clj",1692013156125,"jar:file:/root/.m2/repository/medley/medley/1.4.0/medley-1.4.0.jar!/medley/core.cljc",1689946185000,"jar:file:/root/.m2/repository/org/clojure/clojurescript/1.11.60/clojurescript-1.11.60.jar!/cljs/analyzer.cljc",1689947050000,"jar:file:/root/.m2/repository/org/clojure/clojurescript/1.11.60/clojurescript-1.11.60.jar!/cljs/analyzer/passes.cljc",1689947050000,"jar:file:/root/.m2/repository/org/clojure/test.check/1.1.1/test.check-1.1.1.jar!/clojure/test/check/random.clj",1689946177000,"jar:file:/root/.m2/repository/org/clojure/clojurescript/1.11.60/clojurescript-1.11.60.jar!/cljs/vendor/clojure/data/json.clj",1689947050000,"file:/home/gmrworkspace/dashboard/src/metabase/util/format.cljc",1690286813000,"jar:file:/root/.m2/repository/org/clojure/clojurescript/1.11.60/clojurescript-1.11.60.jar!/cljs/source_map/base64.clj",1689947050000,"jar:file:/root/.m2/repository/riddley/riddley/0.2.0/riddley-0.2.0.jar!/riddley/walk.clj",1689946160000,"file:/home/gmrworkspace/dashboard/src/metabase/lib/schema/ref.cljc",1690286812000,"jar:file:/root/.m2/repository/instaparse/instaparse/1.4.12/instaparse-1.4.12.jar!/instaparse/reduction.clj",1689946146000,"jar:file:/root/.m2/repository/org/tcrawley/dynapath/1.1.0/dynapath-1.1.0.jar!/dynapath/util.clj",1689946174000,"jar:file:/root/.m2/repository/camel-snake-kebab/camel-snake-kebab/0.4.3/camel-snake-kebab-0.4.3.jar!/camel_snake_kebab/internals/macros.cljc",1689946178000,"file:/home/gmrworkspace/dashboard/shared/src/metabase/mbql/util/match/impl.cljc",1690286812000,"jar:file:/root/.m2/repository/org/clojure/clojurescript/1.11.60/clojurescript-1.11.60.jar!/cljs/vendor/clojure/tools/reader/reader_types.clj",1689947050000,"jar:file:/root/.m2/repository/instaparse/instaparse/1.4.12/instaparse-1.4.12.jar!/instaparse/auto_flatten_seq.clj",1689946146000,"jar:file:/root/.m2/repository/instaparse/instaparse/1.4.12/instaparse-1.4.12.jar!/instaparse/core.clj",1689946146000,"jar:file:/root/.m2/repository/metosin/malli/0.10.2/malli-0.10.2.jar!/malli/generator.cljc",1689946170000,"file:/home/gmrworkspace/dashboard/src/metabase/lib/schema/id.cljc",1690286812000,"jar:file:/root/.m2/repository/org/clojure/core.cache/1.0.225/core.cache-1.0.225.jar!/clojure/core/cache.clj",1689946183000,"file:/home/gmrworkspace/dashboard/src/metabase/lib/schema/expression.cljc",1690286812000,"jar:file:/root/.m2/repository/metosin/malli/0.10.2/malli-0.10.2.jar!/malli/sci.cljc",1689946170000,"jar:file:/root/.m2/repository/potemkin/potemkin/0.4.6/potemkin-0.4.6.jar!/potemkin/types.clj",1689946176000,"jar:file:/root/.m2/repository/org/clojure/test.check/1.1.1/test.check-1.1.1.jar!/clojure/test/check/properties.cljc",1689946177000,"jar:file:/root/.m2/repository/org/clojure/clojure/1.11.1/clojure-1.11.1.jar!/clojure/set.clj",1689946092000,"jar:file:/root/.m2/repository/org/clojure/math.numeric-tower/0.0.5/math.numeric-tower-0.0.5.jar!/clojure/math/numeric_tower.clj",1689946148000,"jar:file:/root/.m2/repository/net/cgrand/macrovich/0.2.1/macrovich-0.2.1.jar!/net/cgrand/macrovich.cljc",1689946165000,"jar:file:/root/.m2/repository/colorize/colorize/0.1.1/colorize-0.1.1.jar!/colorize/core.clj",1689946104000,"jar:file:/root/.m2/repository/borkdude/dynaload/0.3.5/dynaload-0.3.5.jar!/borkdude/dynaload.cljc",1689946165000,"jar:file:/root/.m2/repository/org/clojure/clojurescript/1.11.60/clojurescript-1.11.60.jar!/cljs/vendor/clojure/tools/reader/impl/inspect.clj",1689947050000,"file:/home/gmrworkspace/dashboard/src/metabase/lib/options.cljc",1692013156125,"jar:file:/root/.m2/repository/org/clojure/clojure/1.11.1/clojure-1.11.1.jar!/clojure/string.clj",1689946092000,"jar:file:/root/.m2/repository/potemkin/potemkin/0.4.6/potemkin-0.4.6.jar!/potemkin.clj",1689946176000,"jar:file:/root/.m2/repository/instaparse/instaparse/1.4.12/instaparse-1.4.12.jar!/instaparse/failure.clj",1689946146000,"jar:file:/root/.m2/repository/prismatic/schema/1.4.1/schema-1.4.1.jar!/schema/spec/variant.cljc",1689946172000,"jar:file:/root/.m2/repository/org/clojure/clojure/1.11.1/clojure-1.11.1.jar!/clojure/core.clj",1689946092000,"file:/home/gmrworkspace/dashboard/src/metabase/util/i18n/impl.clj",1692013156125,"jar:file:/root/.m2/repository/org/clojure/tools.namespace/1.4.4/tools.namespace-1.4.4.jar!/clojure/tools/namespace/dependency.cljc",1689946139000,"jar:file:/root/.m2/repository/prismatic/schema/1.4.1/schema-1.4.1.jar!/schema/spec/leaf.cljc",1689946172000,"jar:file:/root/.m2/repository/org/clojure/clojurescript/1.11.60/clojurescript-1.11.60.jar!/cljs/analyzer/passes/and_or.cljc",1689947050000,"jar:file:/root/.m2/repository/org/clojure/test.check/1.1.1/test.check-1.1.1.jar!/clojure/test/check.cljc",1689946177000,"jar:file:/root/.m2/repository/riddley/riddley/0.2.0/riddley-0.2.0.jar!/riddley/compiler.clj",1689946160000,"jar:file:/root/.m2/repository/org/clojure/core.memoize/1.0.257/core.memoize-1.0.257.jar!/clojure/core/memoize.clj",1689946178000,"jar:file:/root/.m2/repository/metosin/malli/0.10.2/malli-0.10.2.jar!/malli/destructure.cljc",1689946170000,"jar:file:/root/.m2/repository/instaparse/instaparse/1.4.12/instaparse-1.4.12.jar!/instaparse/print.clj",1689946146000,"jar:file:/root/.m2/repository/org/clojure/tools.namespace/1.4.4/tools.namespace-1.4.4.jar!/clojure/tools/namespace/track.cljc",1689946139000,"jar:file:/root/.m2/repository/org/clojure/clojure/1.11.1/clojure-1.11.1.jar!/clojure/pprint.clj",1689946092000,"jar:file:/root/.m2/repository/org/clojure/java.classpath/1.0.0/java.classpath-1.0.0.jar!/clojure/java/classpath.clj",1689946162000,"jar:file:/root/.m2/repository/org/clojure/clojurescript/1.11.60/clojurescript-1.11.60.jar!/cljs/js_deps.cljc",1689947050000,"jar:file:/root/.m2/repository/metosin/malli/0.10.2/malli-0.10.2.jar!/malli/impl/regex.cljc",1689946170000,"jar:file:/root/.m2/repository/cheshire/cheshire/5.11.0/cheshire-5.11.0.jar!/cheshire/factory.clj",1689946173000,"jar:file:/root/.m2/repository/org/clojure/tools.reader/1.3.6/tools.reader-1.3.6.jar!/clojure/tools/reader/impl/errors.clj",1689946174000,"jar:file:/root/.m2/repository/metosin/malli/0.10.2/malli-0.10.2.jar!/malli/experimental.cljc",1689946170000,"jar:file:/root/.m2/repository/org/clojure/clojure/1.11.1/clojure-1.11.1.jar!/clojure/walk.clj",1689946092000,"jar:file:/root/.m2/repository/org/clojure/tools.reader/1.3.6/tools.reader-1.3.6.jar!/clojure/tools/reader.clj",1689946174000,"file:/home/gmrworkspace/dashboard/src/metabase/lib/common.cljc",1690286812000,"jar:file:/root/.m2/repository/prismatic/schema/1.4.1/schema-1.4.1.jar!/schema/spec/core.cljc",1689946172000,"jar:file:/root/.m2/repository/org/clojure/test.check/1.1.1/test.check-1.1.1.jar!/clojure/test/check/generators.cljc",1689946177000,"jar:file:/root/.m2/repository/org/clojure/clojurescript/1.11.60/clojurescript-1.11.60.jar!/cljs/core.cljc",1689947050000,"jar:file:/root/.m2/repository/cheshire/cheshire/5.11.0/cheshire-5.11.0.jar!/cheshire/generate.clj",1689946173000,"jar:file:/root/.m2/repository/metosin/malli/0.10.2/malli-0.10.2.jar!/malli/experimental/time.cljc",1689946170000,"jar:file:/root/.m2/repository/org/clojure/tools.reader/1.3.6/tools.reader-1.3.6.jar!/clojure/tools/reader/reader_types.clj",1689946174000,"file:/home/gmrworkspace/dashboard/shared/src/metabase/mbql/schema.cljc",1692013156305,"jar:file:/root/.m2/repository/cheshire/cheshire/5.11.0/cheshire-5.11.0.jar!/cheshire/parse.clj",1689946173000,"file:/home/gmrworkspace/dashboard/src/metabase/util/i18n.clj",1692013156125,"jar:file:/root/.m2/repository/instaparse/instaparse/1.4.12/instaparse-1.4.12.jar!/instaparse/cfg.clj",1689946146000,"jar:file:/root/.m2/repository/cheshire/cheshire/5.11.0/cheshire-5.11.0.jar!/cheshire/core.clj",1689946173000,"jar:file:/root/.m2/repository/metosin/malli/0.10.2/malli-0.10.2.jar!/malli/impl/util.cljc",1689946170000,"jar:file:/root/.m2/repository/metosin/malli/0.10.2/malli-0.10.2.jar!/malli/registry.cljc",1689946170000,"jar:file:/root/.m2/repository/instaparse/instaparse/1.4.12/instaparse-1.4.12.jar!/instaparse/gll.clj",1689946146000,"jar:file:/root/.m2/repository/metosin/malli/0.10.2/malli-0.10.2.jar!/malli/instrument.clj",1689946170000,"jar:file:/root/.m2/repository/org/clojure/clojurescript/1.11.60/clojurescript-1.11.60.jar!/cljs/vendor/clojure/tools/reader.clj",1689947050000,"jar:file:/root/.m2/repository/org/clojure/clojurescript/1.11.60/clojurescript-1.11.60.jar!/cljs/spec/gen/alpha.cljc",1689947050000,"file:/home/gmrworkspace/dashboard/src/metabase/lib/ref.cljc",1690286812000,"jar:file:/root/.m2/repository/org/clojure/clojure/1.11.1/clojure-1.11.1.jar!/clojure/edn.clj",1689946092000,"jar:file:/root/.m2/repository/nano-id/nano-id/1.0.0/nano-id-1.0.0.jar!/nano_id/random.cljc",1689946171000,"jar:file:/root/.m2/repository/environ/environ/1.2.0/environ-1.2.0.jar!/environ/core.cljc",1689946163000,"jar:file:/root/.m2/repository/prismatic/schema/1.4.1/schema-1.4.1.jar!/schema/spec/collection.cljc",1689946172000,"jar:file:/root/.m2/repository/org/clojure/clojurescript/1.11.60/clojurescript-1.11.60.jar!/cljs/vendor/clojure/tools/reader/impl/errors.clj",1689947050000,"jar:file:/root/.m2/repository/org/clojure/clojurescript/1.11.60/clojurescript-1.11.60.jar!/cljs/tagged_literals.cljc",1689947050000,"jar:file:/root/.m2/repository/instaparse/instaparse/1.4.12/instaparse-1.4.12.jar!/instaparse/repeat.clj",1689946146000,"jar:file:/root/.m2/repository/org/clojure/clojure/1.11.1/clojure-1.11.1.jar!/clojure/java/io.clj",1689946092000,"jar:file:/root/.m2/repository/org/clojure/test.check/1.1.1/test.check-1.1.1.jar!/clojure/test/check/results.cljc",1689946177000,"jar:file:/root/.m2/repository/com/lambdaisland/glogi/1.2.164/glogi-1.2.164.jar!/lambdaisland/glogi.clj",1689947043000,"jar:file:/root/.m2/repository/org/clojure/clojure/1.11.1/clojure-1.11.1.jar!/clojure/instant.clj",1689946092000,"file:/home/gmrworkspace/dashboard/shared/src/metabase/shared/util/namespaces.clj",1690286812000,"jar:file:/root/.m2/repository/org/clojure/tools.namespace/1.4.4/tools.namespace-1.4.4.jar!/clojure/tools/namespace/file.clj",1689946139000,"jar:file:/root/.m2/repository/org/clojure/core.match/1.0.1/core.match-1.0.1.jar!/cljs/core/match.clj",1689946174000,"jar:file:/root/.m2/repository/org/clojure/spec.alpha/0.3.218/spec.alpha-0.3.218.jar!/clojure/spec/gen/alpha.clj",1689946117000,"jar:file:/root/.m2/repository/metosin/malli/0.10.2/malli-0.10.2.jar!/malli/error.cljc",1689946170000,"file:/home/gmrworkspace/dashboard/shared/src/metabase/mbql/schema/macros.clj",1690286812000,"jar:file:/root/.m2/repository/prismatic/schema/1.4.1/schema-1.4.1.jar!/schema/utils.cljc",1689946172000,"file:/home/gmrworkspace/dashboard/src/metabase/util/malli/registry.cljc",1690286813000,"file:/home/gmrworkspace/dashboard/src/metabase/config.clj",1692013154929,"file:/home/gmrworkspace/dashboard/src/metabase/util/log.clj",1690286813000,"file:/home/gmrworkspace/dashboard/src/metabase/util/malli.cljc",1690286813000,"jar:file:/root/.m2/repository/org/clojure/test.check/1.1.1/test.check-1.1.1.jar!/clojure/test/check/rose_tree.cljc",1689946177000,"jar:file:/root/.m2/repository/org/clojure/tools.reader/1.3.6/tools.reader-1.3.6.jar!/clojure/tools/reader/impl/inspect.clj",1689946174000,"jar:file:/root/.m2/repository/instaparse/instaparse/1.4.12/instaparse-1.4.12.jar!/instaparse/combinators_source.clj",1689946146000,"jar:file:/root/.m2/repository/instaparse/instaparse/1.4.12/instaparse-1.4.12.jar!/instaparse/abnf.clj",1689946146000,"jar:file:/root/.m2/repository/org/clojure/tools.namespace/1.4.4/tools.namespace-1.4.4.jar!/clojure/tools/namespace/find.clj",1689946139000,"jar:file:/root/.m2/repository/org/tcrawley/dynapath/1.1.0/dynapath-1.1.0.jar!/dynapath/dynamic_classpath.clj",1689946174000,"file:/home/gmrworkspace/dashboard/src/metabase/lib/schema/temporal_bucketing.cljc",1690286812000,"jar:file:/root/.m2/repository/cheshire/cheshire/5.11.0/cheshire-5.11.0.jar!/cheshire/generate_seq.clj",1689946173000,"file:/home/gmrworkspace/dashboard/src/metabase/lib/schema/mbql_clause.cljc",1690286812000,"jar:file:/root/.m2/repository/metosin/malli/0.10.2/malli-0.10.2.jar!/malli/util.cljc",1689946170000,"file:/home/gmrworkspace/dashboard/src/metabase/util/jvm.clj",1692013156125],"~:analyzer",["^ ","^3",null,"^4",["^ "],"^5",["^ ","^6","metabase/lib/convert.cljc","^7",1,"^8",5,"^9",1,"^:",25],"^;",["^ ","^<","^=","^>","^?","^@","^A","^B","^C","^D","^E"],"^F",null,"^G",["^H",[]],"^I","^J","^K",["^ "],"^N",null,"^O",["^ ","^P","^P","^Q","^R","^S","^T","^U","^V","^W","^X","^Y","^Z","~$u","^[","^V","^V","^10","^11","^?","^?","^12","^12","^13","^13","^14","^P","^15","^16","^T","^T","^11","^11","^17","^18","^R","^R","~$m","^19","^[","^[","^1:","^12","^1;","^1<","^X","^X","^1=","^1>","^18","^18","^16","^16","^1>","^1>","^Z","^Z","^1<","^1<","^19","^19"],"^1?",["^H",["^1@"]],"~:shadow/js-access-global",["^H",["Error"]],"^1A",null,"~:defs",["^ ","~$source-card->legacy-source-table",["^ ","~:protocol-inline",null,"^5",["^ ","^6","metabase/lib/convert.cljc","^7",416,"^8",8,"^9",416,"^:",40,"~:private",true,"~:arglists",["^1D",["~$quote",["^1D",[["~$stage"]]]]],"~:doc","If a pMBQL query stage has `:source-card` convert it to legacy-style `:source-table \"card__<id>\"`."],"^;2",true,"^I","^3?","^6","metabase/lib/convert.cljc","^:",40,"~:method-params",["^1D",[["^;5"]]],"~:protocol-impl",null,"~:arglists-meta",["^1D",[null,null]],"^8",1,"~:variadic?",false,"^7",416,"~:ret-tag",["^H",[null,"~$clj","~$any"]],"^9",416,"~:max-fixed-arity",1,"~:fn-var",true,"^;3",["^1D",["^;4",["^1D",[["^;5"]]]]],"^;6","If a pMBQL query stage has `:source-card` convert it to legacy-style `:source-table \"card__<id>\"`."],"~$disqualify",["^ ","^;1",null,"^5",["^ ","^;2",true,"^6","metabase/lib/convert.cljc","^:",18,"~:top-fn",["^ ","^;:",false,"~:fixed-arity",1,"^;>",1,"^;7",[[],["~$m"]],"^;3",["^1D",[[],["~$m"]]],"^;9",["^1D",[null,null]]],"^8",8,"^7",260,"^9",260,"^;3",["^1D",["^;4",["^1D",[[],["~$m"]]]]],"^;6","Remove any keys starting with the `:lib/` namespace from map `m`.\n\n  No args = return transducer to remove `:lib/` keys from a map. One arg = update a map `m`."],"^;2",true,"^I","^3M","^6","metabase/lib/convert.cljc","^:",18,"^;A",["^ ","^;:",false,"^;B",1,"^;>",1,"^;7",[[],["~$m"]],"^;3",["^1D",[[],["~$m"]]],"^;9",["^1D",[null,null]]],"^;7",[[],["~$m"]],"^;8",null,"^;B",1,"^;9",["^1D",[null,null]],"^8",1,"^;:",false,"~:methods",[["^ ","^;B",0,"^;:",false,"~:tag","~$function"],["^ ","^;B",1,"^;:",false,"^;D","^;="]],"^7",260,"^9",260,"^;>",1,"^;?",true,"^;3",["^1D",[[],["~$m"]]],"^;6","Remove any keys starting with the `:lib/` namespace from map `m`.\n\n  No args = return transducer to remove `:lib/` keys from a map. One arg = update a map `m`."],"~$chain-stages",["^ ","^;1",null,"^5",["^ ","^6","metabase/lib/convert.cljc","^7",339,"^8",8,"^9",339,"^:",20,"^;2",true,"^;3",["^1D",["^;4",["^1D",[[["^ ","~:keys",["~$stages"]]]]]]]],"^;2",true,"^I","^3U","^6","metabase/lib/convert.cljc","^:",20,"^;7",["^1D",[["~$p__48923"]]],"^;8",null,"^;9",["^1D",[null,null]],"^8",1,"^;:",false,"^7",339,"^;;",["^H",[null,"^;=","~$clj-nil"]],"^9",339,"^;>",1,"^;?",true,"^;3",["^1D",["^;4",["^1D",[[["^ ","^;G",["^;H"]]]]]]]],"~$options->legacy-MBQL",["^ ","^;1",null,"^5",["^ ","^6","metabase/lib/convert.cljc","^7",271,"^8",8,"^9",271,"^:",28,"^;2",true,"^;3",["^1D",["^;4",["^1D",[["~$m"]]]]],"^;6","Convert an options map in an MBQL clause to the equivalent shape for legacy MBQL. Remove `:lib/*` keys and\n  `:effective-type`, which is not used in options maps in legacy MBQL."],"^;2",true,"^I","^3J","^6","metabase/lib/convert.cljc","^:",28,"^;7",["^1D",[["~$m"]]],"^;8",null,"^;9",["^1D",[null,null]],"^8",1,"^;:",false,"^7",271,"^;;",["^H",[null,"^;J"]],"^9",271,"^;>",1,"^;?",true,"^;3",["^1D",["^;4",["^1D",[["~$m"]]]]],"^;6","Convert an options map in an MBQL clause to the equivalent shape for legacy MBQL. Remove `:lib/*` keys and\n  `:effective-type`, which is not used in options maps in legacy MBQL."],"~$clean",["^ ","^;1",null,"^5",["^ ","^6","metabase/lib/convert.cljc","^7",67,"^8",8,"^9",67,"^:",13,"^;2",true,"^;3",["^1D",["^;4",["^1D",[["~$almost-query"]]]]]],"^;2",true,"^I","^39","^6","metabase/lib/convert.cljc","^:",13,"^;7",["^1D",[["^;M"]]],"^;8",null,"^;9",["^1D",[null,null]],"^8",1,"^;:",false,"^7",67,"^;;","^;=","^9",67,"^;>",1,"^;?",true,"^;3",["^1D",["^;4",["^1D",[["^;M"]]]]]],"~$get-or-throw!",["^ ","^;1",null,"^5",["^ ","^6","metabase/lib/convert.cljc","^7",226,"^8",8,"^9",226,"^:",21,"^;2",true,"^;3",["^1D",["^;4",["^1D",[["~$m","~$k"]]]]]],"^;2",true,"^I","^3<","^6","metabase/lib/convert.cljc","^:",21,"^;7",["^1D",[["~$m","~$k"]]],"^;8",null,"^;9",["^1D",[null,null]],"^8",1,"^;:",false,"^7",226,"^;;",["^H",[null,"^;="]],"^9",226,"^;>",2,"^;?",true,"^;3",["^1D",["^;4",["^1D",[["~$m","~$k"]]]]]],"~$legacy-query-from-inner-query",["^ ","^;1",null,"^5",["^ ","^6","metabase/lib/convert.cljc","^7",244,"^8",7,"^9",244,"^:",36,"^;3",["^1D",["^;4",["^1D",[["~$database-id","~$inner-query"]]]]],"^;6","Convert a legacy 'inner query' to a full legacy 'outer query' so you can pass it to stuff\n  like [[metabase.mbql.normalize/normalize]], and then probably to [[->pMBQL]]."],"^I","^3K","^6","metabase/lib/convert.cljc","^:",36,"^;7",["^1D",[["^;P","^;Q"]]],"^;8",null,"^;9",["^1D",[null,null]],"^8",1,"^;:",false,"^7",244,"^;;",["^H",["^;=","^;J"]],"^9",244,"^;>",2,"^;?",true,"^;3",["^1D",["^;4",["^1D",[["^;P","^;Q"]]]]],"^;6","Convert a legacy 'inner query' to a full legacy 'outer query' so you can pass it to stuff\n  like [[metabase.mbql.normalize/normalize]], and then probably to [[->pMBQL]]."],"~$legacy-default-join-alias",["^ ","^5",["^ ","^6","metabase/lib/convert.cljc","^7",105,"^8",6,"^9",105,"^:",31],"^I","^4=","^6","metabase/lib/convert.cljc","^:",31,"^8",1,"^7",105,"^9",105,"^;D","~$string","^;6","In legacy MBQL, join `:alias` was optional, and if unspecified, this was the default alias used. In reality all joins\n  normally had an explicit `:alias` since the QB would generate one and you generally need one to do useful things\n  with the join anyway.\n\n  Since the new pMBQL schema makes `:alias` required, we'll explicitly add the implicit default when we encounter a\n  join without an alias, and remove it so we can round-trip without changes."],"~$deduplicate-join-aliases",["^ ","^;1",null,"^5",["^ ","^6","metabase/lib/convert.cljc","^7",114,"^8",8,"^9",114,"^:",32,"^;2",true,"^;3",["^1D",["^;4",["^1D",[["~$joins"]]]]],"^;6","Join `:alias`es had to be unique in legacy MBQL, but they were optional. Since we add [[legacy-default-join-alias]]\n  to each join that doesn't have an explicit `:alias` for pMBQL compatibility now, we need to deduplicate the aliases\n  if it is used more than once.\n\n  Only deduplicate the default `__join` aliases; we don't want the [[lib.util/unique-name-generator]] to touch other\n  aliases and truncate them or anything like that."],"^;2",true,"^I","^43","^6","metabase/lib/convert.cljc","^:",32,"^;7",["^1D",[["^;U"]]],"^;8",null,"^;9",["^1D",[null,null]],"^8",1,"^;:",false,"^7",114,"^;;","^;<","^9",114,"^;>",1,"^;?",true,"^;3",["^1D",["^;4",["^1D",[["^;U"]]]]],"^;6","Join `:alias`es had to be unique in legacy MBQL, but they were optional. Since we add [[legacy-default-join-alias]]\n  to each join that doesn't have an explicit `:alias` for pMBQL compatibility now, we need to deduplicate the aliases\n  if it is used more than once.\n\n  Only deduplicate the default `__join` aliases; we don't want the [[lib.util/unique-name-generator]] to touch other\n  aliases and truncate them or anything like that."],"~$stage-source-card-id->pMBQL",["^ ","^;1",null,"^5",["^ ","^6","metabase/lib/convert.cljc","^7",128,"^8",8,"^9",128,"^:",35,"^;2",true,"^;3",["^1D",["^;4",["^1D",[["^;5"]]]]],"^;6","If a query `stage` has a legacy `card__<id>` `:source-table`, convert it to a pMBQL-style `:source-card`."],"^;2",true,"^I","^46","^6","metabase/lib/convert.cljc","^:",35,"^;7",["^1D",[["^;5"]]],"^;8",null,"^;9",["^1D",[null,null]],"^8",1,"^;:",false,"^7",128,"^;;",["^H",[null,"^;<","^;J"]],"^9",128,"^;>",1,"^;?",true,"^;3",["^1D",["^;4",["^1D",[["^;5"]]]]],"^;6","If a query `stage` has a legacy `card__<id>` `:source-table`, convert it to a pMBQL-style `:source-card`."],"~$->legacy-MBQL",["^ ","^5",["^ ","^6","metabase/lib/convert.cljc","^7",253,"^8",11,"^9",253,"^:",24,"^;3",["^1D",["^;4",["^1D",[["~$x"]]]]],"^;6","Coerce something to legacy MBQL (the version of MBQL understood by the query processor and Dashboard Lib v1) if it's\n  not already legacy MBQL."],"^I","^49","^6","metabase/lib/convert.cljc","^:",24,"^8",1,"^7",253,"^9",253,"^;D","^26","^;3",["^1D",["^;4",["^1D",[["~$x"]]]]],"^;6","Coerce something to legacy MBQL (the version of MBQL understood by the query processor and Dashboard Lib v1) if it's\n  not already legacy MBQL."],"~$*legacy-index->pMBQL-uuid*",["^ ","^5",["^ ","^6","metabase/lib/convert.cljc","^7",21,"^8",26,"^9",21,"^:",52,"~:dynamic",true,"^;2",true],"^;2",true,"^I","^2>","^6","metabase/lib/convert.cljc","^:",52,"^8",1,"^;Y",true,"^7",21,"^9",21,"^;D","^;="],"~$clean-location",["^ ","^;1",null,"^5",["^ ","^6","metabase/lib/convert.cljc","^7",24,"^8",8,"^9",24,"^:",22,"^;2",true,"^;3",["^1D",["^;4",["^1D",[["~$almost-stage","~$error-type","~$error-location"]]]]]],"^;2",true,"^I","^44","^6","metabase/lib/convert.cljc","^:",22,"^;7",["^1D",[["^;[","^<0","^<1"]]],"^;8",null,"^;9",["^1D",[null,null]],"^8",1,"^;:",false,"^7",24,"^;;",["^H",["^;<","^;=","^;J"]],"^9",24,"^;>",3,"^;?",true,"^;3",["^1D",["^;4",["^1D",[["^;[","^<0","^<1"]]]]]],"~$stage-keys",["^ ","^5",["^ ","^6","metabase/lib/convert.cljc","^7",43,"^8",16,"^9",43,"^:",26,"^;2",true],"^;2",true,"^I","^38","^6","metabase/lib/convert.cljc","^:",26,"^8",1,"^7",43,"^9",43,"^;D","~$cljs.core/ISet"],"~$*pMBQL-uuid->legacy-index*",["^ ","^5",["^ ","^6","metabase/lib/convert.cljc","^7",18,"^8",26,"^9",18,"^:",52,"^;Y",true,"^;2",true],"^;2",true,"^I","^25","^6","metabase/lib/convert.cljc","^:",52,"^8",1,"^;Y",true,"^7",18,"^9",18,"^;D","^;="],"~$clean-stage",["^ ","^;1",null,"^5",["^ ","^6","metabase/lib/convert.cljc","^7",46,"^8",8,"^9",46,"^:",19,"^;2",true,"^;3",["^1D",["^;4",["^1D",[["^;["]]]]]],"^;2",true,"^I","^28","^6","metabase/lib/convert.cljc","^:",19,"^;7",["^1D",[["^;["]]],"^;8",null,"^;9",["^1D",[null,null]],"^8",1,"^;:",false,"^7",46,"^;;","^;=","^9",46,"^;>",1,"^;?",true,"^;3",["^1D",["^;4",["^1D",[["^;["]]]]]],"~$->pMBQL",["^ ","^5",["^ ","^6","metabase/lib/convert.cljc","^7",78,"^8",11,"^9",78,"^:",18,"^;3",["^1D",["^;4",["^1D",[["~$x"]]]]],"^;6","Coerce something to pMBQL (the version of MBQL manipulated by Dashboard Lib v2) if it's not already pMBQL."],"^I","^2B","^6","metabase/lib/convert.cljc","^:",18,"^8",1,"^7",78,"^9",78,"^;D","^26","^;3",["^1D",["^;4",["^1D",[["~$x"]]]]],"^;6","Coerce something to pMBQL (the version of MBQL manipulated by Dashboard Lib v2) if it's not already pMBQL."],"~$default-MBQL-clause->pMBQL",["^ ","^;1",null,"^5",["^ ","^6","metabase/lib/convert.cljc","^7",84,"^8",8,"^9",84,"^:",34,"^;2",true,"^;3",["^1D",["^;4",["^1D",[["~$mbql-clause"]]]]]],"^;2",true,"^I","^30","^6","metabase/lib/convert.cljc","^:",34,"^;7",["^1D",[["^<8"]]],"^;8",null,"^;9",["^1D",[null,null]],"^8",1,"^;:",false,"^7",84,"^;;",["^H",[null,"^;<","^;=","^;J"]],"^9",84,"^;>",1,"^;?",true,"^;3",["^1D",["^;4",["^1D",[["^<8"]]]]]],"~$update-list->legacy-boolean-expression",["^ ","^;1",null,"^5",["^ ","^6","metabase/lib/convert.cljc","^7",398,"^8",8,"^9",398,"^:",46,"^;2",true,"^;3",["^1D",["^;4",["^1D",[["~$m","~$pMBQL-key","~$legacy-key"]]]]]],"^;2",true,"^I","^31","^6","metabase/lib/convert.cljc","^:",46,"^;7",["^1D",[["~$m","^<:","^<;"]]],"^;8",null,"^;9",["^1D",[null,null]],"^8",1,"^;:",false,"^7",398,"^;;",["^H",[null,"^;="]],"^9",398,"^;>",3,"^;?",true,"^;3",["^1D",["^;4",["^1D",[["~$m","^<:","^<;"]]]]]],"~$clause-with-options->legacy-MBQL",["^ ","^;1",null,"^5",["^ ","^6","metabase/lib/convert.cljc","^7",293,"^8",8,"^9",293,"^:",40,"^;2",true,"^;3",["^1D",["^;4",["^1D",[[["~$k","~$options","~$&","~$args"]]]]]]],"^;2",true,"^I","^2W","^6","metabase/lib/convert.cljc","^:",40,"^;7",["^1D",[["~$p__48856"]]],"^;8",null,"^;9",["^1D",[null,null]],"^8",1,"^;:",false,"^7",293,"^;;",["^H",[null,"^;<","^;="]],"^9",293,"^;>",1,"^;?",true,"^;3",["^1D",["^;4",["^1D",[[["~$k","^<=","~$&","^<>"]]]]]]],"~$aggregation->legacy-MBQL",["^ ","^;1",null,"^5",["^ ","^6","metabase/lib/convert.cljc","^7",282,"^8",8,"^9",282,"^:",32,"^;2",true,"^;3",["^1D",["^;4",["^1D",[[["~$tag","^<=","~$&","^<>"]]]]]]],"^;2",true,"^I","^21","^6","metabase/lib/convert.cljc","^:",32,"^;7",["^1D",[["~$p__48849"]]],"^;8",null,"^;9",["^1D",[null,null]],"^8",1,"^;:",false,"^7",282,"^;;",["^H",["^;<","~$cljs.core/IVector","^;="]],"^9",282,"^;>",1,"^;?",true,"^;3",["^1D",["^;4",["^1D",[[["^<A","^<=","~$&","^<>"]]]]]]],"~$stage-metadata->legacy-metadata",["^ ","^;1",null,"^5",["^ ","^6","metabase/lib/convert.cljc","^7",333,"^8",8,"^9",333,"^:",39,"^;2",true,"^;3",["^1D",["^;4",["^1D",[["~$stage-metadata"]]]]]],"^;2",true,"^I","^22","^6","metabase/lib/convert.cljc","^:",39,"^;7",["^1D",[["^<E"]]],"^;8",null,"^;9",["^1D",[null,null]],"^8",1,"^;:",false,"^7",333,"^;;","^;=","^9",333,"^;>",1,"^;?",true,"^;3",["^1D",["^;4",["^1D",[["^<E"]]]]]]],"^1B",["^ ","^S","^T","^W","^X","~$u","^[","^10","^11","^?","^?","^T","^T","^11","^11","^[","^[","^X","^X"],"~:cljs.analyzer/constants",["^ ","^1?",["^H",["~:lib/uuid","~:ceil","~:database_type","~:semantic_type","~:lib/type","~:get-quarter","~:min","~:errors","~:upper","~:*","~:ltrim","~:base-type","~:expression","~:substring","~:stages","~:template-tags","~:semantic-type","~:stddev","~:now","~:metabase.lib.convert/not-found","~:else","~:source-query","~:metabase.lib.convert/aggregation","~:replace","~:convert-timezone","~:get-minute","~:filters","~:yellow","~:sqrt","~:metabase.lib.convert/aggregation-or-expression","~:default","~:concat","~:count-where","~:warn","~:columns","~:m","~:-","~:value","~:time","~:exp","~:fields","~:mbql/query","~:lib/stage-metadata","~:joins","~:get-hour","~:get-week","~:source-metadata","~:sum-where","~:field","~:type","~:coalesce","~:regexextract","~:/","~:database-type","~:mbql/join","~:effective-type","~:k","~:absolute-datetime","~:distinct","~:round","~:percentile","~:datetime-subtract","~:dispatch-type/sequential","~:power","~:alias","~:mbql.stage/native","~:get-second","~:filter","~:malli.core/missing-key","~:native","~:dispatch-type/map","~:conditions","~:aggregation-options","~:+","~:abs","~:datetime-add","~:median","~:share","~:max","~:condition","~:case","~:red","~:source-table","~:expressions","~:lower","~:get-month","~:count","~:malli.core/end-of-input","~:breakout","~:length","~:get-year","~:order-by","~:dimension","~:mbql.stage/mbql","~:and","~:database","~:trim","~:avg","~:aggregation","~:interval","~:get-day","~:source-card","~:regex-match-first","~:query","~:hierarchy","~:metabase.lib.schema/stage.mbql","~:parameters","~:log","~:floor","~:relative-datetime","~:always","~:sum","~:metabase.lib.convert/expression","~:base_type","~:in","~:rtrim"]],"~:order",["^=Z","^>@","^<Z","^=4","^=@","^=C","^><","^>A","^>D","^>K","^=I","^>[","^<N","^>R","^=;","^=5","^>:","^<T","^>Q","^=8","^=A","^=V","^>;","^>N","^>F","^<G","^=W","^<U","^>E","^=M","^>1","^=T","^>0","^=H","^==","^>Z","^<J","^<I","^<Q","^<V","^=L","^=N","^>9","^>W","^<R","^<Y","~:m","~:k","^>2","^>H","^>P","^=[","^=0","^>Y","^=7","^>?","^>J","^=:","^=P","^>7","^>5","^<M","^=R","^>6","^<W","^>X","^=G","~:+","~:-","~:*","~:/","^=J","^>3","^>T","^=?","^=6","^<H","^>U","^=Q","^=U","^>L","^>V","^=>","^=O","^<X","^=2","^=E","^>C","^>>","^>M","^=D","^=3","^=X","^<L","^>4","^=S","^=9","^<S","^=1","^=K","^>O","^>B","^>I","^<P","^?0","^<O","^>=","^=<","^<[","^=F","^=B","^>G","^>8","^=Y","^>S","^<K"]],"^1G",["^ ","^1@",["^H",[]]],"^1H",["^ "],"^1I",["^13","^?","^Z","^R","^1>","^T","^V","^19","^1<","^18","^16","^P","^11","^12","^[","^X"]],"^M","^J","~:ns-specs",["^ "],"~:ns-spec-vars",["^H",[]],"~:compiler-options",["^4B",[["^?4","~:static-fns"],true,["^?4","~:shadow-tweaks"],null,["^?4","~:source-map-inline"],null,["^?4","~:elide-asserts"],true,["^?4","~:optimize-constants"],null,["^?4","^1N"],null,["^?4","~:external-config"],null,["^?4","~:tooling-config"],null,["^?4","~:emit-constants"],null,["^?4","~:load-tests"],false,["^?4","~:form-size-threshold"],null,["^?4","~:global-goog-object&array"],null,["^?4","~:data-readers"],null,["^?4","~:infer-externs"],"~:auto",["^?4","^1P"],["^H",["^1Q"]],["~:js-options","~:js-provider"],"^1@",["~:mode"],"~:release",["^?4","~:fn-invoke-direct"],null,["^?4","~:source-map"],null]]]