/*!
 * Core functionality for Snowplow Browser trackers v3.1.6 (http://bit.ly/sp-js)
 * Copyright 2021 Snowplow Analytics Ltd, 2010 Anthon Pang
 * Licensed under BSD-3-Clause
 */

"use strict";!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((e="undefined"!=typeof globalThis?globalThis:e||self).snowplowBrowserTrackerCore={})}(this,(function(e){function n(e,n,t){if(t||2===arguments.length)for(var r,o=0,i=n.length;o<i;o++)!r&&o in n||(r||(r=Array.prototype.slice.call(n,0,o)),r[o]=n[o]);return e.concat(r||n)}function t(e){var n={exports:{}};return e(n,n.exports),n.exports}function r(){var e,n={},t=[],r=[],i=function(e,t){null!=t&&""!==t&&(n[e]=t)};return{add:i,addDict:function(e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&i(n,e[n])},addJson:function(e,n,i){i&&o(i)&&(e={keyIfEncoded:e,keyIfNotEncoded:n,json:i},r.push(e),t.push(e))},getPayload:function(){return n},getJson:function(){return t},withJsonProcessor:function(n){e=n},build:function(){return null==e||e(this,r),n}}}function o(e){if(!i(e))return!1;for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n))return!0;return!1}function i(e){return null!=e&&(e.constructor==={}.constructor||e.constructor===[].constructor)}function a(){var e=[],n=[];return{getGlobalPrimitives:function(){return e},getConditionalProviders:function(){return n},addGlobalContexts:function(t){for(var r=[],o=[],i=0;i<t.length;i++){var a=t[i];h(a)?r.push(a):g(a)&&o.push(a)}e=e.concat(o),n=n.concat(r)},clearGlobalContexts:function(){n=[],e=[]},removeGlobalContexts:function(t){for(var r=function(t){h(t)?n=n.filter((function(e){return JSON.stringify(e)!==JSON.stringify(t)})):g(t)&&(e=e.filter((function(e){return JSON.stringify(e)!==JSON.stringify(t)})))},o=0;o<t.length;o++)r(t[o])},getApplicableContexts:function(t){e:{for(var r=0,o=t.getJson();r<o.length;r++){var i=o[r];if("ue_px"===i.keyIfEncoded&&"object"==typeof i.json.data&&"string"==typeof(i=i.json.data.schema)){r=i;break e}}r=""}i="string"==typeof(o=t.getPayload().e)?o:"",o=[];var a=b(e,t,i,r);return o.push.apply(o,a),t=function(e,n,t,r){var o;return e=w(e).map((function(e){e:{if(p(e)){var o=e[0],i=!1;try{i=o({event:n.getPayload(),eventType:t,eventSchema:r})}catch(e){i=!1}if(!0===i){e=b(e[1],n,t,r);break e}}else if(v(e)&&function(e,n){var t=0,r=0,o=e.accept;return Array.isArray(o)?e.accept.some((function(e){return m(e,n)}))&&r++:"string"==typeof o&&m(o,n)&&r++,o=e.reject,Array.isArray(o)?e.reject.some((function(e){return m(e,n)}))&&t++:"string"==typeof o&&m(o,n)&&t++,0<r&&0===t}(e[0],r)){e=b(e[1],n,t,r);break e}e=[]}if(e&&0!==e.length)return e})),(o=[]).concat.apply(o,e.filter((function(e){return null!=e&&e.filter(Boolean)})))}(n,t,i,r),o.push.apply(o,t),o}}}function u(e){return!!((e=e.split("."))&&1<e.length)&&function(e){if("*"===e[0]||"*"===e[1])return!1;if(0<e.slice(2).length){var n=!1,t=0;for(e=e.slice(2);t<e.length;t++)if("*"===e[t])n=!0;else if(n)return!1;return!0}return 2==e.length}(e)}function c(e){if(null!==(e=/^iglu:((?:(?:[a-zA-Z0-9-_]+|\*).)+(?:[a-zA-Z0-9-_]+|\*))\/([a-zA-Z0-9-_.]+|\*)\/jsonschema\/([1-9][0-9]*|\*)-(0|[1-9][0-9]*|\*)-(0|[1-9][0-9]*|\*)$/.exec(e))&&u(e[1]))return e.slice(1,6)}function s(e){if(e=c(e)){var n=e[0];return 5===e.length&&u(n)}return!1}function l(e){return function(e){return Array.isArray(e)&&e.every((function(e){return"string"==typeof e}))}(e)?e.every((function(e){return s(e)})):"string"==typeof e&&s(e)}function f(e){return!!(o(e)&&"schema"in e&&"data"in e)&&("string"==typeof e.schema&&"object"==typeof e.data)}function d(e){return"function"==typeof e&&1>=e.length}function g(e){return d(e)||f(e)}function p(e){return!(!Array.isArray(e)||2!==e.length)&&(Array.isArray(e[1])?d(e[0])&&e[1].every(g):d(e[0])&&g(e[1]))}function v(e){return!(!Array.isArray(e)||2!==e.length)&&(!!function(e){var n=0;if(null!=e&&"object"==typeof e&&!Array.isArray(e)){if(Object.prototype.hasOwnProperty.call(e,"accept")){if(!l(e.accept))return!1;n+=1}if(Object.prototype.hasOwnProperty.call(e,"reject")){if(!l(e.reject))return!1;n+=1}return 0<n&&2>=n}return!1}(e[0])&&(Array.isArray(e[1])?e[1].every(g):g(e[1])))}function h(e){return p(e)||v(e)}function m(e,n){if(!s(e))return!1;if(e=c(e),n=null!==(n=/^iglu:([a-zA-Z0-9-_.]+)\/([a-zA-Z0-9-_]+)\/jsonschema\/([1-9][0-9]*)-(0|[1-9][0-9]*)-(0|[1-9][0-9]*)$/.exec(n))?n.slice(1,6):void 0,e&&n){if(!function(e,n){if(n=n.split("."),e=e.split("."),n&&e){if(n.length!==e.length)return!1;for(var t=0;t<e.length;t++)if(!y(n[t],e[t]))return!1;return!0}return!1}(e[0],n[0]))return!1;for(var t=1;5>t;t++)if(!y(e[t],n[t]))return!1;return!0}return!1}function y(e,n){return e&&n&&"*"===e||e===n}function w(e){return Array.isArray(e)?e:[e]}function b(e,n,t,r){var o;return e=w(e).map((function(e){e:if(f(e))e=[e];else{if(d(e)){n:{var o=void 0;try{if(o=e({event:n.getPayload(),eventType:t,eventSchema:r}),Array.isArray(o)&&o.every(f)||f(o)){var i=o;break n}i=void 0;break n}catch(e){}i=void 0}if(f(i)){e=[i];break e}if(Array.isArray(i)){e=i;break e}}e=void 0}if(e&&0!==e.length)return e})),(o=[]).concat.apply(o,e.filter((function(e){return null!=e&&e.filter(Boolean)})))}function S(e){void 0===e&&(e={});var n,t,r,o,u,c,s,l=e.base64,f=e.corePlugins,d=null!=f?f:[];n=null==l||l,t=d,r=e.callback,o=function(e){return{addPluginContexts:function(n){var t=null!=n?n:[];return e.forEach((function(e){try{e.contexts&&t.push.apply(t,e.contexts())}catch(e){le.error("Error adding plugin contexts",e)}})),t}}}(t),u=a(),c=n,s={};var g=Y(Y({},e={track:function(e,n,i){e.withJsonProcessor(function(e){return function(n,t){for(var r=0;r<t.length;r++){var o=t[r],i=JSON.stringify(o.json);if(e){var a=n,u=a.add;if(o=o.keyIfEncoded,i){var c=0,s=0,l=[];if(i){i=unescape(encodeURIComponent(i));do{var f=i.charCodeAt(c++),d=i.charCodeAt(c++),g=i.charCodeAt(c++),p=f<<16|d<<8|g;f=p>>18&63,d=p>>12&63,g=p>>6&63,p&=63,l[s++]=se.charAt(f)+se.charAt(d)+se.charAt(g)+se.charAt(p)}while(c<i.length);c=l.join(""),i=((i=i.length%3)?c.slice(0,i-3):c)+"===".slice(i||3)}i=i.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}u.call(a,o,i)}else n.add(o.keyIfNotEncoded,i)}t.length=0}}(c)),e.add("eid",ce.v4()),e.addDict(s),i=function(e){return null==e?{type:"dtm",value:(new Date).getTime()}:"number"==typeof e?{type:"dtm",value:e}:"ttm"===e.type?{type:"ttm",value:e.value}:{type:"dtm",value:e.value||(new Date).getTime()}}(i),e.add(i.type,i.value.toString()),void 0!==(n=(n=function(e,n){e=u.getApplicableContexts(e);var t=[];return n&&n.length&&t.push.apply(t,n),e&&e.length&&t.push.apply(t,e),t}(e,o.addPluginContexts(n)))&&n.length?{schema:"iglu:com.snowplowanalytics.snowplow/contexts/jsonschema/1-0-0",data:n}:void 0)&&e.addJson("cx","co",n),t.forEach((function(n){try{n.beforeTrack&&n.beforeTrack(e)}catch(e){le.error("Plugin beforeTrack",e)}})),"function"==typeof r&&r(e);var a=e.build();return t.forEach((function(e){try{e.afterTrack&&e.afterTrack(a)}catch(e){le.error("Plugin afterTrack",e)}})),a},addPayloadPair:function(e,n){s[e]=n},getBase64Encoding:function(){return c},setBase64Encoding:function(e){c=e},addPayloadDict:function(e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(s[n]=e[n])},resetPayloadPairs:function(e){s=i(e)?e:{}},setTrackerVersion:function(e){s.tv=e},setTrackerNamespace:function(e){s.tna=e},setAppId:function(e){s.aid=e},setPlatform:function(e){s.p=e},setUserId:function(e){s.uid=e},setScreenResolution:function(e,n){s.res=e+"x"+n},setViewport:function(e,n){s.vp=e+"x"+n},setColorDepth:function(e){s.cd=e},setTimezone:function(e){s.tz=e},setLang:function(e){s.lang=e},setIpAddress:function(e){s.ip=e},setUseragent:function(e){s.ua=e},addGlobalContexts:function(e){u.addGlobalContexts(e)},clearGlobalContexts:function(){u.clearGlobalContexts()},removeGlobalContexts:function(e){u.removeGlobalContexts(e)}}),{addPlugin:function(e){var n,t;e=e.plugin,d.push(e),null===(n=e.logger)||void 0===n||n.call(e,le),null===(t=e.activateCorePlugin)||void 0===t||t.call(e,g)}});return null==d||d.forEach((function(e){var n,t;null===(n=e.logger)||void 0===n||n.call(e,le),null===(t=e.activateCorePlugin)||void 0===t||t.call(e,g)})),g}function k(){try{return!!window.localStorage}catch(e){return!0}}function T(){if(!k())return!1;try{var e=window.localStorage;return e.setItem("modernizr","modernizr"),e.removeItem("modernizr"),!0}catch(e){return!1}}function x(){if("innerWidth"in window)var e=window.innerWidth,n=window.innerHeight;else e=(n=document.documentElement||document.body).clientWidth,n=n.clientHeight;return 0<=e&&0<=n?e+"x"+n:null}function A(){var e=document.documentElement,n=document.body,t=Math.max(e.clientWidth,e.offsetWidth,e.scrollWidth);return e=Math.max(e.clientHeight,e.offsetHeight,e.scrollHeight,n?Math.max(n.offsetHeight,n.scrollHeight):0),isNaN(t)||isNaN(e)?"":t+"x"+e}function P(e){return!(!e||"string"!=typeof e.valueOf())}function O(e){return Number.isInteger&&Number.isInteger(e)||"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}function I(e){if(!P(e)){e=e.text||"";var n=document.getElementsByTagName("title");n&&null!=n[0]&&(e=n[0].text)}return e}function C(e){var n=/^(?:(?:https?|ftp):)\/*(?:[^@]+@)?([^:/#]+)/.exec(e);return n?n[1]:e}function D(e){var n=e.length;return"."===e.charAt(--n)&&(e=e.slice(0,n)),"*."===e.slice(0,2)&&(e=e.slice(1)),e}function N(e){var n=window,t="",r=L("referrer",n.location.href)||L("referer",n.location.href);if(r)return r;if(e)return e;try{t=n.top.document.referrer}catch(e){if(n.parent)try{t=n.parent.document.referrer}catch(e){t=""}}return""===t&&(t=document.referrer),t}function E(e,n,t,r){return e.addEventListener?(e.addEventListener(n,t,r),!0):e.attachEvent?e.attachEvent("on"+n,t):void(e["on"+n]=t)}function L(e,n){return(e=new RegExp("^[^#]*[?&]"+e+"=([^&#]*)").exec(n))?decodeURIComponent(e[1].replace(/\+/g," ")):null}function j(e,n,t){t=n+"="+t;var r=(e=e.split("#"))[0].split("?"),o=r.shift();if(r=r.join("?")){for(var i=!0,a=r.split("&"),u=0;u<a.length;u++)if(a[u].substr(0,n.length+1)===n+"="){i=!1,a[u]=t,r=a.join("&");break}i&&(r=t+"&"+r)}else r=t;return e[0]=o+"?"+r,e.join("#")}function B(e){try{var n=window.localStorage,t=n.getItem(e+".expires");if(null===t||+t>Date.now())return n.getItem(e);n.removeItem(e),n.removeItem(e+".expires")}catch(e){}}function M(e,n,t){void 0===t&&(t=63072e3);try{var r=window.localStorage,o=Date.now()+1e3*t;return r.setItem(e+".expires",o.toString()),r.setItem(e,n),!0}catch(e){return!1}}function U(e){try{var n=window.localStorage;return n.removeItem(e),n.removeItem(e+".expires"),!0}catch(e){return!1}}function _(e,n){for(var t=window.location.hostname,r="_sp_root_domain_test_"+(new Date).getTime(),o="_test_value_"+(new Date).getTime(),i=t.split("."),a=i.length-1;0<=a;){var u=i.slice(a,i.length).join(".");if(z(r,o,0,"/",u,e,n),z(r)===o){for(V(r,u,e,n),t=R("_sp_root_domain_test_"),r=0;r<t.length;r++)V(t[r],u,e,n);return u}--a}return t}function V(e,n,t,r){z(e,"",-1,"/",n,t,r)}function R(e){for(var n=document.cookie.split("; "),t=[],r=0;r<n.length;r++)n[r].substring(0,e.length)===e&&t.push(n[r]);return t}function z(e,n,t,r,o,i,a){return 1<arguments.length?document.cookie=e+"="+encodeURIComponent(null!=n?n:"")+(t?"; Expires="+new Date(+new Date+1e3*t).toUTCString():"")+(r?"; Path="+r:"")+(o?"; Domain="+o:"")+(i?"; SameSite="+i:"")+(a?"; Secure":""):decodeURIComponent((("; "+document.cookie).split("; "+e+"=")[1]||"").split(";")[0])}function H(e){return e.className.match(/\S+/g)||[]}function J(e,n){return e.hasOwnProperty("filter")&&e.filter?e.filter:n}function F(e){var n={};if(e=e.allowlist||e.denylist){Array.isArray(e)||(e=[e]);for(var t=0;t<e.length;t++)n[e[t]]=!0}return n}function G(e,n,t,r,o,i,a,u,c,s,l){function f(e){for(var n=0,t=0;t<e.length;t++){var r=e.charCodeAt(t);127>=r?n+=1:2047>=r?n+=2:55296<=r&&57343>=r?(n+=4,t++):n=65535>r?n+3:n+4}return n}function d(e){for(void 0===e&&(e=!1);k.length&&"string"!=typeof k[0]&&"object"!=typeof k[0];)k.shift();if(1>k.length)S=!1;else{if(!P(m))throw"No collector configured";if(S=!0,O){var n=function(e){for(var n=0,t=0;n<e.length&&!((t+=e[n].bytes)>=a);)n+=1;return n},r=void 0;if(E(k))var o=g(r=m,!0,e),i=n(k);else r=h(k[0]),o=g(r,!1,e),i=1;var u=setTimeout((function(){o.abort(),S=!1}),s),f=function(e){for(var n=0;n<e;n++)k.shift();t&&M(D,JSON.stringify(k.slice(0,c))),d()};if(o.onreadystatechange=function(){4===o.readyState&&200<=o.status&&400>o.status?(clearTimeout(u),f(i)):4===o.readyState&&400<=o.status&&(clearTimeout(u),S=!1)},E(k)){if(0<(n=k.slice(0,i)).length){if(e=!1,n=n.map((function(e){return e.evt})),A){var y=new Blob([p(v(n))],{type:"application/json"});try{e=navigator.sendBeacon(r,y)}catch(n){e=!1}}!0===e?f(i):o.send(p(v(n)))}}else o.send()}else if(l||E(k))S=!1;else{r=new Image(1,1);var w=!0;r.onload=function(){w&&(w=!1,k.shift(),t&&M(D,JSON.stringify(k.slice(0,c))),d())},r.onerror=function(){w&&(S=w=!1)},r.src=h(k[0]),setTimeout((function(){w&&S&&(w=!1,d())}),s)}}}function g(e,n,t){var r=new XMLHttpRequest;return n?(r.open("POST",e,!t),r.setRequestHeader("Content-Type","application/json; charset=UTF-8")):r.open("GET",e,!t),r.withCredentials=!0,l&&r.setRequestHeader("SP-Anonymous","*"),r}function p(e){return JSON.stringify({schema:"iglu:com.snowplowanalytics.snowplow/payload_data/jsonschema/1-0-4",data:e})}function v(e){for(var n=(new Date).getTime().toString(),t=0;t<e.length;t++)e[t].stm=n;return e}function h(e){return u?m+e.replace("?","?stm="+(new Date).getTime()+"&"):m+e}var m,y,w,b,S=!1,k=[],x=null===(r="string"==typeof r?r.toLowerCase():r)||!0===r||"beacon"===r||"true"===r,A=!(!(x&&window.navigator&&window.navigator.sendBeacon)||(y=window.navigator.userAgent,(b=(b=y).match("(iP.+; CPU .*OS (d+)[_d]*.*) AppleWebKit/"))&&b.length&&parseInt(b[0])<=13||function(e,n,t){return!(!(t=t.match("(Macintosh;.*Mac OS X (d+)_(d+)[_d]*.*) AppleWebKit/"))||!t.length)&&(parseInt(t[0])<=e||parseInt(t[0])===e&&parseInt(t[1])<=n)}(10,15,y)&&(w=y).match("Version/.* Safari/")&&!w.match("Chrom(e|ium)")))&&x,O=!(!window.XMLHttpRequest||!("withCredentials"in new XMLHttpRequest)),I="get"!==r&&O&&("post"===r||x),C=I?o:"/i",D="snowplowOutQueue_"+e+"_"+(I?"post2":"get");if(i=t&&T()&&I&&i||1,t)try{var N=window.localStorage.getItem(D);k=N?JSON.parse(N):[]}catch(y){}Array.isArray(k)||(k=[]),n.outQueues.push(k),O&&1<i&&n.bufferFlushers.push((function(e){S||d(e)}));var E=function(e){return"object"==typeof e[0]};return{enqueueRequest:function(e,n){if(m=n+C,I){if((e=function(e){var n=Object.keys(e).map((function(n){return[n,e[n]]})).reduce((function(e,n){return e[n[0]]=n[1].toString(),e}),{});return{evt:n,bytes:f(JSON.stringify(n))}}(e)).bytes>=a)return le.warn("Event ("+e.bytes+"B) too big, max is "+a),void g(m,!0,!1).send(p(v([e.evt])));k.push(e)}else{var r,o=(n=k).push,u="?",s={co:!0,cx:!0},l=!0;for(r in e)e.hasOwnProperty(r)&&!s.hasOwnProperty(r)&&(l?l=!1:u+="&",u+=encodeURIComponent(r)+"="+encodeURIComponent(e[r]));for(var h in s)e.hasOwnProperty(h)&&s.hasOwnProperty(h)&&(u+="&"+h+"="+encodeURIComponent(e[h]));o.call(n,u)}e=!1,t&&(e=M(D,JSON.stringify(k.slice(0,c)))),S||e&&!(k.length>=i)||d()},executeQueue:function(){S||d()},setUseLocalStorage:function(e){t=e},setAnonymousTracking:function(e){l=e},setCollectorUrl:function(e){m=e+C},setBufferSize:function(e){i=e}}}function W(e,n,t){return"translate.googleusercontent.com"===e?(""===t&&(t=n),e=C(n=null!=(e=(e=/^(?:https?|ftp)(?::\/*(?:[^?]+))([?][^#]+)/.exec(n))&&1<(null==e?void 0:e.length)?L("u",e[1]):null)?e:"")):"cc.bingj.com"!==e&&"webcache.googleusercontent.com"!==e||(e=C(n=document.links[0].href)),[e,n,t]}function q(e,n,t,o,i,a){var u;void 0===a&&(a={}),e=function(e,n,t,o,i,a){function u(){(ze=W(window.location.hostname,window.location.href,N()))[1]!==Je&&(Fe=N(Je)),He=D(ze[0]),Je=ze[1]}function c(e){var n=(new Date).getTime();null!=(e=e.currentTarget)&&e.href&&(e.href=j(e.href,"_sp",Be+"."+n))}function s(e){for(var n=0;n<document.links.length;n++){var t=document.links[n];!t.spDecorationEnabled&&e(t)&&(E(t,"click",c,!0),E(t,"mousedown",c,!0),t.spDecorationEnabled=!0)}}function l(e){if(Pe){var n=/#.*/;e=e.replace(n,"")}return Oe&&(n=/[{}]/g,e=e.replace(n,"")),e}function f(e){return(e=/^([a-z]+):/.exec(e))?e[1]:null}function d(e){return e=Ye+e+"."+je,"localStorage"==ln?B(e):"cookie"==ln||"cookieAndLocalStorage"==ln?z(e):void 0}function g(){u(),je=pe((Ke||He)+($e||"/")).slice(0,4)}function p(){Ce=(new Date).getTime()}function v(){var e=h(),n=e[0];n<De?De=n:n>Ne&&(Ne=n),(e=e[1])<Ee?Ee=e:e>Le&&(Le=e),p()}function h(){var e=document.documentElement;return e?[e.scrollLeft||window.pageXOffset,e.scrollTop||window.pageYOffset]:[0,0]}function m(){var e=h(),n=e[0];Ne=De=n,Le=Ee=e=e[1]}function y(){b(Ye+"ses."+je,"*",an)}function w(e,n,t,r,o,i){b(Ye+"id."+je,e+"."+n+"."+t+"."+r+"."+o+"."+i,on)}function b(e,n,t){sn&&!un||("localStorage"==ln?M(e,n,t):("cookie"==ln||"cookieAndLocalStorage"==ln)&&z(e,n,t,$e,Ke,en,nn))}function k(e){var n=Ye+"id."+je,t=Ye+"ses."+je;U(n),U(t),V(n,Ke,en,nn),V(t,Ke,en,nn),null!=e&&e.preserveSession||(Me=ce.v4(),dn=0),null!=e&&e.preserveUser||(Be=ce.v4(),Ue=null)}function T(e){e&&e.stateStorageStrategy&&(a.stateStorageStrategy=e.stateStorageStrategy,ln=be(a)),sn=!!a.anonymousTracking,un=Se(a),cn=ke(a),gn.setUseLocalStorage("localStorage"==ln||"cookieAndLocalStorage"==ln),gn.setAnonymousTracking(cn)}function P(){if(!sn||un){var e="none"!=ln&&!!d("ses"),n=R();n[1]?Be=n[1]:(Be=sn?"":ce.v4(),n[1]=Be),Me=n[6],e||(n[3]++,Me=ce.v4(),n[6]=Me,n[5]=n[4]),"none"!=ln&&(y(),n[4]=Math.round((new Date).getTime()/1e3),n.shift(),w.apply(null,n))}}function R(){if("none"==ln)return[];var e=Math.round((new Date).getTime()/1e3),n=d("id");return n?(e=n.split(".")).unshift("0"):e=["1",Be,e,0,e,""],e[6]&&"undefined"!==e[6]||(e[6]=ce.v4()),e}function H(e){return 0===e.indexOf("http")?e:("https:"===document.location.protocol?"https":"http")+"://"+e}function J(){pn&&null!=i.pageViewId||(i.pageViewId=ce.v4())}function F(){return null==i.pageViewId&&(i.pageViewId=ce.v4()),i.pageViewId}function q(e){var n=e.title,t=e.context,o=e.timestamp;if(e=e.contextCallback,u(),vn&&J(),vn=!0,Xe=document.title,n=I((Ae=n)||Xe),_e.track(function(e){var n=e.pageUrl,t=e.pageTitle;e=e.referrer;var o=r();return o.add("e","pv"),o.add("url",n),o.add("page",t),o.add("refr",e),o}({pageUrl:l(xe||Je),pageTitle:n,referrer:l(Te||Fe)}),(t||[]).concat(e?e():[]),o),o=new Date,n=!1,hn.enabled&&!hn.installed){n=hn.installed=!0;var i={update:function(){if("undefined"!=typeof window&&"function"==typeof window.addEventListener){var e=!1,n=Object.defineProperty({},"passive",{get:function(){e=!0},set:function(){}}),t=function(){};window.addEventListener("testPassiveEventSupport",t,n),window.removeEventListener("testPassiveEventSupport",t,n),i.hasSupport=e}}};i.update();var a="onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll";Object.prototype.hasOwnProperty.call(i,"hasSupport")?E(document,a,p,{passive:!0}):E(document,a,p),m(),a=function(e,n){return void 0===n&&(n=p),function(e){return E(document,e,n)}},"click mouseup mousedown mousemove keypress keydown keyup".split(" ").forEach(a(document)),["resize","focus","blur"].forEach(a(window)),a(window,v)("scroll")}if(hn.enabled&&(Ze||n))for(o in Ce=o.getTime(),o=void 0,hn.configurations)(n=hn.configurations[o])&&(window.clearInterval(n.activityInterval),Q(n,t,e))}function Q(e,n,t){var r=function(e,n){u(),e({context:n,pageViewId:F(),minXOffset:De,minYOffset:Ee,maxXOffset:Ne,maxYOffset:Le}),m()},o=function(){Ce+e.configHeartBeatTimer>(new Date).getTime()&&r(e.callback,(n||[]).concat(t?t():[]))};e.activityInterval=0!=e.configMinimumVisitLength?window.setTimeout((function(){Ce+e.configMinimumVisitLength>(new Date).getTime()&&r(e.callback,(n||[]).concat(t?t():[])),e.activityInterval=window.setInterval(o,e.configHeartBeatTimer)}),e.configMinimumVisitLength):window.setInterval(o,e.configHeartBeatTimer)}function X(e){var n=e.minimumVisitLength,t=e.heartbeatDelay;if(e=e.callback,O(n)&&O(t))return{configMinimumVisitLength:1e3*n,configHeartBeatTimer:1e3*t,callback:e};le.error("Activity tracking minimumVisitLength & heartbeatDelay must be integers")}function Z(e){var n=e.context,t=e.minXOffset,o=e.minYOffset,i=e.maxXOffset,a=e.maxYOffset;(e=document.title)!==Xe&&(Xe=e,Ae=void 0);var u=(e=_e).track,c=l(xe||Je),s=I(Ae||Xe),f=l(Te||Fe);t=Math.round(t),i=Math.round(i),o=Math.round(o),a=Math.round(a);var d=r();d.add("e","pp"),d.add("url",c),d.add("page",s),d.add("refr",f),t&&!isNaN(Number(t))&&d.add("pp_mix",t.toString()),i&&!isNaN(Number(i))&&d.add("pp_max",i.toString()),o&&!isNaN(Number(o))&&d.add("pp_miy",o.toString()),a&&!isNaN(Number(a))&&d.add("pp_may",a.toString()),u.call(e,d,n)}var K,$,ee,ne,te,re,oe,ie,ae,ue,se,fe,de,ge,ve,he,me,ye,we;a.eventMethod=null!==(K=a.eventMethod)&&void 0!==K?K:"post";var be=function(e){var n;return null!==(n=e.stateStorageStrategy)&&void 0!==n?n:"cookieAndLocalStorage"},Se=function(e){var n,t;return"boolean"!=typeof e.anonymousTracking&&(null!==(t=!0===(null===(n=e.anonymousTracking)||void 0===n?void 0:n.withSessionTracking))&&void 0!==t&&t)},ke=function(e){var n,t;return"boolean"!=typeof e.anonymousTracking&&(null!==(t=!0===(null===(n=e.anonymousTracking)||void 0===n?void 0:n.withServerAnonymisation))&&void 0!==t&&t)};a.plugins=null!==($=a.plugins)&&void 0!==$?$:[],(null===(ne=null===(ee=null==a?void 0:a.contexts)||void 0===ee?void 0:ee.webPage)||void 0===ne||ne)&&a.plugins.push({contexts:function(){return[{schema:"iglu:com.snowplowanalytics.snowplow/web_page/jsonschema/1-0-0",data:{id:F()}}]}});var Te,xe,Ae,Pe,Oe,Ie,Ce,De,Ne,Ee,Le,je,Be,Me,Ue,_e=S({base64:a.encodeBase64,corePlugins:a.plugins,callback:function(e){var n=Math.round((new Date).getTime()/1e3),t=d("ses"),r=R(),o=r[0],i=r[1],a=r[2],c=r[3],s=r[4],f=r[5];r=r[6];var g=!!Ie&&!!z(Ie);rn||g?k():("0"===o?(Me=r,t||"none"==ln||(c++,f=s,Me=ce.v4()),dn=c):(new Date).getTime()-fn>1e3*an&&(Me=ce.v4(),dn++),e.add("vp",x()),e.add("ds",A()),e.add("vid",un?dn:sn?null:dn),e.add("sid",un?Me:sn?null:Me),e.add("duid",sn?null:i),e.add("uid",sn?null:Ue),u(),e.add("refr",l(Te||Fe)),e.add("url",l(xe||Je)),"none"!=ln&&(w(i,a,dn,n,f,Me),y()),fn=(new Date).getTime()),n=!!Ie&&!!z(Ie),rn||n||gn.enqueueRequest(e.build(),We)}}),Ve=navigator.userLanguage||navigator.language,Re=document.characterSet||document.charset,ze=W(window.location.hostname,window.location.href,N()),He=D(ze[0]),Je=ze[1],Fe=ze[2],Ge=null!==(te=a.platform)&&void 0!==te?te:"web",We=H(o),qe=null!==(re=a.postPath)&&void 0!==re?re:"/com.snowplowanalytics.snowplow/tp2",Qe=null!==(oe=a.appId)&&void 0!==oe?oe:"",Xe=document.title,Ze=null===(ie=a.resetActivityTrackingOnPageView)||void 0===ie||ie,Ye=null!==(ae=a.cookieName)&&void 0!==ae?ae:"_sp_",Ke=null!==(ue=a.cookieDomain)&&void 0!==ue?ue:void 0,$e="/",en=null!==(se=a.cookieSameSite)&&void 0!==se?se:"None",nn=null===(fe=a.cookieSecure)||void 0===fe||fe,tn=navigator.doNotTrack||navigator.msDoNotTrack||window.doNotTrack,rn=void 0!==a.respectDoNotTrack&&(a.respectDoNotTrack&&("yes"===tn||"1"===tn)),on=null!==(de=a.cookieLifetime)&&void 0!==de?de:63072e3,an=null!==(ge=a.sessionCookieTimeout)&&void 0!==ge?ge:1800,un=Se(a),cn=ke(a),sn=!!a.anonymousTracking,ln=be(a),fn=(new Date).getTime(),dn=1,gn=G(e,i,"localStorage"==ln||"cookieAndLocalStorage"==ln,a.eventMethod,qe,null!==(ve=a.bufferSize)&&void 0!==ve?ve:1,null!==(he=a.maxPostBytes)&&void 0!==he?he:4e4,null===(me=a.useStm)||void 0===me||me,null!==(ye=a.maxLocalStorageQueueSize)&&void 0!==ye?ye:1e3,null!==(we=a.connectionTimeout)&&void 0!==we?we:5e3,cn),pn=!1,vn=!1,hn={enabled:!1,installed:!1,configurations:{}};return a.hasOwnProperty("discoverRootDomain")&&a.discoverRootDomain&&(Ke=_(en,nn)),_e.setTrackerVersion(t),_e.setTrackerNamespace(n),_e.setAppId(Qe),_e.setPlatform(Ge),_e.addPayloadPair("cookie",navigator.cookieEnabled?"1":"0"),_e.addPayloadPair("cs",Re),_e.addPayloadPair("lang",Ve),_e.addPayloadPair("res",screen.width+"x"+screen.height),_e.addPayloadPair("cd",screen.colorDepth),g(),P(),a.crossDomainLinker&&s(a.crossDomainLinker),Y(Y({},{getDomainSessionIndex:function(){return dn},getPageViewId:function(){return F()},newSession:function(){var e=Math.round((new Date).getTime()/1e3),n=R(),t=n[1],r=n[2],o=n[3],i=n[4],a=n[5],u=n[6];"0"===n[0]?(Me=u,"none"!=ln&&(o++,a=i,Me=ce.v4()),dn=o,y()):(Me=ce.v4(),dn++),"none"!=ln&&(w(t,r,dn,e,a,Me),y()),fn=(new Date).getTime()},getCookieName:function(e){return Ye+e+"."+je},getUserId:function(){return Ue},getDomainUserId:function(){return R()[1]},getDomainUserInfo:function(){return R()},setReferrerUrl:function(e){Te=e},setCustomUrl:function(e){u();var n,t=Je;f(e)?xe=e:"/"===e.slice(0,1)?xe=f(t)+"://"+C(t)+e:(0<=(n=(t=l(t)).indexOf("?"))&&(t=t.slice(0,n)),(n=t.lastIndexOf("/"))!==t.length-1&&(t=t.slice(0,n+1)),xe=t+e)},setDocumentTitle:function(e){Xe=document.title,Ae=e},discardHashTag:function(e){Pe=e},discardBrace:function(e){Oe=e},setCookiePath:function(e){$e=e,g()},setVisitorCookieTimeout:function(e){on=e},crossDomainLinker:function(e){s(e)},enableActivityTracking:function(e){hn.configurations.pagePing||(hn.enabled=!0,hn.configurations.pagePing=X(Y(Y({},e),{callback:Z})))},enableActivityTrackingCallback:function(e){hn.configurations.callback||(hn.enabled=!0,hn.configurations.callback=X(e))},updatePageActivity:function(){p()},setOptOutCookie:function(e){Ie=e},setUserId:function(e){Ue=e},setUserIdFromLocation:function(e){u(),Ue=L(e,Je)},setUserIdFromReferrer:function(e){u(),Ue=L(e,Fe)},setUserIdFromCookie:function(e){Ue=z(e)},setCollectorUrl:function(e){We=H(e),gn.setCollectorUrl(We)},setBufferSize:function(e){gn.setBufferSize(e)},flushBuffer:function(e){void 0===e&&(e={}),gn.executeQueue(),e.newBufferSize&&gn.setBufferSize(e.newBufferSize)},trackPageView:function(e){void 0===e&&(e={}),q(e)},preservePageViewId:function(){pn=!0},disableAnonymousTracking:function(e){a.anonymousTracking=!1,T(e),P(),gn.executeQueue()},enableAnonymousTracking:function(e){var n;a.anonymousTracking=null===(n=e&&(null==e?void 0:e.options))||void 0===n||n,T(e),un||J()},clearUserData:k}),{id:e,namespace:n,core:_e,sharedState:i})}(e,n,t,o,i,a);var c=Y(Y({},e),{addPlugin:function(e){var n,t;c.core.addPlugin(e),null===(t=(n=e.plugin).activateBrowserPlugin)||void 0===t||t.call(n,c)}});return null===(u=a.plugins)||void 0===u||u.forEach((function(e){var n;null===(n=e.activateBrowserPlugin)||void 0===n||n.call(e,c)})),c}function Q(e){return Z(e,ve)}function X(){return Object.keys(ve)}function Z(e,n){for(var t=[],r=0;r<e.length;r++){var o=e[r];n.hasOwnProperty(o)?t.push(n[o]):le.warn(o+" not configured")}return t}for(var Y=function(){return(Y=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e}).apply(this,arguments)},K=t((function(e){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var t=new Uint8Array(16);e.exports=function(){return n(t),t}}else{var r=Array(16);e.exports=function(){for(var e,n=0;16>n;n++)0==(3&n)&&(e=4294967296*Math.random()),r[n]=e>>>((3&n)<<3)&255;return r}}})),$=[],ee=0;256>ee;++ee)$[ee]=(ee+256).toString(16).substr(1);var ne,te,re=function(e,n){return n=n||0,[$[e[n++]],$[e[n++]],$[e[n++]],$[e[n++]],"-",$[e[n++]],$[e[n++]],"-",$[e[n++]],$[e[n++]],"-",$[e[n++]],$[e[n++]],"-",$[e[n++]],$[e[n++]],$[e[n++]],$[e[n++]],$[e[n++]],$[e[n++]]].join("")},oe=0,ie=0;(ee=function(e,n,t){if(t=n&&t||0,"string"==typeof e&&(n="binary"===e?Array(16):null,e=null),(e=(e=e||{}).random||(e.rng||K)())[6]=15&e[6]|64,e[8]=63&e[8]|128,n)for(var r=0;16>r;++r)n[t+r]=e[r];return n||re(e)}).v1=function(e,n,t){t=n&&t||0;var r=n||[],o=(e=e||{}).node||ne,i=void 0!==e.clockseq?e.clockseq:te;if(null==o||null==i){var a=K();null==o&&(o=ne=[1|a[0],a[1],a[2],a[3],a[4],a[5]]),null==i&&(i=te=16383&(a[6]<<8|a[7]))}a=void 0!==e.msecs?e.msecs:(new Date).getTime();var u=void 0!==e.nsecs?e.nsecs:ie+1,c=a-oe+(u-ie)/1e4;if(0>c&&void 0===e.clockseq&&(i=i+1&16383),(0>c||a>oe)&&void 0===e.nsecs&&(u=0),1e4<=u)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");for(oe=a,ie=u,te=i,e=(1e4*(268435455&(a+=122192928e5))+u)%4294967296,r[t++]=e>>>24&255,r[t++]=e>>>16&255,r[t++]=e>>>8&255,r[t++]=255&e,e=a/4294967296*1e4&268435455,r[t++]=e>>>8&255,r[t++]=255&e,r[t++]=e>>>24&15|16,r[t++]=e>>>16&255,r[t++]=i>>>8|128,r[t++]=255&i,i=0;6>i;++i)r[t+i]=o[i];return n||re(r)};var ae,ue,ce=ee.v4=ee,se="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";(ue=ae||(ae={}))[ue.none=0]="none",ue[ue.error=1]="error",ue[ue.warn=2]="warn",ue[ue.debug=3]="debug",ue[ue.info=4]="info";var le=function(e){return void 0===e&&(e=ae.warn),{setLogLevel:function(n){e=ae[n]?n:ae.warn},warn:function(t,r){for(var o=[],i=2;i<arguments.length;i++)o[i-2]=arguments[i];e>=ae.warn&&"undefined"!=typeof console&&(i="Snowplow: "+t,r?console.warn.apply(console,n([i+"\n",r],o)):console.warn.apply(console,n([i],o)))},error:function(t,r){for(var o=[],i=2;i<arguments.length;i++)o[i-2]=arguments[i];e>=ae.error&&"undefined"!=typeof console&&(i="Snowplow: "+t+"\n",r?console.error.apply(console,n([i+"\n",r],o)):console.error.apply(console,n([i],o)))},debug:function(t){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];e>=ae.debug&&"undefined"!=typeof console&&console.debug.apply(console,n(["Snowplow: "+t],r))},info:function(t){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];e>=ae.info&&"undefined"!=typeof console&&console.info.apply(console,n(["Snowplow: "+t],r))}}}(),fe=t((function(e){var n;n={rotl:function(e,n){return e<<n|e>>>32-n},rotr:function(e,n){return e<<32-n|e>>>n},endian:function(e){if(e.constructor==Number)return 16711935&n.rotl(e,8)|4278255360&n.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=n.endian(e[t]);return e},randomBytes:function(e){for(var n=[];0<e;e--)n.push(Math.floor(256*Math.random()));return n},bytesToWords:function(e){for(var n=[],t=0,r=0;t<e.length;t++,r+=8)n[r>>>5]|=e[t]<<24-r%32;return n},wordsToBytes:function(e){for(var n=[],t=0;t<32*e.length;t+=8)n.push(e[t>>>5]>>>24-t%32&255);return n},bytesToHex:function(e){for(var n=[],t=0;t<e.length;t++)n.push((e[t]>>>4).toString(16)),n.push((15&e[t]).toString(16));return n.join("")},hexToBytes:function(e){for(var n=[],t=0;t<e.length;t+=2)n.push(parseInt(e.substr(t,2),16));return n},bytesToBase64:function(e){for(var n=[],t=0;t<e.length;t+=3)for(var r=e[t]<<16|e[t+1]<<8|e[t+2],o=0;4>o;o++)8*t+6*o<=8*e.length?n.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r>>>6*(3-o)&63)):n.push("=");return n.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var n=[],t=0,r=0;t<e.length;r=++t%4)0!=r&&n.push(("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(e.charAt(t-1))&Math.pow(2,-2*r+8)-1)<<2*r|"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(e.charAt(t))>>>6-2*r);return n}},e.exports=n})),de={utf8:{stringToBytes:function(e){return de.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(de.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var n=[],t=0;t<e.length;t++)n.push(255&e.charCodeAt(t));return n},bytesToString:function(e){for(var n=[],t=0;t<e.length;t++)n.push(String.fromCharCode(e[t]));return n.join("")}}},ge=de,pe=t((function(e){var n,t,r;n=ge.utf8,t=ge.bin,(r=function(e,r){var o=fe.wordsToBytes,i=e;i.constructor==String?i=n.stringToBytes(i):"undefined"!=typeof Buffer&&"function"==typeof Buffer.isBuffer&&Buffer.isBuffer(i)?i=Array.prototype.slice.call(i,0):Array.isArray(i)||(i=i.toString()),e=fe.bytesToWords(i);var a=8*i.length;i=[];var u=1732584193,c=-271733879,s=-1732584194,l=271733878,f=-1009589776;for(e[a>>5]|=128<<24-a%32,e[15+(a+64>>>9<<4)]=a,a=0;a<e.length;a+=16){for(var d=u,g=c,p=s,v=l,h=f,m=0;80>m;m++){if(16>m)i[m]=e[a+m];else{var y=i[m-3]^i[m-8]^i[m-14]^i[m-16];i[m]=y<<1|y>>>31}y=(u<<5|u>>>27)+f+(i[m]>>>0)+(20>m?1518500249+(c&s|~c&l):40>m?1859775393+(c^s^l):60>m?(c&s|c&l|s&l)-1894007588:(c^s^l)-899497514),f=l,l=s,s=c<<30|c>>>2,c=u,u=y}u+=d,c+=g,s+=p,l+=v,f+=h}return o=o.call(fe,[u,c,s,l,f]),r&&r.asBytes?o:r&&r.asString?t.bytesToString(o):fe.bytesToHex(o)})._blocksize=16,r._digestsize=20,e.exports=r})),ve={},he=function(){this.outQueues=[],this.bufferFlushers=[],this.hasLoaded=!1,this.registeredOnLoadHandlers=[]};e.SharedState=he,e.addEventListener=E,e.addTracker=function(e,n,t,r,o,i){return ve.hasOwnProperty(e)?null:(ve[e]=q(e,n,t,r,o,i),ve[e])},e.allTrackerNames=X,e.allTrackers=function(){return ve},e.attemptDeleteLocalStorage=U,e.attemptGetLocalStorage=B,e.attemptGetSessionStorage=function(e){try{return window.sessionStorage.getItem(e)}catch(e){}},e.attemptWriteLocalStorage=M,e.attemptWriteSessionStorage=function(e,n){try{return window.sessionStorage.setItem(e,n),!0}catch(e){return!1}},e.cookie=z,e.createSharedState=function(){function e(){var e;if(!n.hasLoaded)for(n.hasLoaded=!0,e=0;e<n.registeredOnLoadHandlers.length;e++)n.registeredOnLoadHandlers[e]();return!0}var n=new he,t=document,r=window;return t.visibilityState&&E(t,"visibilitychange",(function(){"hidden"==t.visibilityState&&n.bufferFlushers.forEach((function(e){e(!1)}))}),!1),E(r,"beforeunload",(function(){n.bufferFlushers.forEach((function(e){e(!1)}))}),!1),"loading"===document.readyState?(t.addEventListener?t.addEventListener("DOMContentLoaded",(function n(){t.removeEventListener("DOMContentLoaded",n,!1),e()})):t.attachEvent&&t.attachEvent("onreadystatechange",(function n(){"complete"===t.readyState&&(t.detachEvent("onreadystatechange",n),e())})),E(r,"load",e,!1)):e(),n},e.decorateQuerystring=j,e.deleteCookie=V,e.detectDocumentSize=A,e.detectViewport=x,e.dispatchToTrackers=function(e,n){try{Q(null!=e?e:X()).forEach(n)}catch(e){le.error("Function failed",e)}},e.dispatchToTrackersInCollection=function(e,n,t){try{Z(null!=e?e:Object.keys(n),n).forEach(t)}catch(e){le.error("Function failed",e)}},e.findRootDomain=_,e.fixupDomain=D,e.fixupTitle=I,e.fixupUrl=W,e.fromQuerystring=L,e.getCookiesWithPrefix=R,e.getCssClasses=H,e.getFilterByClass=function(e){if(null==e||"object"!=typeof e||Array.isArray(e))return function(){return!0};var n=Object.prototype.hasOwnProperty.call(e,"allowlist"),t=F(e);return J(e,(function(e){e:{var r=0;for(e=H(e);r<e.length;r++)if(t[e[r]]){r=!0;break e}r=!1}return r===n}))},e.getFilterByName=function(e){if(null==e||"object"!=typeof e||Array.isArray(e))return function(){return!0};var n=e.hasOwnProperty("allowlist"),t=F(e);return J(e,(function(e){return e.name in t===n}))},e.getHostName=C,e.getReferrer=N,e.getTracker=function(e){return ve.hasOwnProperty(e)?ve[e]:(le.warn(e+" not configured"),null)},e.getTrackers=Q,e.hasLocalStorage=k,e.hasSessionStorage=function(){try{return!!window.sessionStorage}catch(e){return!0}},e.isFunction=function(e){return!(!e||"function"!=typeof e)},e.isInteger=O,e.isString=P,e.isValueInArray=function(e,n){for(var t=0;t<n.length;t++)if(n[t]===e)return!0;return!1},e.localStorageAccessible=T,e.parseAndValidateFloat=function(e){return e=parseFloat(e),isNaN(e)?void 0:e},e.parseAndValidateInt=function(e){return e=parseInt(e),isNaN(e)?void 0:e},e.trackerExists=function(e){return ve.hasOwnProperty(e)},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=index.umd.min.js.map
